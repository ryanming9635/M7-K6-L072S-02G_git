C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 1   


C51 COMPILER V8.16, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Output\Main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Main.c COMPACT OPTIMIZE(9,SIZE) BROWSE INCDIR(.\Include\) DEBUG OBJECTEXTEN
                    -D CODE LISTINCLUDE SYMBOLS PRINT(.\Source\Main.lst) OBJECT(.\Output\Main.obj)

line level    source

   1          /*****************************************************************************/
   2          /*                                                                           */
   3          /*                    TW880x Demo Board   Techwell,Inc                       */
   4          /*                                                                           */
   5          /* CPU        : Winbond 78E62BP-40                                           */
   6          /* LANGUAGE   : Tasking C / Keil C                                           */
   7          /* PROGRAMMER : Jooyeon Lee / Harry Han                                      */
   8          /*                                                                           */
   9          /*****************************************************************************/
  10          /* See 'Release.txt' for firmware revision history                           */
  11          
  12          #include "Config.h"
   1      =1  /*****************************************************************************/
   2      =1  /*                           System Configurations                           */
   3      =1  /*                                                      rev 0.10 include auto test                                               */
   4      =1  // 0.11 change DTV, PC input initial download data correct for Charge Pump
   5      =1  // 0.12 correct phase measurement routine '>>3'
   6      =1  // 0.13 enable function for SPI control... only EXT MCU case
   7      =1  // 0.14 corrected PC measurement......
   8      =1  // 0.0a test function only for CVBS, SVIDEO
   9      =1  // 0.15 corrected DTV scaler setting for panel resolutions
  10      =1  // 0.0b panel for AND 640x480 TICON panel
  11      =1  // 0.16 corrected COMPONENT scaler setting for panel resolutions        11/21/2007
  12      =1  // 0.0c automatic chip test
  13      =1  // 0.17 add monitor function, osd grid for writing grid
  14      =1  // 0.18 add component, dtv pc for analogpanel, 12/06/2007
  15      =1  // 0.19 correct pal input for CES, 12/20/2007
  16      =1  // 0.1a CCFL control, 12/28/2007
  17      =1  // 0.19 Multi Grid for Banking on Internal MCU  01/17/2008
  18      =1  // 0.20 CCFL contol for backlight brightness    01/21/2008
  19      =1  // 0.21 CCFL contol for backlight brightness    01/25/2008
  20      =1  // 0.22 phase setting 02/07/2008
  21      =1  // 0.221 display input correction 04/03/2008
  22      =1  // 0.23 PC, DTV mode, no signal display
  23      =1  // 0.24 PC Auto Color adjustment
  24      =1  // 0.25 revised PC Auto Clock adjustment - find divide number and phase
  25      =1  // 0.26 Digital RGB for TW8826
  26      =1  // 0.27 Correct LVDS control                                    08/22/2008
  27      =1  // 0.28 Add WSVGA resolution                                    10/23/2008
  28      =1  // 0.29 Add NEW GRID                                                    11/14/2008
  29      =1  // 0.30 Fix DTV input                                                   12/10/2008
  30      =1  // 0.31 Add 1080i23, 24, 25A, 25B                               01/20/2009
  31      =1  // 0.32 TCON setting FIX all mode                               01/22/2009
  32      =1  // 0.33 autodetect is auto on/off by dip sw1    02/02/2009
  33      =1  // 0.34 Fix autocolor function and clamp position 02/08/2009
  34      =1  /*****************************************************************************/
  35      =1  #ifndef __CONFIG_H__
  36      =1  #define __CONFIG_H__
  37      =1  
  38      =1  //#define INTERNAL_MCU -- defined by Project Compiler session
  39      =1  
  40      =1  
  41      =1  //-----------------------------------------------------------------------------
  42      =1  //              Firmware Version
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 2   

  43      =1  //-----------------------------------------------------------------------------
  44      =1  #define FWVER                   0x140                   // Rev 0.14
  45      =1  //-----------------------------------------------------------------------------
  46      =1  //              Compiler
  47      =1  //-----------------------------------------------------------------------------
  48      =1  #define KEILC                                           // Keil C 5.0
  49      =1  //-----------------------------------------------------------------------------
  50      =1  //              MPU Clock
  51      =1  //-----------------------------------------------------------------------------
  52      =1  #ifndef INTERNAL_MCU
  53      =1  //#define CLOCK_11M                                     // 11.0592MHz
  54      =1  #define CLOCK_22M                                       // 22.1184MHz
  55      =1  #else                                                           // INTERNAL_MCU
           =1 #define CLOCK_27M                                       // 27MHz
           =1 #define REG_START_ADDRESS       0xc000          // register start 0xc000, for page0, 0xc100-page1 
           =1 #endif
  59      =1  //-----------------------------------------------------------------------------
  60      =1  //              TW88 Version
  61      =1  //-----------------------------------------------------------------------------
  62      =1  #define TW8816
  63      =1  //-----------------------------------------------------------------------------
  64      =1  //              Options for Backlight control
  65      =1  //-----------------------------------------------------------------------------
  66      =1  //#define       BACKLIGHT_CCFL
  67      =1  //#define       BACKLIGHT_LED
  68      =1  #define BACKLIGHT_PWM
  69      =1  
  70      =1  //-----------------------------------------------------------------------------
  71      =1  //              Panel Resolution
  72      =1  //-----------------------------------------------------------------------------
  73      =1  // ---- Select Default Panel
  74      =1  //
  75      =1  //#define UXGA                                          // 1600 x 1200
  76      =1  //#define SXGA                                          // 1280 x 1024
  77      =1  //#define XGA  // 1024 x 768
  78      =1  #ifdef XGA
           =1         #define LVDS                                    
           =1         #define PWIDTH  1024
           =1         #define PHEIGHT 768
           =1 #endif
  83      =1  //#define SVGA                                          //  800 x 600
  84      =1  //#define VGA                                           //  640 x 480
  85      =1  #ifdef VGA
           =1         #define PWIDTH  640
           =1         #define PHEIGHT 480
           =1         //#define       HITACHI_640_B_160               //--> 640 x 160
           =1         #define AND_640_480
           =1 #endif
  91      =1  //#define WXGA                                          // 1280 x 768 (15:9) // 1366 x 768 (16:9)
  92      =1  #ifdef WXGA
           =1     //#define WX_SHARP_LQ106K1LA
           =1         #define PWIDTH  1280
           =1         #define PHEIGHT 768
           =1 #endif
  97      =1  //#define WSVGA                                         // 1024 x 600   *** only video mode
  98      =1  #ifdef WSVGA
           =1         #define PWIDTH  1024
           =1         #define PHEIGHT 600
           =1         #define UNIDEN_1024_600
           =1 #endif
 103      =1  #define WVGA                                            //  800 x 480
 104      =1  #ifdef WVGA
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 3   

 105      =1          #define PWIDTH  800
 106      =1          #define PHEIGHT 600//480
 107      =1          // If WVGA, you have to select panel.
 108      =1          //#define AU_10INCH
 109      =1          //#define WVGA_TPO
 110      =1          //#define SAMSUNG_10INCH
 111      =1          //#define SAMSUNG_TICONLESS_10INCH
 112      =1          //#define SHARP_TICONLESS_7INCH
 113      =1          #define AU_TICONLESS_7INCH
 114      =1          //#define INNOLUX_AT080TN03
 115      =1          //#define AU_TICONLESS_7INCH_CCFL
 116      =1          //#define CMO                   // CHIMEI panel
 117      =1          //#define AU_TICONLESS_10INCH
 118      =1          //#define HITACHI_T01
 119      =1          //#define HITACHI_TX23D12
 120      =1          //#define HITACHI_TX18D24
 121      =1          //#define HITACHI_TX18D16
 122      =1          //#define TMD_LTA070A320F
 123      =1          //#define TMD_LTA080B
 124      =1  #endif  //WVGA
 125      =1  //#define HVGA                                          //  480 x 320
 126      =1  //#define QVGA                                          //  320 x 240   *** only video mode
 127      =1  #ifdef QVGA
           =1         #define PWIDTH  320
           =1         #define PHEIGHT 240
           =1         //#define HITACHI_TX09D73
           =1         //#define AU_DELTARGB
           =1         //#define SHARP_LQ050Q5DR01
           =1         //#define SHARP_LQ035
           =1         //#define       TMD
           =1 #endif
 136      =1  
 137      =1  //#define WQVGA                                         //  480 x 234   *** only video mode
 138      =1  #ifdef WQVGA
           =1         #define PWIDTH  480
           =1         #define PHEIGHT 240
           =1         // If WQVGA, you have to select panel   
           =1     #define ANALOG_7INCH
           =1         //#define       PWIDTH  400
           =1         //#define PHEIGHT       240
           =1         //#define SHARP_LQ043T3DX02             //  400 x 237
           =1         //#define LG_ANALOG
           =1         //#define TMD_ANALOG                            //TMD_LTA05B352A
           =1         //#define       T_51945GD                               // Optorex Panel
           =1 #endif  // WQVGA
 150      =1  
 151      =1  //if LVDS pannel disable TICONLESS
 152      =1  
 153      =1  //-----------------------------------------------------------------------------
 154      =1  //---- Add Support One more panel with DIPSW#1
 155      =1  //---- Ex. Add Analog AU 7" Panel with Default Panel for evalution
 156      =1  //#define ADD_ANALOGPANEL               // Added Analog panel(AU7") from default set panel(expect WQVGA) with DIP #1 sw
             -itch.(DIP#1=L:ANALOG, H:DEFAULT)
 157      =1                                                          // It can't support WQVGA and ADD_ANALOGPANEL same time!!
 158      =1          //#define ADD_ANALOG_7INCH
 159      =1          //#define ADD_TMD_LTA05B352A
 160      =1                                                                          
 161      =1  //---- Support Wide panel function
 162      =1  #if (defined WXGA) || (defined WSVGA) || (defined WVGA) || (defined WQVGA)
 163      =1  #define WIDE_SCREEN                             // Can support 4 display mode, i.e. Normal, Wide, Full, Zoom
 164      =1  #endif                                                          // Tested panasonic WVGA panel.
 165      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 4   

 166      =1  //-----------------------------------------------------------------------------
 167      =1  //              Panel Vendor Specific
 168      =1  //-----------------------------------------------------------------------------
 169      =1  
 170      =1  //-----------------------------------------------------------------------------
 171      =1  //              TV Tuner
 172      =1  //-----------------------------------------------------------------------------
 173      =1  #define PHILIPS                         0
 174      =1  #define ALPS                            1               // ALPS, LG
 175      =1  #define TEMIC                           2
 176      =1  #define TVAVA                           3
 177      =1  #define LGTUNER                         4
 178      =1  #define SAMSUNGMUTITUNER        5
 179      =1  
 180      =1  #define TVTunerDevice           4
 181      =1  //-----------------------------------------------------------------------------
 182      =1  //              IR Remote Controller Type
 183      =1  //-----------------------------------------------------------------------------
 184      =1  //#define REMO_RC5                                      // RC5 style
 185      =1  #define TECHWELL_REMOCON
 186      =1  //#define REMO_NEC                                      // NEC style
 187      =1  //#define PHILIPS_REMOCON // New remocon 
 188      =1  
 189      =1  
 190      =1  //-----------------------------------------------------------------------------
 191      =1  //              I2C Device Access Address Mapping
 192      =1  //-----------------------------------------------------------------------------
 193      =1  
 194      =1  #define EEPROMI2CAddress        0xa0    // EEPROM (24C16)
 195      =1  #define TW88I2CAddress          0x8a    // TW880x
 196      =1  
 197      =1  #define MSPI2CAddress           0x80    // MSP
 198      =1  
 199      =1  //-----------------------------------------------------------------------------
 200      =1  //              Options for Possible Inputs
 201      =1  //-----------------------------------------------------------------------------
 202      =1  #define         AWT
 203      =1  //#define       E_Wintek 
 204      =1  //#define SUPPORT_SVIDEO                     //andy Awt 20090914
 205      =1  //#define SUPPORT_COMPONENT                     // support component analog to decoder//andy Awt 20090914
 206      =1  
 207      =1  //#define SUPPORT_DTV                           // support DTV input through component( to ADC ).//andy Awt 20090914
 208      =1  #define SUPPORT_PC                              // support PC function
 209      =1  //#define SUPPORT_DVI                           // support DVI input
 210      =1  #define SUPPORT_SDCARD
 211      =1  
 212      =1  //#define SUPPORT_RS485
 213      =1  
 214      =1  //-----------------------------------------------------------------------------
 215      =1  //              Options for Possible Standards
 216      =1  //              Default:NTSC
 217      =1  //-----------------------------------------------------------------------------
 218      =1  #define SUPPORT_PAL                     
 219      =1  #define SUPPORT_SECAM
 220      =1  #define SUPPORT_NTSC4           
 221      =1  #define SUPPORT_PALM    
 222      =1  #define SUPPORT_PALN            
 223      =1  #define SUPPORT_PAL60           
 224      =1  
 225      =1  
 226      =1  //#define ID_CHECK_BY_FW                        // in Video mode, check input system ID by firmware
 227      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 5   

 228      =1  //-----------------------------------------------------------------------------
 229      =1  //              Options for Debugging/Release
 230      =1  //-----------------------------------------------------------------------------
 231      =1  //#define SUPPORT_PATTERN                       // support LCD test pattern
 232      =1  
 233      =1  
 234      =1  #ifndef WQVGA
 235      =1          #ifndef QVGA
 236      =1  #define SUPPORT_OSDPOSITIONMOVE
 237      =1          #endif
 238      =1  #endif
 239      =1  
 240      =1  #define SERIAL                                  // include serial communication routines
 241      =1  
 242      =1  //#define SUPPORT_DEBUG                         // Support to use Read & Write in debug OSD Window by remocon.
 243      =1  
 244      =1  //#define DEBUG                                         // include debug information
 245      =1  #ifdef DEBUG
           =1         //#define DEBUG_MAIN
           =1         //#define DEBUG_TIME
           =1         //#define DEBUG_KEYREMO
           =1         //#define DEBUG_TW88
           =1         //#define DEBUG_DECODER
           =1         //#define DEBUG_I2C
           =1         //#define DEBUG_EEP
           =1         //#define DEBUG_OSD
           =1         //#define DEBUG_AUDIO
           =1         //#define DEBUG_SETPANEL
           =1         //#define DEBUG_DTV
           =1         #define DEBUG_PC
           =1         //#define DEBUG_PC_MEAS
           =1         #define DEBUG_PC_COLOR
           =1         //#define DEBUG_COMPONENT
           =1         //#define DEBUG_BANK
           =1         //#define DEBUG_PAUSE
           =1         //#define DEBUG_MCU
           =1 #endif
 265      =1  
 266      =1  #define AUTOCALC_PC                                     // in PC mode, Enable Auto Calcuration
 267      =1  //#define SUPPORT_USERCOLORFROMTXT      // Use color setting of text file in Color mode=USER MODE which is as B
             -rightness(Reg10), Contast(Reg11),
 268      =1                                                                          //    Sat_U(Reg13),Sat_V(Reg14),Sharpness(Reg12,Reg78)                                                                  
 269      =1  //#define SUPPORT_GAMMA
 270      =1  
 271      =1  //#define CHIP_MANUAL_TEST                      // DIPSW#1
 272      =1  
 273      =1  #ifndef INTERNAL_MCU
 274      =1  //#define NO_INITIALIZE                         // After Power switch turn on with DIP SW4 Enable(Low), or pressed MENU button 
             -for internal MCU
 275      =1                                      //     micom works to access only I2C bus by serial command.
 276      =1  #endif
 277      =1  
 278      =1  //#define SUPPORT_KRS_OSDDEMO           // For KRS Company Demo 
 279      =1  //#define SUPPORT_LINE_OSDDEMO
 280      =1  
 281      =1  //-----------------------------------------------------------------------------
 282      =1  //              Special Features
 283      =1  //-----------------------------------------------------------------------------
 284      =1  
 285      =1  #ifndef INTERNAL_MCU
 286      =1  //#define       SUPPORT_DELTA_RGB
 287      =1  #endif
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 6   

 288      =1  #define SUPPORT_SELECTKEY                       // choose the keymap of using select key or left,right key.
 289      =1  //-----------------------------------------------------------------------------
 290      =1  #endif  //__CONFIG_H__
  13          
  14          #include "reg.h"
   1      =1  //
   2      =1  //Registers.h   : Register declaration
   3      =1  //
   4      =1  
   5      =1  #ifndef __REGISTERS__
   6      =1  #define __REGISTERS__
   7      =1  
   8      =1  #ifdef INTERNAL_MCU
           =1 /*  BYTE Registers  */
           =1 sfr P0    = 0x80;
           =1 sfr P1    = 0x90;
           =1 sfr P2    = 0xA0;
           =1 sfr P3    = 0xB0;
           =1 sfr PSW   = 0xD0;
           =1 sfr ACC   = 0xE0;
           =1 sfr B     = 0xF0;
           =1 sfr SP    = 0x81;
           =1 sfr DPL   = 0x82;
           =1 sfr DPH   = 0x83;
           =1 sfr PCON  = 0x87;
           =1 sfr TCON  = 0x88;
           =1 sfr TMOD  = 0x89;
           =1 sfr TL0   = 0x8A;
           =1 sfr TL1   = 0x8B;
           =1 sfr TH0   = 0x8C;
           =1 sfr TH1   = 0x8D;
           =1 sfr IE    = 0xA8;
           =1 sfr IP    = 0xB8;
           =1 sfr SCON  = 0x98;
           =1 sfr SBUF  = 0x99;
           =1 
           =1 //sfr P4    = 0xd8;
           =1 
           =1 /*  8052 Extensions  */
           =1 sfr EXIF  = 0x91;               // external interrupt 2,3,4,5 flags should be cleared by software
           =1 sfr T2CON = 0xC8;
           =1 sfr RCAP2L = 0xCA;
           =1 sfr RCAP2H = 0xCB;
           =1 sfr TL2   = 0xCC;
           =1 sfr TH2   = 0xCD;
           =1 sfr EICON = 0xD8;
           =1 sfr EIE   = 0xE8;
           =1 sfr EIP   = 0xF8;
           =1 
           =1 /*      TW88 Core Extension */
           =1 sfr     BANKREG         = 0x9A;
           =1 sfr     SPICONTROL      = 0x9B;
           =1 sfr     T0HIGH          = 0x9C;
           =1 sfr     T0LOW           = 0x9D;
           =1 sfr     T1HIGH          = 0x9E;
           =1 sfr     T1LOW           = 0x9F;
           =1 sfr     T2HIGH          = 0x93;
           =1 sfr     T2LOW           = 0x94;
           =1 
           =1 /*  BIT Registers  */
           =1 /*  PSW  */
           =1 sbit CY    = 0xD7;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 7   

           =1 sbit AC    = 0xD6;
           =1 sbit F0    = 0xD5;
           =1 sbit RS1   = 0xD4;
           =1 sbit RS0   = 0xD3;
           =1 sbit OV    = 0xD2;
           =1 sbit P     = 0xD0;
           =1 
           =1 /*  TCON  */
           =1 sbit TF1   = 0x8F;
           =1 sbit TR1   = 0x8E;
           =1 sbit TF0   = 0x8D;
           =1 sbit TR0   = 0x8C;
           =1 sbit IE1   = 0x8B;
           =1 sbit IT1   = 0x8A;
           =1 sbit IE0   = 0x89;
           =1 sbit IT0   = 0x88;
           =1 
           =1 /*  IE  */
           =1 sbit EA    = 0xAF;
           =1 sbit ES    = 0xAC;
           =1 sbit ET1   = 0xAB;
           =1 sbit EX1   = 0xAA;
           =1 sbit ET0   = 0xA9;
           =1 sbit EX0   = 0xA8;
           =1 
           =1 /*  EIE  */
           =1 sbit EWDI  = 0xEC;              // Watch dog timer interrupt enable
           =1 sbit EX5   = 0xEB;              // external interrupt 5 enable
           =1 sbit EX4   = 0xEA;              // external interrupt 4 enable
           =1 sbit EX3   = 0xE9;              // external interrupt 3 enable
           =1 sbit EX2   = 0xE8;              // external interrupt 2 enable
           =1 
           =1 /*  IP  */
           =1 sbit PS    = 0xBC;
           =1 sbit PT1   = 0xBB;
           =1 sbit PX1   = 0xBA;
           =1 sbit PT0   = 0xB9;
           =1 sbit PX0   = 0xB8;
           =1 
           =1 /*  EIP  */
           =1 sbit PWDI  = 0xFC;              // Watch dog timer interrupt priority
           =1 sbit PX5   = 0xFB;              // external interrupt5 priority
           =1 sbit PX4   = 0xFA;              // external interrupt4 priority
           =1 sbit PX3   = 0xF9;              // external interrupt3 priority
           =1 sbit PX2   = 0xF8;              // external interrupt2 priority
           =1 
           =1 /*  P3  */
           =1 sbit RD    = 0xB7;
           =1 sbit WR    = 0xB6;
           =1 sbit T1    = 0xB5;
           =1 sbit T0    = 0xB4;
           =1 sbit INT1  = 0xB3;
           =1 sbit INT0  = 0xB2;
           =1 sbit TXD   = 0xB1;
           =1 sbit RXD   = 0xB0;
           =1 
           =1 /*  SCON  */
           =1 sbit SM0   = 0x9F;
           =1 sbit SM1   = 0x9E;
           =1 sbit SM2   = 0x9D;
           =1 sbit REN   = 0x9C;
           =1 sbit TB8   = 0x9B;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 8   

           =1 sbit RB8   = 0x9A;
           =1 sbit TI    = 0x99;
           =1 sbit RI    = 0x98;
           =1 
           =1 /*  8052 Extensions  */
           =1 /*  IE  */
           =1 sbit ET2   = 0xAD;
           =1 
           =1 /*  IP  */
           =1 sbit PT2   = 0xBD;
           =1 
           =1 /*  P1  */
           =1 sbit T2EX  = 0x91;
           =1 sbit T2    = 0x90;
           =1              
           =1 /*  T2CON  */
           =1 sbit TF2   = 0xCF;
           =1 sbit EXF2  = 0xCE;
           =1 sbit RCLK  = 0xCD;
           =1 sbit TCLK  = 0xCC;
           =1 sbit EXEN2 = 0xCB;
           =1 sbit TR2   = 0xCA;
           =1 sbit C_T2  = 0xC9;
           =1 sbit CP_RL2= 0xC8;
           =1 
           =1 sfr     CHPENR = 0xF6;
           =1 sfr     CHPCON = 0xBF;
           =1 sfr     SFRAL  = 0xC4;
           =1 sfr     SFRAH  = 0xC5;
           =1 sfr     SFRFD  = 0xC6;
           =1 sfr     SFRCN  = 0xC7;
           =1 
           =1 sbit P0_0  = 0x80;
           =1 sbit P0_1  = 0x81;
           =1 sbit P0_2  = 0x82;
           =1 sbit P0_3  = 0x83;
           =1 sbit P0_4  = 0x84;
           =1 sbit P0_5  = 0x85;
           =1 sbit P0_6  = 0x86;
           =1 sbit P0_7  = 0x87;
           =1 
           =1 sbit P1_0  = 0x90;
           =1 sbit P1_1  = 0x91;
           =1 sbit P1_2  = 0x92;
           =1 sbit P1_3  = 0x93;
           =1 sbit P1_4  = 0x94;
           =1 sbit P1_5  = 0x95;
           =1 sbit P1_6  = 0x96;
           =1 sbit P1_7  = 0x97;
           =1 
           =1 sbit P2_0  = 0xa0;
           =1 sbit P2_1  = 0xa1;
           =1 sbit P2_2  = 0xa2;
           =1 sbit P2_3  = 0xa3;
           =1 sbit P2_4  = 0xa4;
           =1 sbit P2_5  = 0xa5;
           =1 sbit P2_6  = 0xa6;
           =1 sbit P2_7  = 0xa7;
           =1 
           =1 sbit P3_0  = 0xb0;
           =1 sbit P3_1  = 0xb1;
           =1 sbit P3_2  = 0xb2;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 9   

           =1 sbit P3_3  = 0xb3;
           =1 sbit P3_4  = 0xb4;
           =1 sbit P3_5  = 0xb5;
           =1 sbit P3_6  = 0xb6;
           =1 sbit P3_7  = 0xb7;
           =1 
           =1 #else   // external MCU=WINBOND
 189      =1  /*  BYTE Registers  */
 190      =1  sfr P0    = 0x80;
 191      =1  sfr P1    = 0x90;
 192      =1  sfr P2    = 0xA0;
 193      =1  sfr P3    = 0xB0;
 194      =1  sfr PSW   = 0xD0;
 195      =1  sfr ACC   = 0xE0;
 196      =1  sfr B     = 0xF0;
 197      =1  sfr SP    = 0x81;
 198      =1  sfr DPL   = 0x82;
 199      =1  sfr DPH   = 0x83;
 200      =1  sfr PCON  = 0x87;
 201      =1  sfr TCON  = 0x88;
 202      =1  sfr TMOD  = 0x89;
 203      =1  sfr TL0   = 0x8A;
 204      =1  sfr TL1   = 0x8B;
 205      =1  sfr TH0   = 0x8C;
 206      =1  sfr TH1   = 0x8D;
 207      =1  sfr CKCON = 0x8E;               //clock control register, default =0x01
 208      =1  sfr IE    = 0xA8;
 209      =1  sfr IP    = 0xB8;
 210      =1  sfr SCON  = 0x98;
 211      =1  sfr SBUF  = 0x99;
 212      =1  sfr P4 = 0xE8; //Megawin Ryan@970716
 213      =1  //sfr P4    = 0xa5;      //SST MCU
 214      =1  //sfr P4    = 0xd8;             //winbond<960820>
 215      =1  
 216      =1  
 217      =1  /*  8052 Extensions  */
 218      =1  sfr T2CON = 0xC8;
 219      =1  sfr RCAP2L = 0xCA;
 220      =1  sfr RCAP2H = 0xCB;
 221      =1  sfr TL2   = 0xCC;
 222      =1  sfr TH2   = 0xCD;
 223      =1  
 224      =1  // for UART2
 225      =1  sfr S2CON  = 0xAA;
 226      =1  sfr S2BRT  = 0xBA;
 227      =1  sfr S2BUF  = 0x9A;
 228      =1  sfr AUXR2  = 0xA6;
 229      =1  sfr AUXIE  = 0xAD;
 230      =1  
 231      =1  
 232      =1  sfr P1M0  = 0x91;
 233      =1  sfr P1M1  = 0x92;
 234      =1  sfr P0M0  = 0x93;
 235      =1  sfr P0M1  = 0x94;
 236      =1  
 237      =1  
 238      =1  
 239      =1  // for PCA
 240      =1  sfr CCON   = 0xD8;
 241      =1  sfr CMOD   = 0xD9;
 242      =1  sfr CCAPM0 = 0xDA;
 243      =1  sfr CCAPM1 = 0xDB;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 10  

 244      =1  sfr CCAPM2 = 0xDC;
 245      =1  sfr CCAPM3 = 0xDD;
 246      =1  sfr CCAPM4 = 0xDE;
 247      =1  sfr CCAPM5 = 0xDF;
 248      =1  sfr CL     = 0xE9;
 249      =1  sfr CH     = 0xF9;
 250      =1  sfr CCAP0L = 0xEA;
 251      =1  sfr CCAP0H = 0xFA;
 252      =1  sfr CCAP1L = 0xEB;
 253      =1  sfr CCAP1H = 0xFB;
 254      =1  sfr CCAP2L = 0xEC;
 255      =1  sfr CCAP2H = 0xFC;
 256      =1  sfr CCAP3L = 0xED;
 257      =1  sfr CCAP3H = 0xFD;
 258      =1  sfr CCAP4L = 0xEE;
 259      =1  sfr CCAP4H = 0xFE;
 260      =1  sfr CCAP5L = 0xEF;
 261      =1  sfr CCAP5H = 0xFF;
 262      =1  sfr PCAPWM0= 0xF2;
 263      =1  sfr PCAPWM1= 0xF3;
 264      =1  sfr PCAPWM2= 0xF4;
 265      =1  sfr PCAPWM3= 0xF5;
 266      =1  sfr PCAPWM4= 0xF6;
 267      =1  sfr PCAPWM5= 0xF7;
 268      =1  
 269      =1  /*  BIT Registers  */
 270      =1  /*  PSW  */
 271      =1  sbit CY    = 0xD7;
 272      =1  sbit AC    = 0xD6;
 273      =1  sbit F0    = 0xD5;
 274      =1  sbit RS1   = 0xD4;
 275      =1  sbit RS0   = 0xD3;
 276      =1  sbit OV    = 0xD2;
 277      =1  sbit P     = 0xD0;
 278      =1  
 279      =1  /*  TCON  */
 280      =1  sbit TF1   = 0x8F;
 281      =1  sbit TR1   = 0x8E;
 282      =1  sbit TF0   = 0x8D;
 283      =1  sbit TR0   = 0x8C;
 284      =1  sbit IE1   = 0x8B;
 285      =1  sbit IT1   = 0x8A;
 286      =1  sbit IE0   = 0x89;
 287      =1  sbit IT0   = 0x88;
 288      =1  
 289      =1  /*  IE  */
 290      =1  sbit EA    = 0xAF;
 291      =1  sbit ES    = 0xAC;
 292      =1  sbit ET1   = 0xAB;
 293      =1  sbit EX1   = 0xAA;
 294      =1  sbit ET0   = 0xA9;
 295      =1  sbit EX0   = 0xA8;
 296      =1  
 297      =1  /*  IP  */
 298      =1  sbit PS    = 0xBC;
 299      =1  sbit PT1   = 0xBB;
 300      =1  sbit PX1   = 0xBA;
 301      =1  sbit PT0   = 0xB9;
 302      =1  sbit PX0   = 0xB8;
 303      =1  
 304      =1  /*  P3  */
 305      =1  sbit RD    = 0xB7;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 11  

 306      =1  sbit WR    = 0xB6;
 307      =1  sbit T1    = 0xB5;
 308      =1  sbit T0    = 0xB4;
 309      =1  sbit INT1  = 0xB3;
 310      =1  sbit INT0  = 0xB2;
 311      =1  sbit TXD   = 0xB1;
 312      =1  sbit RXD   = 0xB0;
 313      =1  
 314      =1  /*  SCON  */
 315      =1  sbit SM0   = 0x9F;
 316      =1  sbit SM1   = 0x9E;
 317      =1  sbit SM2   = 0x9D;
 318      =1  sbit REN   = 0x9C;
 319      =1  sbit TB8   = 0x9B;
 320      =1  sbit RB8   = 0x9A;
 321      =1  sbit TI    = 0x99;
 322      =1  sbit RI    = 0x98;
 323      =1  
 324      =1  /*  8052 Extensions  */
 325      =1  /*  IE  */
 326      =1  sbit ET2   = 0xAD;
 327      =1  
 328      =1  /*  IP  */
 329      =1  sbit PT2   = 0xBD;
 330      =1  
 331      =1  /*  P1  */
 332      =1  sbit T2EX  = 0x91;
 333      =1  sbit T2    = 0x90;
 334      =1               
 335      =1  /*  T2CON  */
 336      =1  sbit TF2   = 0xCF;
 337      =1  sbit EXF2  = 0xCE;
 338      =1  sbit RCLK  = 0xCD;
 339      =1  sbit TCLK  = 0xCC;
 340      =1  sbit EXEN2 = 0xCB;
 341      =1  sbit TR2   = 0xCA;
 342      =1  sbit C_T2  = 0xC9;
 343      =1  sbit CP_RL2= 0xC8;
 344      =1  
 345      =1  sfr     CHPENR = 0xF6;
 346      =1  sfr     CHPCON = 0xBF;
 347      =1  sfr     SFRAL  = 0xC4;
 348      =1  sfr     SFRAH  = 0xC5;
 349      =1  sfr     SFRFD  = 0xC6;
 350      =1  sfr     SFRCN  = 0xC7;
 351      =1  
 352      =1  sbit P0_0  = 0x80;
 353      =1  sbit P0_1  = 0x81;
 354      =1  sbit P0_2  = 0x82;
 355      =1  sbit P0_3  = 0x83;
 356      =1  sbit P0_4  = 0x84;
 357      =1  sbit P0_5  = 0x85;
 358      =1  sbit P0_6  = 0x86;
 359      =1  sbit P0_7  = 0x87;
 360      =1  
 361      =1  sbit P1_0  = 0x90;
 362      =1  sbit P1_1  = 0x91;
 363      =1  sbit P1_2  = 0x92;
 364      =1  sbit P1_3  = 0x93;
 365      =1  sbit P1_4  = 0x94;
 366      =1  sbit P1_5  = 0x95;
 367      =1  sbit P1_6  = 0x96;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 12  

 368      =1  sbit P1_7  = 0x97;
 369      =1  
 370      =1  sbit P2_0  = 0xa0;
 371      =1  sbit P2_1  = 0xa1;
 372      =1  sbit P2_2  = 0xa2;
 373      =1  sbit P2_3  = 0xa3;
 374      =1  sbit P2_4  = 0xa4;
 375      =1  sbit P2_5  = 0xa5;
 376      =1  sbit P2_6  = 0xa6;
 377      =1  sbit P2_7  = 0xa7;
 378      =1  
 379      =1  sbit P3_0  = 0xb0;
 380      =1  sbit P3_1  = 0xb1;
 381      =1  sbit P3_2  = 0xb2;
 382      =1  sbit P3_3  = 0xb3;
 383      =1  sbit P3_4  = 0xb4;
 384      =1  sbit P3_5  = 0xb5;
 385      =1  sbit P3_6  = 0xb6;
 386      =1  sbit P3_7  = 0xb7;
 387      =1  
 388      =1  sbit P4_0  = P4^0;
 389      =1  sbit P4_1  = P4^1;
 390      =1  sbit INT3  = P4^2;
 391      =1  sbit INT2  = P4^3;
 392      =1  #endif  // INTERNAL_MCU
 393      =1  
 394      =1  #endif  //__REGISTERS__
  15          #include "typedefs.h"
   1      =1  #ifndef __TYPEDEFS__
   2      =1  #define __TYPEDEFS__
   3      =1  
   4      =1  
   5      =1  #define DATA            data
   6      =1  #define PDATA           pdata
   7      =1  #define IDATA           data
   8      =1  #define CODE            code
   9      =1  #define CODE_P
  10      =1  #define PDATA_P
  11      =1  #define IDATA_P
  12      =1  #define DATA_P
  13      =1  
  14      =1  #define INTERRUPT( num, name ) name() interrupt num
  15      =1  
  16      =1  #define _between(x, a, b)       (a<=x && x<=b)
  17      =1  #define _swap(a, b)                     { a^=b; b^=a; a^=b; }
  18      =1  
  19      =1  typedef unsigned char   Register;
  20      =1  typedef unsigned char   BYTE;
  21      =1  typedef unsigned short  WORD;
  22      =1  typedef unsigned long   DWORD;
  23      =1  
  24      =1  #define TRUE    1
  25      =1  #define FALSE   0
  26      =1  
  27      =1  //VInputStdDetectMode
  28      =1  #define AUTO    0
  29      =1  
  30      =1  //VInputStd
  31      =1  #define NTSC    1                       
  32      =1  #define PAL             2
  33      =1  #define SECAM   3
  34      =1  #define NTSC4   4
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 13  

  35      =1  #define PALM    5
  36      =1  #define PALN    6
  37      =1  #define PAL60   7
  38      =1  
  39      =1  #define MAXINPUTSTD     PAL60+1 // 
  40      =1  
  41      =1  #define UNKNOWN 0xfe
  42      =1  #define NOINPUT 0       //0xff
  43      =1  
  44      =1  
  45      =1  
  46      =1  
  47      =1  #define NIL                     0xff
  48      =1  
  49      =1  enum SourceModeTypeEnum
  50      =1  {       
  51      =1          AVMode,            // 0
  52      =1          VGAMode,       // 1
  53      =1          CAM_D,         // 2
  54      =1          CAM_A,         // 3
  55      =1          CAM_B,         // 4
  56      =1          CAM_C,         // 5
  57      =1          CAM_R,         // 6
  58      =1          CAM_AB,        // 7
  59      =1          CAM_CR,        // 8
  60      =1          CAM_AR,        // 9
  61      =1          CAM_RB,        // 10
  62      =1          CAM_AC,        // 11
  63      =1          CAM_CB,        // 12
  64      =1          CAM_RAB_T,     // 13
  65      =1          CAM_RAB_H,     // 14
  66      =1  
  67      =1          CAM_QUAD,      // 15
  68      =1          CAM_ABR_T3,    // 16
  69      =1          CAM_ABR_T4,    // 17
  70      =1          SEQ,           // 18
  71      =1          CAM_BA,                 //19
  72      =1          
  73      =1          CAM_BC,
  74      =1          CAM_BR,
  75      =1          CAM_CA,
  76      =1          CAM_ABC,
  77      =1          CAM_ABR,
  78      =1          CAM_ACR,
  79      =1          CAM_BAC,
  80      =1          CAM_BAR,
  81      =1          CAM_BCR,
  82      =1          CAM_CAB,
  83      =1          CAM_CAR,
  84      =1          CAM_CBR,        
  85      =1          CAM_NUM
  86      =1  };
  87      =1  
  88      =1  typedef unsigned char SourceModeType;
  89      =1  
  90      =1  #endif  /* __TYPEDEFS__ */
  16          #include "main.h"
   1      =1  #ifndef __MAIN__
   2      =1  #define __MAIN__
   3      =1  
   4      =1  #define ON                                      1
   5      =1  #define OFF                                     0
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 14  

   6      =1  //#define Hs_debug
   7      =1  //#define       DVR
   8      =1  
   9      =1  //================= DIP SW Definition =========================================
  10      =1  ///#define PIXEL_SINGLE         P0_0
  11      =1  #define DIP_PANEL_SWITCH        P0_0    // Samsung(0) // Sharp-Noticon(1)
  12      =1  #define DIP_AUTO_DETECT         P0_1
  13      =1  #define DIP_EDGE_ENHANCE        P0_2
  14      =1  #define DIP_BW_STRETCH          P0_3
  15      =1  
  16      =1  #define Panel_Enable()          P4=P4|0x08 //andy 980908
  17      =1  #define Panel_Disable()                 P4=P4&0xf7
  18      =1  
  19      =1  #define SetBacklight()      P4=P4|0x04
  20      =1  #define clrBacklight()      P4=P4&0xfb
  21      =1  
  22      =1  
  23      =1  //InputSelection
  24      =1  struct struct_IdName {
  25      =1          BYTE    Id;
  26      =1          BYTE    Name[16];
  27      =1  };
  28      =1  
  29      =1  #define CH_TW2835              1
  30      =1  #define CH_CAMD                2
  31      =1  #define CH_AV                  3
  32      =1  #define PC                                         7
  33      =1  #define ChineseDefaultMenu   8
  34      =1  
  35      =1  #define SVIDEO                          2
  36      =1  #define COMPONENT                       3
  37      =1  //#define ANALOGDTV                     4
  38      =1  #define DTV                                     4
  39      =1  #define TV                                      5
  40      =1  #define SCART                           6
  41      =1  
  42      =1  #define DIGITALVGA                      8
  43      =1  
  44      =1  #define AIRTV                           0 //9
  45      =1  #define CABLETV                         1 //0xa
  46      =1  
  47      =1  
  48      =1  #define TVTUNER                         0xd             //10
  49      =1  #define MUTE                            1       
  50      =1  #define MENU                            2       
  51      =1  #define TVVOL                           4       
  52      =1  #define CC                                      8       
  53      =1  #define INPUTINFO                       0x10
  54      =1  #define PCINFO                          0x20
  55      =1  #define GAUGEINFO           0x40
  56      =1  //#define RATINGINFO                    0x40
  57      =1  #define TVCHN                           0x80
  58      =1  //#define MUTE                          0x40
  59      =1  
  60      =1  #define YPBPR_480i                      0
  61      =1  #define YPBPR_576i                      1
  62      =1  #define YPBPR_480p                      2
  63      =1  #define YPBPR_576p                      3
  64      =1  #define YPBPR_1080i                     4
  65      =1  #define YPBPR_720p                      5
  66      =1  #define YPBPR_720p50            6
  67      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 15  

  68      =1  
  69      =1  //--------------------------- P0 Define -----------------------------
  70      =1  #define SEL_MIX                 P0_6    // 
  71      =1  //--------------------------- P1 Define -----------------------------
  72      =1  #define SEL_DVI                 P3_5    //LJY062001             
  73      =1  
  74      =1  #define TW88HWReset                     P3_4    //LJY001010 //LJY000721
  75      =1  #define PowerUp             P1_4
  76      =1  //======================= CDS Control ================================= 
  77      =1  #define CDS_CTRL           P1_5
  78      =1  extern BYTE     SelectModeType;
  79      =1  extern BYTE InputSelection;
  80      =1  extern BYTE SEQTime;
  81      =1  extern BYTE     Priority;
  82      =1  extern BYTE AutoDayNight;
  83      =1  extern BYTE PowerFlag;
  84      =1  
  85      =1  BYTE keyIn(void);
  86      =1  void TimerForRemocon(void);
  87      =1  void TimerForTick(void);
  88      =1  void DisableRemoconInt(void);
  89      =1  BYTE SetSupport_remocon(BYTE newd);
  90      =1  
  91      =1  void delay(BYTE cnt);
  92      =1  
  93      =1  BYTE RS_ready(void);
  94      =1  BYTE RS_rx(void);
  95      =1  void RS_tx(BYTE tx_buf);
  96      =1  
  97      =1  BYTE RS2_rx(void);
  98      =1  void RS2_tx(BYTE tx_buf);
  99      =1  
 100      =1  void NewLine(void);
 101      =1  void PutsP(PDATA_P BYTE *ptr);
 102      =1  #ifdef Hs_debug
           =1 void MonWriteI2C(BYTE addr, BYTE index, BYTE val);
           =1 BYTE MonReadI2C(BYTE addr, BYTE index);
           =1 #endif
 106      =1  BYTE Asc1Bin(BYTE asc);
 107      =1  BYTE Asc2Bin(PDATA_P BYTE *s);
 108      =1  
 109      =1  void I2CDeviceInitialize( CODE_P BYTE *RegSet);
 110      =1  
 111      =1  //void RestartSystemClock(WORD clock_hm);
 112      =1  WORD GetTime_ms(void);
 113      =1  BYTE GetTime_H(void);
 114      =1  BYTE GetTime_M(void);
 115      =1  void ChangeTime_H( char add );
 116      =1  void ChangeTime_M( char add );
 117      =1  //WORD GetWakeupTime(void);
 118      =1  //void SetWakeupTime(WORD wtime);
 119      =1  
 120      =1  
 121      =1  //WORD GetOffTime(void);
 122      =1  //void SetOffTime(WORD wtime);
 123      =1  //BYTE GetSleepTimer(void);
 124      =1  //void SetSleepTimer(BYTE stime);
 125      =1  WORD DiffTime_ms( WORD stime, WORD etime );
 126      =1  //void SetLastBlockedTime(void);
 127      =1  void SetLastCCTime(void);                               //ljy010904...CC_FIX_CLEAR_ON_TIME
 128      =1  
 129      =1  void SetOSDLastKeyInTime(void);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 16  

 130      =1  WORD GetOSDLastKeyInTime(void);
 131      =1  WORD GetIVF(void);
 132      =1  DWORD GetIHF(void);
 133      =1  BYTE ReadVInputSTD(void);
 134      =1  void SetVInputStd(BYTE newd);
 135      =1  BYTE GetVInputStd(void);
 136      =1  BYTE GetInputSelection(void);
 137      =1  #ifdef ADD_ANALOGPANEL
           =1 BYTE IsAnalogOn(void);
           =1 #endif
 140      =1  void InitVideoData(BYTE src);
 141      =1  void ChangeVInputStdDetectMode(BYTE val);
 142      =1  BYTE GetVInputStdInx(void);
 143      =1  
 144      =1  void MonWriteI2Cn_(BYTE addr, BYTE *val, BYTE cnt) ;
 145      =1  
 146      =1  ///void Usage(void);
 147      =1  #ifdef Hs_debug
           =1         void Prompt(void);
           =1 #endif
 150      =1  void DebugKeyIn(BYTE ikey);
 151      =1  void DVIPowerDown(bit flag);
 152      =1  void PowerDown_XTAL(bit flag);
 153      =1  
 154      =1  void ChangeInput(BYTE newsel);
 155      =1  
 156      =1  
 157      =1  void WaitPowerOn(void);
 158      =1  void PowerOff(void);
 159      =1  BYTE GetNextInputSelection(void);
 160      =1  
 161      =1  BYTE WantToStopTVScan(void);
 162      =1  
 163      =1  //BYTE IsTW8801(void);
 164      =1  //BYTE IsTW8803(void);
 165      =1  //BYTE ConvertVideoVSAT(BYTE reg);
 166      =1  
 167      =1  BYTE IsNoInput(void);
 168      =1  void LoadEEPROM (void);
 169      =1  void Hs_InitVars(void);
 170      =1  void AdjustAutoDayNight(BYTE val);
 171      =1  void ACCPowerControl(void);
 172      =1  struct RegisterInfo
 173      =1  {
 174      =1     int  Min;
 175      =1     int  Max;
 176      =1     int  Default;
 177      =1  };
 178      =1  struct LongRegisterInfo
 179      =1  {
 180      =1     WORD Min;
 181      =1     WORD Max;
 182      =1     WORD Default;
 183      =1  };
 184      =1  
 185      =1  #endif  // __MAIN__
  17          #include "tw88.h"
   1      =1  #ifndef __TW88__
   2      =1  #define __TW88__
   3      =1  
   4      =1  #include "main.h"
   1      =2  #ifndef __MAIN__
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 17  

           =2 #define __MAIN__
           =2 
           =2 #define ON                                      1
           =2 #define OFF                                     0
           =2 //#define Hs_debug
           =2 //#define       DVR
           =2 
           =2 //================= DIP SW Definition =========================================
           =2 ///#define PIXEL_SINGLE         P0_0
           =2 #define DIP_PANEL_SWITCH        P0_0    // Samsung(0) // Sharp-Noticon(1)
           =2 #define DIP_AUTO_DETECT         P0_1
           =2 #define DIP_EDGE_ENHANCE        P0_2
           =2 #define DIP_BW_STRETCH          P0_3
           =2 
           =2 #define Panel_Enable()          P4=P4|0x08 //andy 980908
           =2 #define Panel_Disable()                 P4=P4&0xf7
           =2 
           =2 #define SetBacklight()      P4=P4|0x04
           =2 #define clrBacklight()      P4=P4&0xfb
           =2 
           =2 
           =2 //InputSelection
           =2 struct struct_IdName {
           =2         BYTE    Id;
           =2         BYTE    Name[16];
           =2 };
           =2 
           =2 #define CH_TW2835              1
           =2 #define CH_CAMD                2
           =2 #define CH_AV                  3
           =2 #define PC                                         7
           =2 #define ChineseDefaultMenu   8
           =2 
           =2 #define SVIDEO                          2
           =2 #define COMPONENT                       3
           =2 //#define ANALOGDTV                     4
           =2 #define DTV                                     4
           =2 #define TV                                      5
           =2 #define SCART                           6
           =2 
           =2 #define DIGITALVGA                      8
           =2 
           =2 #define AIRTV                           0 //9
           =2 #define CABLETV                         1 //0xa
           =2 
           =2 
           =2 #define TVTUNER                         0xd             //10
           =2 #define MUTE                            1       
           =2 #define MENU                            2       
           =2 #define TVVOL                           4       
           =2 #define CC                                      8       
           =2 #define INPUTINFO                       0x10
           =2 #define PCINFO                          0x20
           =2 #define GAUGEINFO           0x40
           =2 //#define RATINGINFO                    0x40
           =2 #define TVCHN                           0x80
           =2 //#define MUTE                          0x40
           =2 
           =2 #define YPBPR_480i                      0
           =2 #define YPBPR_576i                      1
           =2 #define YPBPR_480p                      2
           =2 #define YPBPR_576p                      3
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 18  

           =2 #define YPBPR_1080i                     4
           =2 #define YPBPR_720p                      5
           =2 #define YPBPR_720p50            6
           =2 
           =2 
           =2 //--------------------------- P0 Define -----------------------------
           =2 #define SEL_MIX                 P0_6    // 
           =2 //--------------------------- P1 Define -----------------------------
           =2 #define SEL_DVI                 P3_5    //LJY062001             
           =2 
           =2 #define TW88HWReset                     P3_4    //LJY001010 //LJY000721
           =2 #define PowerUp             P1_4
           =2 //======================= CDS Control ================================= 
           =2 #define CDS_CTRL           P1_5
           =2 extern BYTE     SelectModeType;
           =2 extern BYTE InputSelection;
           =2 extern BYTE SEQTime;
           =2 extern BYTE     Priority;
           =2 extern BYTE AutoDayNight;
           =2 extern BYTE PowerFlag;
           =2 
           =2 BYTE keyIn(void);
           =2 void TimerForRemocon(void);
           =2 void TimerForTick(void);
           =2 void DisableRemoconInt(void);
           =2 BYTE SetSupport_remocon(BYTE newd);
           =2 
           =2 void delay(BYTE cnt);
           =2 
           =2 BYTE RS_ready(void);
           =2 BYTE RS_rx(void);
           =2 void RS_tx(BYTE tx_buf);
           =2 
           =2 BYTE RS2_rx(void);
           =2 void RS2_tx(BYTE tx_buf);
           =2 
           =2 void NewLine(void);
           =2 void PutsP(PDATA_P BYTE *ptr);
           =2 #ifdef Hs_debug
           =2 void MonWriteI2C(BYTE addr, BYTE index, BYTE val);
           =2 BYTE MonReadI2C(BYTE addr, BYTE index);
           =2 #endif
           =2 BYTE Asc1Bin(BYTE asc);
           =2 BYTE Asc2Bin(PDATA_P BYTE *s);
           =2 
           =2 void I2CDeviceInitialize( CODE_P BYTE *RegSet);
           =2 
           =2 //void RestartSystemClock(WORD clock_hm);
           =2 WORD GetTime_ms(void);
           =2 BYTE GetTime_H(void);
           =2 BYTE GetTime_M(void);
           =2 void ChangeTime_H( char add );
           =2 void ChangeTime_M( char add );
           =2 //WORD GetWakeupTime(void);
           =2 //void SetWakeupTime(WORD wtime);
           =2 
           =2 
           =2 //WORD GetOffTime(void);
           =2 //void SetOffTime(WORD wtime);
           =2 //BYTE GetSleepTimer(void);
           =2 //void SetSleepTimer(BYTE stime);
           =2 WORD DiffTime_ms( WORD stime, WORD etime );
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 19  

           =2 //void SetLastBlockedTime(void);
           =2 void SetLastCCTime(void);                               //ljy010904...CC_FIX_CLEAR_ON_TIME
           =2 
           =2 void SetOSDLastKeyInTime(void);
           =2 WORD GetOSDLastKeyInTime(void);
           =2 WORD GetIVF(void);
           =2 DWORD GetIHF(void);
           =2 BYTE ReadVInputSTD(void);
           =2 void SetVInputStd(BYTE newd);
           =2 BYTE GetVInputStd(void);
           =2 BYTE GetInputSelection(void);
           =2 #ifdef ADD_ANALOGPANEL
           =2 BYTE IsAnalogOn(void);
           =2 #endif
           =2 void InitVideoData(BYTE src);
           =2 void ChangeVInputStdDetectMode(BYTE val);
           =2 BYTE GetVInputStdInx(void);
           =2 
           =2 void MonWriteI2Cn_(BYTE addr, BYTE *val, BYTE cnt) ;
           =2 
           =2 ///void Usage(void);
           =2 #ifdef Hs_debug
           =2         void Prompt(void);
           =2 #endif
           =2 void DebugKeyIn(BYTE ikey);
           =2 void DVIPowerDown(bit flag);
           =2 void PowerDown_XTAL(bit flag);
           =2 
           =2 void ChangeInput(BYTE newsel);
           =2 
           =2 
           =2 void WaitPowerOn(void);
           =2 void PowerOff(void);
           =2 BYTE GetNextInputSelection(void);
           =2 
           =2 BYTE WantToStopTVScan(void);
           =2 
           =2 //BYTE IsTW8801(void);
           =2 //BYTE IsTW8803(void);
           =2 //BYTE ConvertVideoVSAT(BYTE reg);
           =2 
           =2 BYTE IsNoInput(void);
           =2 void LoadEEPROM (void);
           =2 void Hs_InitVars(void);
           =2 void AdjustAutoDayNight(BYTE val);
           =2 void ACCPowerControl(void);
           =2 struct RegisterInfo
           =2 {
           =2    int  Min;
           =2    int  Max;
           =2    int  Default;
           =2 };
           =2 struct LongRegisterInfo
           =2 {
           =2    WORD Min;
           =2    WORD Max;
           =2    WORD Default;
           =2 };
           =2 
           =2 #endif  // __MAIN__
   5      =1  
   6      =1  //Value for register 0x44
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 20  

   7      =1  //#define DECODER_YCbCr         0x08            //xxxx bbxx
   8      =1  //#define RGB_RGB                               0x0C
   9      =1  
  10      =1  #define TW88_FPLL0                      0xf9
  11      =1  #define TW88_FPLL1                      0xfa
  12      =1  #define TW88_FPLL2                      0xfb
  13      =1  #define TW88_FSS                        0xfc
  14      =1  #define TW88_FSS_PD                     0xfd
  15      =1  #define TW88_PLL_DIV            0xfe
  16      =1  
  17      =1  //#define TW88_XSCALE                   0x5d
  18      =1  //#define TW88_YSCALE                   0x5e
  19      =1  
  20      =1  #define TW88_XUSCALELO          0x60
  21      =1  #define TW88_XDSCALELO          0x61
  22      =1  #define TW88_YUSCALELO          0x62
  23      =1  #define TW88_XYSCALEHI          0x63
  24      =1  #define TW88_XUSCALEFINE        0x69
  25      =1  #define TW88_YUSCALEFINE        0x6a
  26      =1  
  27      =1  //Power Mgt
  28      =1  #define POWER_OFF                       0
  29      =1  #define POWER_STANDBY           1
  30      =1  #define POWER_SUSPEND           2
  31      =1  #define POWER_ON                        3
  32      =1  
  33      =1  //void TWChipsDetect(void);
  34      =1  void SetAutoDetectStd(void);
  35      =1  void ClearAutoDetectStd(BYTE);
  36      =1  void I2CDeviceInitialize( CODE_P BYTE *RegSet);
  37      =1  
  38      =1  
  39      =1  //0x63.. Register Group
  40      =1  #define GROUP_YCbCr                     0x40
  41      =1  #define GROUP_RGB                       0
  42      =1  #define SelectPanelAttrRegGroup(A)                              WriteTW88(0x70, (ReadTW88(0x70) & 0xbf) | A)
  43      =1  
  44      =1  //#if defined TW8801 || defined TW8803
  45      =1  #define FB_MAIN         2
  46      =1  #define FB_NORMAL       1
  47      =1  #define FB_RGB          0
  48      =1  //void SetFBmode( BYTE mode );
  49      =1  //#endif // TW8801
  50      =1  
  51      =1  
  52      =1  //=============================================================================
  53      =1  //                                   LCD Functions   
  54      =1  //=============================================================================
  55      =1  BYTE GetLCDPowerState(void);
  56      =1  void SetLCDPowerState(BYTE dat);
  57      =1  
  58      =1  BYTE IsFreeRun(void);
  59      =1  void PanelFreeRun(BYTE on);
  60      =1  void PanelBlack(BYTE on);
  61      =1  
  62      =1  void PanelMute(BYTE on);
  63      =1  
  64      =1  void LCDPowerON(BYTE mute); 
  65      =1  void LCDPowerOFF(void);
  66      =1  #ifdef Hs_debug
           =1 void LCDPower(void);
           =1 #endif
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 21  

  69      =1  void DPMSmodeOFF(void);
  70      =1  void DPMSmodeON(void);
  71      =1  //=============================================================================
  72      =1  //                              Get PC Parameter Functions   
  73      =1  //=============================================================================
  74      =1  void GetInitPanelAttribute1(void);
  75      =1  //void GetInitPanelAttribute2(void);
  76      =1  void DefaultPanelAttributeForVideo(void);
  77      =1  void SetPVR(WORD pvr);
  78      =1  void SetPHR(WORD phr);
  79      =1  WORD GetPVR(void);
  80      =1  WORD GetPHR(void);
  81      =1  WORD GetHPN(void);
  82      =1  WORD GetVPN(void);
  83      =1  
  84      =1  //WORD GetVactive(void);
  85      =1  
  86      =1  WORD GetHstart(void);
  87      =1  WORD GetHend(void);
  88      =1  WORD GetVstart(void);
  89      =1  WORD GetVend(void);
  90      =1  void TuneLineBuffer(BYTE field);
  91      =1  void TuneLineBuffer4Video(BYTE field);
  92      =1  
  93      =1  #if defined (SUPPORT_DTV)
           =1 void SetCoarstForDTV(BYTE en);
           =1 #endif
  96      =1  
  97      =1  WORD GetHactiveStart(void);
  98      =1  WORD GetHactiveEnd(void);
  99      =1  WORD GetVactiveStart(void);
 100      =1  //WORD GetVactiveLen(void);
 101      =1  BYTE GetVBackPorch(void);
 102      =1  void SetVBackPorch(BYTE val);
 103      =1  WORD GetPHP(void);
 104      =1  void SetPHP(WORD php);
 105      =1  void SetPVP(WORD period);
 106      =1  WORD GetPVP(void);
 107      =1  //void SetPanelRelatedRegisters(void);
 108      =1  //BYTE ChangedHPN(void);
 109      =1  //WORD GetVSUD(void);
 110      =1  
 111      =1  void SetDefaultPLL(void);
 112      =1  //void SetDefaultFPHSperiod(void);
 113      =1  //BYTE CalcPHP(DWORD ppf, BYTE tol);
 114      =1  //void ChangeFPHSperiod4DecoderInput(WORD vsud, BYTE tol);
 115      =1  
 116      =1  //-------------------------------------------------------------------
 117      =1  //                  Set Active Region Functions
 118      =1  //-------------------------------------------------------------------
 119      =1  void SetHactiveStart(WORD hstart);
 120      =1  void SetHactiveEnd(WORD hend);
 121      =1  void SetVactiveStart(WORD vstart);
 122      =1  //void SetVactiveLen(WORD van, WORD vstart);
 123      =1  void SetVactiveLen(WORD van);
 124      =1  //=============================================================================
 125      =1  //                         Set Measurement Window Functions   
 126      =1  //=============================================================================
 127      =1  void SetMeasureWindowH(WORD start, WORD stop);
 128      =1  void SetMeasureWindowV(WORD start, WORD stop);
 129      =1  //=============================================================================
 130      =1  //                              Video Input Functions   
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 22  

 131      =1  //=============================================================================
 132      =1  BYTE IsVideoInput(void);
 133      =1  BYTE DetectDecoderInput(void);
 134      =1  //=============================================================================
 135      =1  //
 136      =1  //=============================================================================
 137      =1  void AutoPHPCalEnable(void);
 138      =1  void AutoPHPCalDisable(void);
 139      =1  
 140      =1  void MakeStartInt(void);
 141      =1  void AVGAInput(void);
 142      =1  void DVIInput(void);
 143      =1  //void DVGAInput(void);
 144      =1  void DisableDVGA(void);
 145      =1  
 146      =1  void COMPOSITE1Input(void);
 147      =1  void COMPOSITE2Input(void);
 148      =1  void COMPOSITE3Input(void);
 149      =1  
 150      =1  void SVIDEOInput(void);
 151      =1  void COMPONENTInput(void);
 152      =1  void ANALOGDTVInput(void);
 153      =1  void DTVInput(void);
 154      =1  void TVInput(void);
 155      =1  void SCARTInput(void);
 156      =1  
 157      =1  //=============================================================================
 158      =1  //                          Measurement Functions
 159      =1  //=============================================================================
 160      =1  ///void SetPanelBitOrder(BYTE swap);
 161      =1  //void SetPanelSingleDouble(BYTE single);
 162      =1  
 163      =1  BYTE MeasureAndWait(BYTE flag);
 164      =1  
 165      =1  //WORD GetHCounter1(BYTE field);
 166      =1  //void SetHInitial(BYTE field, WORD counter);
 167      =1  //=============================================================================
 168      =1  //                          Invert Polarity Functions
 169      =1  //=============================================================================
 170      =1  void InvertHSYNCPolarity(void);
 171      =1  void InvertVSYNCPolarity(void);
 172      =1  //=============================================================================
 173      =1  //            Interrupt / SW Reset Control Functions
 174      =1  //=============================================================================
 175      =1  void SetInt(void);
 176      =1  //void ClearInt(void);
 177      =1  void SetEnDet(void);
 178      =1  void ClearEnDet(void);
 179      =1  void SWReset(void);
 180      =1  //void ClearSYNCLossStatus(void);
 181      =1  //void ClearSYNCChangeStatus(void);
 182      =1  //=============================================================================
 183      =1  //
 184      =1  //=============================================================================
 185      =1  BYTE IsBypassmode(void);
 186      =1  //BYTE IsInteraced(void);
 187      =1  void Clear_bypass(void);
 188      =1  void MaskOnSYNCInt(void);
 189      =1  void MaskOffSYNCInt(void);
 190      =1  //=============================================================================
 191      =1  //                                    ZoomControl
 192      =1  //=============================================================================
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 23  

 193      =1  void BypassZoom(void);
 194      =1  
 195      =1  void XscaleU(DWORD scale);
 196      =1  void XscaleD(DWORD scale);
 197      =1  void XScale2(DWORD scale);
 198      =1  void YScale2(DWORD scale);
 199      =1  WORD GetYScale(void);
 200      =1  //=============================================================================
 201      =1  //
 202      =1  //=============================================================================
 203      =1  WORD GetHSYNCPulse(void);
 204      =1  WORD GetVSYNCPulse(void);
 205      =1  //#if defined TW8801 || defined TW8803
 206      =1  WORD GetRelativePosition(void);
 207      =1  //#endif
 208      =1  //=============================================================================
 209      =1  //                                                              MISC2 for decoder
 210      =1  //=============================================================================
 211      =1  #define BLUE_DECODER            2
 212      =1  #define BLACK_DECODER           0
 213      =1  
 214      =1  BYTE ForceDecoderOutput(BYTE color);
 215      =1  BYTE ClearForcedDecoderOutput(void);
 216      =1  //=============================================================================
 217      =1  //                                                              CC and EDS
 218      =1  //=============================================================================
 219      =1  BYTE GetCCStatus(void);
 220      =1  void DisableCC(void);
 221      =1  void EnableCC(void);
 222      =1  BYTE GetCCData(void);
 223      =1  BYTE IsCCEnabled(void);
 224      =1  void EnableEDS(void);
 225      =1  void DisableEDS(void);
 226      =1  void RecoverCCOverflow(void);
 227      =1  
 228      =1  #define CCFIFOHalfFull()                        (ReadDecoder(CSTATUS) & 0x04)
 229      =1  //=============================================================================
 230      =1  //                                                              Internal PLL
 231      =1  //=============================================================================
 232      =1  BYTE GetPOST(void);
 233      =1  void SetPLLS(BYTE plls);
 234      =1  BYTE GetREFDM(void);
 235      =1  void SetREFDM(BYTE refdm);
 236      =1  DWORD GetFBDN(void);
 237      =1  void SetFBDN(WORD fbdn, BYTE vcsel);
 238      =1  DWORD GetPPF(void);
 239      =1  void ChangeInternPLL(DWORD _PPF);
 240      =1  
 241      =1  //=============================================================================
 242      =1  //                                                              Macros for attribute
 243      =1  //=============================================================================
 244      =1  //#define       GetOSDTransReg()                                                ReadTW88(0xAE)
 245      =1  //#define SetOSDTransReg(AlphaV)                                        WriteTW88(0xAE, (BYTE)AlphaV )
 246      =1  
 247      =1  #define GetPanelContrastReg(gccolor)                    ReadTW88(0x71+gccolor)
 248      =1  #define SetPanelContrastReg(sccolor, cval)              WriteTW88(0x71+sccolor,cval)
 249      =1  
 250      =1  #define GetPanelBrightnessReg(gbcolor)                  ReadTW88(0x74+gbcolor);
 251      =1  #define SetPanelBrightnessReg(sbcolor, bval)    WriteTW88(0x74+sbcolor,bval);
 252      =1  
 253      =1  #define SetDTVBrightnessReg(bval)                               WriteTW88(0x74,bval);
 254      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 24  

 255      =1  #define GetPanelSaturationReg(gbcolor)                  ReadTW88(0x72+gbcolor);
 256      =1  #define SetPanelSaturationReg(sbcolor, bval)    WriteTW88(0x72+sbcolor,bval);
 257      =1  
 258      =1  #define SetPanelSharpnessReg(bval)                              WriteTW88(0x78,((bval&0x07)|0x38) );
 259      =1  
 260      =1  #define SetPanelHueReg(bval)                                    WriteTW88(0x70, (ReadTW88(0x70) & 0xc0 | (bval)) );
 261      =1  
 262      =1  #define GetVideoContrastReg()                                   ReadDecoder(CONTRAST)
 263      =1  #define SetVideoContrastReg(vcval)                              WriteDecoder(CONTRAST, vcval)
 264      =1  
 265      =1  #define GetVideoBrightnessReg()                                 ReadDecoder(BRIGHT)
 266      =1  #define SetVideoBrightnessReg(vbval)                    WriteDecoder(BRIGHT, vbval )
 267      =1  
 268      =1  #define GetVideoSaturationReg(gvstype)                  ReadDecoder(SAT_U+gvstype)
 269      =1  #define SetVideoSaturationReg(svstype, vsval)   WriteDecoder(SAT_U+svstype,     vsval)
 270      =1  
 271      =1  #define GetVideoHueReg()                                                ReadDecoder(HUE)
 272      =1  #define SetVideoHueReg(vhval)                                   WriteDecoder(HUE,       vhval )
 273      =1  
 274      =1  #define GetVideoSharpnessRegDef                                 (ReadDecoder(SHARPNESS) & 0x0f) 
 275      =1  
 276      =1  #define GetVideoSharpnessReg()                                  GetVideoSharpnessRegDef
 277      =1  //#define       SetVideoSharpnessReg(vshval)                    WriteDecoder(SHARPNESS, vshval )
 278      =1  #define SetVideoSharpnessReg(vshval)                    WriteDecoder(SHARPNESS, ((ReadDecoder(SHARPNESS) & 0xf0) | (vshval 
             -& 0x0f) ) );
 279      =1  
 280      =1  #ifdef TW9908
           =1 #define SetVideoVPeakingReg(vshval)
           =1 #else
 283      =1  #define SetVideoVPeakingReg(vshval)                             WriteDecoder(V_PEAKING, ((ReadDecoder(V_PEAKING) & 0xf8) | (vshval 
             -& 0x07) ) );
 284      =1  #endif
 285      =1  
 286      =1  #define SetVideoHfilterReg(val)                                 WriteDecoder(HFILTER, ((ReadDecoder(HFILTER) & 0xf8) | (val & 0x07) )|
             -0x08 );
 287      =1  //----------------------------------------------------------------------------------
 288      =1  //color type
 289      =1  #define RED             0
 290      =1  #define GREEN   1
 291      =1  #define BLUE    2
 292      =1  #define WHITE   3
 293      =1  //saturation type
 294      =1  #define U_SAT   0
 295      =1  #define V_SAT   1
 296      =1  
 297      =1  //Alpha Blending Level
 298      =1  #define _0              0
 299      =1  #define _25             0x12
 300      =1  #define _37_5   0x13
 301      =1  #define _50             0x14
 302      =1  #define _100    0x18
 303      =1  
 304      =1  
 305      =1  /*
 306      =1  BYTE Mapping( int fromValue, struct RegisterInfo fromRange,
 307      =1                                   int * toValue, struct RegisterInfo toRange );
 308      =1  */
 309      =1  BYTE Mapping1( int fromValue, CODE_P struct RegisterInfo *fromRange,
 310      =1                                   int * toValue, CODE_P struct RegisterInfo *toRange );
 311      =1  #ifdef KEILC
 312      =1  #define Mapping2( A, B, C, D )                  Mapping1( A, B, C, D )
 313      =1  #define Mapping3( A, B, C, D )                  Mapping1( A, B, C, D )
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 25  

 314      =1  #else
           =1 BYTE Mapping2( int fromValue, IDATA_P struct RegisterInfo *fromRange,
           =1                                  int * toValue, CODE_P struct RegisterInfo *toRange );
           =1 BYTE Mapping3( int fromValue, CODE_P struct RegisterInfo *fromRange,
           =1                                  int * toValue, IDATA_P struct RegisterInfo *toRange );
           =1 #endif
 320      =1  
 321      =1  BYTE GetAttributesFromNTSCSettings(BYTE index);
 322      =1  
 323      =1  #endif  // __TW88__
 324      =1  
  18          #include "i2c.h"
   1      =1  #ifndef __I2C_H__
   2      =1  #define __I2C_H__
   3      =1  
   4      =1  
   5      =1  void I2CReadByte3(BYTE *);
   6      =1  void I2CRead8Byte(BYTE *);
   7      =1  #if 0
           =1 void I2CReadByteMSP(BYTE addr, BYTE index, BYTE *pd, BYTE cnt);
           =1 #endif
  10      =1  BYTE I2CWriteByte2(BYTE);
  11      =1  BYTE I2CWriteByte3(BYTE*);
  12      =1  BYTE I2CWrite8Byte(BYTE *);
  13      =1  
  14      =1  void I2CStart(void);
  15      =1  void I2CWriteData(BYTE value);
  16      =1  BYTE I2CReadData(void);
  17      =1  #if 0
           =1 BYTE I2CReadDataWithACK(void);
           =1 #endif
  20      =1  void I2CStop(void);
  21      =1  void I2Cdelay(void);
  22      =1  
  23      =1  
  24      =1  #define WriteTW88(a,b)          WriteI2C(TW88I2CAddress, a, b)
  25      =1  #define ReadTW88(a)                     ReadI2C(TW88I2CAddress, a)
  26      =1  
  27      =1  BYTE WriteTW88_Wait     (BYTE, BYTE);
  28      =1  void WriteADC           (BYTE, BYTE);
  29      =1  BYTE ReadADC            (BYTE);
  30      =1  BYTE ReadADC_TW88(BYTE index);
  31      =1  void WriteADC_TW88(BYTE index, BYTE dat);
  32      =1  
  33      =1  void WriteEEP           (WORD, BYTE);
  34      =1  BYTE ReadEEP            (WORD);
  35      =1  
  36      =1  
  37      =1  BYTE ReadI2C            (BYTE addr, BYTE index);
  38      =1  void WriteI2C           (BYTE addr, BYTE index, BYTE val);
  39      =1  
  40      =1  void WriteI2Cn_(BYTE addr, BYTE *val, BYTE cnt);
  41      =1  void WriteI2Cn (BYTE addr, BYTE index, BYTE *val, BYTE cnt);
  42      =1  void WriteI2CnD(BYTE addr, BYTE index, BYTE val, BYTE cnt);
  43      =1  
  44      =1  void ReadI2Cmn(BYTE addr, BYTE wcnt, BYTE rcnt, BYTE *rwdata);
  45      =1  
  46      =1  #define         WriteADC(a,b)   WriteADC_TW88(a,b)
  47      =1  #define         ReadADC(a)              ReadADC_TW88(a)
  48      =1  
  49      =1  #endif  /* __I2C_H__ */
  19          #include "adc.h"
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 26  

   1      =1  #ifndef __ADC__
   2      =1  #define __ADC__
   3      =1  
   4      =1  //=============================================================================
   5      =1  //                             ADC Functions
   6      =1  //=============================================================================
   7      =1  
   8      =1  void ADCPowerDown(bit flag);
   9      =1  void SelectADCmux(BYTE sel);
  10      =1  void SetADCMode(BYTE mode);
  11      =1  
  12      =1  void EnableADC(void);
  13      =1  void DisableADC(void);
  14      =1  
  15      =1  WORD GetCoarse(void);
  16      =1  void SetCoarse(WORD i);
  17      =1  void SetPhase(BYTE j);
  18      =1  BYTE GetPhaseCurrent(void);
  19      =1  BYTE SetVCORange(DWORD _IPF);
  20      =1  
  21      =1  //void SetADCGainOffset(BYTE gain, BYTE offset);
  22      =1  void AutoColorAdjust(void);
  23      =1  
  24      =1  
  25      =1  
  26      =1  void AutoColorAdjustForDTV(BYTE flag);
  27      =1  
  28      =1  #endif  // __ADC__
  29      =1  
  30      =1  
  31      =1  
  32      =1  
  33      =1  
  34      =1  
  35      =1  
  36      =1  
  37      =1  
  38      =1  
  39      =1  
  40      =1  
  41      =1  
  42      =1  
  43      =1  
  44      =1  
  45      =1  
  46      =1  
  47      =1  
  48      =1  
  49      =1  
  50      =1  
  51      =1  
  52      =1  
  53      =1  
  54      =1  
  20          #include "osdbasic.h"
   1      =1  //osd_basic.h
   2      =1  //LJY11012001
   3      =1  #ifndef __OSD_BASIC__
   4      =1  #define __OSD_BASIC__
   5      =1  
   6      =1  // osd_basic.h
   7      =1  // char code
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 27  

   8      =1  //#include "apilib.h"
   9      =1  
  10      =1  //ljy052903
  11      =1  //definition for internal OSD
  12      =1  #define FONT_WIDTH_TW88                 12
  13      =1  #define FONT_HEIGHT_TW88                18
  14      =1  #define PIXS_PER_XSTEP_TW88             8
  15      =1  #define LINES_PER_YSTEP_TW88    4
  16      =1  #define MAX_OSDWINDOW_TW88              8
  17      =1  
  18      =1  // Using TW88 OSD for Menu
  19      =1  #define FONT_WIDTH                      12
  20      =1  #define FONT_HEIGHT                     18
  21      =1  #define PIXS_PER_XSTEP          8
  22      =1  #define LINES_PER_YSTEP         4
  23      =1  #define MAX_OSDWINDOW           4
  24      =1  
  25      =1  #define MAX_FONT_BYTES          27
  26      =1  #define RAMFONT         0xFE
  27      =1  #define ROMFONT         0xFF
  28      =1  #define NO_UDFONT                       226 
  29      =1  
  30      =1  #define FONT_ROM        1
  31      =1  #define FONT_RAM        2
  32      =1  
  33      =1  
  34      =1  /////////////////////////////////
  35      =1  // Old Registers...
  36      =1  /*
  37      =1          #define TW88_WIN1ATTR           0x76
  38      =1          #define TW88_WIN1XSTART         0x77
  39      =1          #define TW88_WIN1YSTART         0x78
  40      =1          #define TW88_WIN1WIDTH          0x79
  41      =1          #define TW88_WIN1HEIGHT         0x7a
  42      =1          #define TW88_WIN1BRDATTR        0x7b
  43      =1          #define TW88_WIN1BRDWIDTH       0x7c
  44      =1          #define TW88_WIN1BRDHEIGHT      0x7d
  45      =1          #define TW88_WIN1XSPACE         0x7e            // between characters.
  46      =1          #define TW88_WIN1YSPACE         0x7f
  47      =1          #define TW88_WIN1SADDR          0x80            // starting address of OSD ram for Windows 1
  48      =1  */
  49      =1  /////////////////////////////////
  50      =1  
  51      =1  // OSD
  52      =1  #define TW88_ENABLERAM          0x94    // TW8804C
  53      =1  #define TW88_FONTRAMADDR        0x99    // TW8804C
  54      =1  #define TW88_FONTRAMDATA        0x9a    // TW8804C
  55      =1  #define TW88_OSDRAMADDRHI       0x95    // TW8804C
  56      =1  #define TW88_OSDRAMADDRLO       0x96    // TW8804C
  57      =1  #define TW88_OSDRAMDATAHI       0x97    // TW8804C
  58      =1  #define TW88_OSDRAMDATALO       0x98    // TW8804C
  59      =1  #define TW88_MULTISTART         0x9b    // TW8804C
  60      =1  #define TW88_OSDLOCKUPSEL       0x9c
  61      =1  #define TW88_WINNUM                     0x9e    // TW8804C
  62      =1  #define TW88_WINATTR            0x9f    //
  63      =1  #define TW88_WINXSTART          0xa1    //
  64      =1  #define TW88_WINYSTART          0xa2    //
  65      =1  #define TW88_WINSTART_HI        0xa0    //
  66      =1  #define TW88_WINWIDTH           0xa3    //
  67      =1  #define TW88_WINHEIGHT          0xa4    //
  68      =1  #define TW88_WINBRDATTR         0xa5    //
  69      =1  #define TW88_WINBRDWIDTH        0xa6    //
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 28  

  70      =1  #define TW88_WINBRDHEIGHT       0xa7    //
  71      =1  #define TW88_WINSPACE           0xa8    // between characters.
  72      =1  #define TW88_WINZOOM            0xa9    //
  73      =1  #define TW88_WINSADDRHI         0xa9    // starting address of OSD ram for Windows 1
  74      =1  #define TW88_WINSADDRLO         0xaa    // starting address of OSD ram for Windows 1
  75      =1  
  76      =1  #define TW88_WINSHADOW          0xab    //
  77      =1  #define TW88_WINBLENDING        0xac    //
  78      =1  #define TW88_WINCHEFFECT        0xad    //
  79      =1  
  80      =1  
  81      =1  //Attributes for OSD
  82      =1  #define WINZOOMx1                       0x01
  83      =1  #define WINZOOMx2                       0x02
  84      =1  #define WINZOOMx3                       0x03
  85      =1  #define WINZOOMx4                       0x04
  86      =1  #define SHOW                            0x08    
  87      =1  
  88      =1  #define EXTENDED_COLOR          0x80
  89      =1  #define BG_COLOR_BLACK          0x00    //For background color of window, border, and char. 
  90      =1  #define BG_COLOR_RED            0x40    
  91      =1  #define BG_COLOR_GREEN          0x20
  92      =1  #define BG_COLOR_YELLOW         0x60
  93      =1  #define BG_COLOR_BLUE           0x10
  94      =1  #define BG_COLOR_MAGENTA        0x50
  95      =1  #define BG_COLOR_CYAN           0x30
  96      =1  #define BG_COLOR_WHITE          0x70
  97      =1  #define BG_COLOR_TRANS          0x80    
  98      =1  #define BG_COLOR_MASK           0xf0    
  99      =1  
 100      =1  #define CH_COLOR_BLACK          0x00    //For color of char.
 101      =1  #define CH_COLOR_RED            0x04    
 102      =1  #define CH_COLOR_GREEN          0x02
 103      =1  #define CH_COLOR_YELLOW         0x06
 104      =1  #define CH_COLOR_BLUE           0x01
 105      =1  #define CH_COLOR_MAGENTA        0x05
 106      =1  #define CH_COLOR_CYAN           0x03
 107      =1  #define CH_COLOR_WHITE          0x07
 108      =1  #define CH_BLINK                        0x08    
 109      =1  #define CH_COLOR_MASK           0x0f    
 110      =1  
 111      =1  #define CL_BLACK                        0x00    //For color of char.
 112      =1  #define CL_BLUE                         0x01
 113      =1  #define CL_GREEN                        0x02
 114      =1  #define CL_CYAN                         0x03
 115      =1  #define CL_RED                          0x04    
 116      =1  #define CL_MAGENTA                      0x05
 117      =1  #define CL_YELLOW                       0x06
 118      =1  #define CL_WHITE                        0x07
 119      =1  #define CL_BLINK                        0x08    
 120      =1  
 121      =1  // 0x76*(WindowNo*0x0b)
 122      =1  #define WINDOW_DISABLE          0x00
 123      =1  #define WINDOW_ENABLE           0x01
 124      =1  #define WINDOW_3D_ENABLE    0x04
 125      =1  #define WINDOW_3D_BOTTOM    0x08
 126      =1  #define WINDOW_3D_TOP       0x00
 127      =1  #define WINDOW_TRANS_ENABLE 0x80
 128      =1  
 129      =1  #define WINBDCOLOR_ENABLE       0x80
 130      =1  #define WINBDCOLOR_EXTENT       0x80
 131      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 29  

 132      =1  
 133      =1  #define WINBLENDING_DISABLE 0x00
 134      =1  #define WINBLENDING_BACK    0x10
 135      =1  #define WINBLENDING_FORE    0x20
 136      =1  #define WINBLENDING_ALL     0x30
 137      =1  
 138      =1  #define WINSHADOW_ENABLE        0x80
 139      =1  // 0xc8*WindowNo
 140      =1  #define WIN_MULTICOLOR_ENABLE 0x20
 141      =1  #define WIN_CH_EFFECT_ENABLE  0x10
 142      =1  #define WIN_CH_EFFECT_SHADOW  0x08
 143      =1  
 144      =1  
 145      =1  
 146      =1  ///////// TW8804C /////////////
 147      =1  // Window Number
 148      =1  #define WINNUM1                         1
 149      =1  #define WINNUM2                         2
 150      =1  #define WINNUM3                         3
 151      =1  #define WINNUM4                         4
 152      =1  
 153      =1  // Index 0x9f Defination
 154      =1  #define WIN_BG_COLOR_EX         0x80
 155      =1  #define WIN_BG_COLOR_EX0        0x00
 156      =1  #define WIN_3D_TYPE                     0x08
 157      =1  #define WIN_3D_TYPE0            0x00
 158      =1  #define WIN_3D_EN                       0x04
 159      =1  #define WIN_3D_EN0                      0x00
 160      =1  #define WIN_3D_LEVEL            0x02
 161      =1  #define WIN_EN                          0x01
 162      =1  #define WIN_EN0                         0x00
 163      =1  
 164      =1  // Index 0xa5 Defination
 165      =1  #define WIN_BD_EN                       0x80
 166      =1  #define WIN_BD_EN0                      0x00
 167      =1  #define WIN_BD_WIDTH(a)         a
 168      =1  
 169      =1  // Index 0xa6 Defination
 170      =1  #define WIN_BD_COLOR_EX         0x80
 171      =1  #define WIN_BD_COLOR_EX0        0x00
 172      =1  #define WIN_H_BD_W(a)           a
 173      =1  
 174      =1  // Index 0xa7 Defination
 175      =1  #define WIN_V_BD_W(a)           a
 176      =1  
 177      =1  // Index 0xa8
 178      =1  #define WIN_CH_VSPACE(a)        (a<<4)
 179      =1  #define WIN_CH_HSPACE(a)        a
 180      =1  
 181      =1  // Index 0xa9 Defination
 182      =1  #define WIN_VZOOM(a)            (a-1)
 183      =1  #define WIN_HZOOM(a)            (a-1)
 184      =1  #define WIN_SADDR(a)            a
 185      =1  
 186      =1  // Index 0xab
 187      =1  #define WIN_SHADOW_EN           0x80
 188      =1  #define WIN_SHADOW_EN0          0x00
 189      =1  #define WIN_SHADOW_W(a)         a
 190      =1  
 191      =1  // ad
 192      =1  #define WIN_SHADOW_COLOR_EX             0x80
 193      =1  #define WIN_SHADOW_COLOR_EX0    0x00
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 30  

 194      =1  #define WIN_MULTI_EN                    0x40
 195      =1  #define WIN_MULTI_EN0                   0x00
 196      =1  #define WIN_V_EXT_EN                    0x20
 197      =1  #define WIN_V_EXT_EN0                   0x00
 198      =1  #define WIN_CH_BDSH_SEL(a)              a
 199      =1  #define SEL_BORDER                              0
 200      =1  #define SEL_SHADOW                              1
 201      =1  #define WIN_CH_BDSH_COLOR_EX    0x08
 202      =1  #define WIN_CH_BDSH_COLOR_EX0   0x00
 203      =1  
 204      =1  #define OSD_Win_Num(a)                  0x9e, a-1
 205      =1  #define OSD_Win_Start_Addr              0xa0
 206      =1  #define OSD_Win_Attr(a)                         a
 207      =1  #define OSD_Win_Start(h,v)                       (BYTE)(((WORD)h>>8) | (((WORD)v>>8)<<4)),(BYTE)h, (BYTE)v
 208      =1  #define OSD_Win_Width(a)                        a
 209      =1  #define OSD_Win_Height(a)                       a
 210      =1  #define OSD_Win_Border(a)                       a
 211      =1  #define OSD_Win_HBorder(a)                      a
 212      =1  #define OSD_Win_VBorder(a)                      a
 213      =1  #define OSD_Win_CH_Space(a)                     a
 214      =1  #define OSD_Win_ZM_SAddr(h,v,a)         ((h<<6)|(v<<4)|(a>>8)), (BYTE)a
 215      =1  #define OSD_Win_Shadow(a)                       a
 216      =1  #define OSD_Win_Blending(a)                     a
 217      =1  #define OSD_Win_CH_BorderShadow(a)      a
 218      =1  
 219      =1  
 220      =1  #define SetOSDWindowNum(winno)          WriteTW88(TW88_WINNUM, winno-1)
 221      =1  
 222      =1  //#define  OSD_Window_Attr(Trans_en,Color,3D_Type,3D_en,W_en)       (((( Trans_en | Color ) | 3D_Type) | 3
             -D_en) | W_en)
 223      =1  #define  OSD_Window_Attr(a,b,c,d,e)                                                                     (((( a | b ) | c) | d) | e)
 224      =1  #define  OSD_WShadow_Attr(W_Shadow_en,Color,Width)                                      W_Shadow_en | Color | Width
 225      =1  //#define  OSD_Blending(en,level)                                                                               en | (level & 0x0f)
 226      =1  //#define  OSD_Ch_Effect(Multi, Effect_En, ShadowBorder, Color)         Multi | Effect_En | ShadowBorder | Color 
             - 
 227      =1  
 228      =1  
 229      =1  struct OSDStrInfo 
 230      =1  {
 231      =1          BYTE    cnt;
 232      =1          WORD    addr;
 233      =1          BYTE    attr;
 234      =1          DWORD   str;
 235      =1  };
 236      =1  /*
 237      =1  struct BarInfo {
 238      =1          struct RegisterInfo BarCnt;
 239      =1          BYTE    winno;
 240      =1          BYTE    xoff;
 241      =1          BYTE    yoff;
 242      =1          BYTE    color;
 243      =1          int             bar_cnt;
 244      =1  };
 245      =1  */
 246      =1  struct FontData {
 247      =1          BYTE    font[27];
 248      =1  } ;
 249      =1  
 250      =1  //====================================================================
 251      =1  //  Internal OSD Function
 252      =1  void CopyCharToOSDRAM_TW88(BYTE Addr, BYTE attr, BYTE ch);
 253      =1  void CopyUDCharToOSDRAM_TW88(BYTE Addr, BYTE attr, BYTE ch);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 31  

 254      =1  //BYTE GetOSDWindowWidth_TW88(BYTE winno);
 255      =1  WORD GetOSDWindowSA_TW88(BYTE winno);
 256      =1  void SetOSDWindowX_TW88(BYTE winno, BYTE x);
 257      =1  void SetOSDWindowY_TW88(BYTE winno, BYTE y);
 258      =1  void SetOSDWindowWidth_TW88(BYTE winno, BYTE w);
 259      =1  void SetOSDWindowSA_TW88(BYTE winno, WORD sa);
 260      =1  
 261      =1  void SetOSDItalicsAndUnderline(BYTE italics, BYTE underline);
 262      =1  
 263      =1  void SetOSDHBorderWidth_TW88(BYTE winno, BYTE w);
 264      =1  //BYTE GetOSDWindowColor_TW88(BYTE winno);
 265      =1  void SetOSDWindowColor_TW88(BYTE CCWin, BYTE color);
 266      =1  void EnableOSDRAMAndChangeFont(BYTE type);
 267      =1  void WriteCharToOSDRAM(WORD addr, BYTE ch, BYTE attr);
 268      =1  
 269      =1  
 270      =1  void ShowOSDWindowAll(BYTE on);
 271      =1  void ShowOSDWindow_TW88(BYTE winno, BYTE onoff);
 272      =1  void ClearOSD_TW88(void);
 273      =1  //void CreateOSDWindow_TW88(BYTE winno, BYTE x, BYTE y, BYTE w, BYTE h, WORD sa, BYTE attr);
 274      =1  /*not yet!!
 275      =1  //ljy012304...CC_ADJUST_POS
 276      =1  void SetOSDWindowXS_TW88(BYTE winno, BYTE xs);
 277      =1  void SetOSDWindowYS_TW88(BYTE winno, BYTE ys);
 278      =1  */
 279      =1  
 280      =1  //====================================================================
 281      =1  //      OSDMenu Functions
 282      =1  
 283      =1  //--------------------------------------------------------------------
 284      =1  //      Functions used in only Menu
 285      =1  #define         CONVERT_CODE                    0x80
 286      =1  
 287      =1  void InitOSDWindow(BYTE *ptr);
 288      =1  
 289      =1  WORD GetOSDWindowX(BYTE winno);
 290      =1  WORD GetOSDWindowY(BYTE winno);
 291      =1  BYTE CreateOSDWindowOutline(BYTE winno, BYTE w, BYTE color);
 292      =1  void CreateOSDMenuWindow(BYTE, BYTE, BYTE, BYTE, BYTE, BYTE, BYTE);
 293      =1  void ClearOSDLine(BYTE winno, BYTE sx, BYTE sy, BYTE cnt, BYTE attr);
 294      =1  void WriteStringToAddr(WORD addr, BYTE *str, BYTE cnt);
 295      =1  void DrawAttrString(WORD addr, BYTE *str, BYTE cnt);
 296      =1  void DrawAttrCnt(WORD addr, BYTE color, BYTE cnt);
 297      =1  void ClearDataCnt(WORD, BYTE);
 298      =1  #define         SetOSDWindowX(A, B)                                                     SetOSDWindowX_TW88(A, B)
 299      =1  #define     SetOSDWindowY(A, B)                                                 SetOSDWindowY_TW88(A, B)
 300      =1  
 301      =1  
 302      =1  //--------------------------------------------------------------------
 303      =1  //      Functions used in Menu and others
 304      =1  #define         ShowOSDWindow(A, B)                                                     ShowOSDWindow_TW88(A, B)
 305      =1  #define     ClearOSD()                                                                  ClearOSD_TW88()
 306      =1  
 307      =1  //================================================================
 308      =1  //      Font
 309      =1  void DownloadUDFont(void);
 310      =1  #ifdef Hs_debug
           =1 void DisplayROMFont(BYTE);
           =1 void DisplayRAMFont(BYTE);
           =1 #endif
 314      =1  void DownloadFont(BYTE cod, CODE_P BYTE *fontdata);
 315      =1  //void DisplayGrid( void );
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 32  

 316      =1  //void DisplayCone( void );
 317      =1  //void DisplayJapanese( void );
 318      =1  void TestRAMFont( void );
 319      =1  #ifdef BANKING
           =1 void DisplayMGrid( BYTE );
           =1 void DisplayMessage( void );
           =1 void DisplayChinese( void );
           =1 void DisplayJapanese( void );
           =1 void DisplayKorean( void );
           =1 void DisplayGridBank0( BYTE n );
           =1 void DisplayGridBank1( BYTE n );
           =1 #endif
 328      =1  
 329      =1  //================================================================
 330      =1  //      OSD COLOR
 331      =1  void Change_OSDColorLookup(void);
 332      =1  void Reset_OSDColorLookup(void);
 333      =1  
 334      =1  //====================================================================
 335      =1  //                              Conversion
 336      =1  //====================================================================
 337      =1  BYTE utoa(WORD value, BYTE *str, BYTE radix);
 338      =1  BYTE ltoa_K(long value, BYTE *str, BYTE);
 339      =1  BYTE strlen( BYTE *str );
 340      =1  
 341      =1  #define CStrlen(A)                              strlen(A)
 342      =1  
 343      =1  void WaitEndofDisplayArea(void);
 344      =1  
 345      =1  #endif  // __OSD_BASIC__
  21          #include "dispinfo.h"
   1      =1  #ifndef __DISPINFO__
   2      =1  #define __DISPINFO__
   3      =1  //==================================================================
   4      =1  //                              Display Information
   5      =1  //==================================================================
   6      =1  #if (defined WQVGA) && (defined ANALOG_7INCH)
           =1 #define         INPUTINFO_ZOOM          WINZOOMx1
           =1 #define         LOGO_ZOOM                       WINZOOMx3
           =1 
           =1 #else // (defined WQVGA) && (defined SHARP_LQ043T3DX02)
  11      =1  #define         INPUTINFO_ZOOM          WINZOOMx2
  12      =1  #define         LOGO_ZOOM                       WINZOOMx2
  13      =1  #endif
  14      =1  //#define               VOL_ZOOM                        WINZOOMx4
  15      =1  #define         MUTE_ZOOM                       WINZOOMx3
  16      =1  #define         TVCHN_ZOOM                      WINZOOMx4
  17      =1  #define         RATINGINFO_ZOOM         WINZOOMx3
  18      =1  #define     SCANTV_ZOOM                 WINZOOMx2               //ljy012304
  19      =1  #define         PCINFO_ZOOM                     WINZOOMx2
  20      =1  #define     BAR_ZOOM                    WINZOOMx2
  21      =1  
  22      =1  
  23      =1  #define DVRStatus_OSDWIN        4 
  24      =1  #define DVRStatus_ADDR  195 
  25      =1  
  26      =1  extern  IDATA BYTE  DisplayedOSD;
  27      =1  
  28      =1  
  29      =1  void ClearDisplayedOSD( BYTE newd );
  30      =1  void SetDisplayedOSD( BYTE newd );
  31      =1  BYTE GetDisplayedOSD(void);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 33  

  32      =1  void ClearOSDInfo(void);
  33      =1  
  34      =1  void DisplayInput(void);
  35      =1  BYTE ClearInput(void);
  36      =1  
  37      =1  
  38      =1  void DisplayLogo(void);
  39      =1  void ClearLogo(void);
  40      =1  
  41      =1  void DisplayPCInfo(BYTE CODE *ptr);
  42      =1  void ClearPCInfo(void);
  43      =1  void DisplayAutoAdjust(void);
  44      =1  void ClearAutoAdjust(void);
  45      =1  
  46      =1  
  47      =1  void DisplayVol(void);
  48      =1  #if 0
           =1 void DisplayMuteInfo(void);
           =1 #endif
  51      =1  void ClearMuteInfo(void);
  52      =1  BYTE CheckAndClearOSD(void);
  53      =1  
  54      =1  //==================================================================
  55      =1  //                                              TV Info
  56      =1  //==================================================================
  57      =1  
  58      =1  BYTE ClearTVInfo(void);
  59      =1  
  60      =1  #endif  // __DISPINFO__
  22          #include "debug.h"
   1      =1  #ifndef __DEBUG__
   2      =1  #define __DEBUG__
   3      =1  
   4      =1  #define DEBUG_ERR       1
   5      =1  #define DEBUG_WARN      2
   6      =1  #define DEBUG_INFO      3
   7      =1  #define DEBUG_BREAK     4
   8      =1  
   9      =1  #define Pause(a)        { Printf("\r\n"); Printf(a); while(!RS_ready()); RS_rx(); }
  10      =1  
  11      =1  //#define BURSTLOCK     7
  12      =1  
  13      =1  void DebugWindowControl (void) ;
  14      =1  void Draw_Debug_Char(void);
  15      =1  void DebugWindowCursor( BYTE flag ) ;
  16      =1  void DebugWindowData( BYTE flag ) ;
  17      =1  void Debug_Write(void);
  18      =1  void Debug_Read(void);
  19      =1  
  20      =1  
  21      =1  
  22      =1  #endif  // __DEBUG__
  23      =1  
  24      =1  #ifdef CHIP_MANUAL_TEST
           =1 BYTE DelaynCheck(void);
           =1 void ChipManualTest(void);
           =1 
           =1 #endif
  23          #include "etc_eep.h"
   1      =1  #ifndef __ETC_EEP__
   2      =1  #define __ETC_EEP__
   3      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 34  

   4      =1  
   5      =1  ////eeprom.h
   6      =1  
   7      =1  //=========================================================================
   8      =1  //      EEPROM structure
   9      =1  //      0x00    BYTE    4       'TW88'
  10      =1  #define EEP_FWREV_MAJOR                 0x04    //BYTE  1       F/W Rev.-major(Hex)     
  11      =1  #define EEP_FWREV_MINOR                 0x05    //BYTE  1       F/W Rev.-minor(Hex)
  12      =1  #define EEP_DEBUGLEVEL                  0x06    //BYTE  1       DebugLevel
  13      =1  //
  14      =1  #define EEP_AUTODETECT                  0x07    //BYTE  1       Flag for Input Auto Detect      -0:Auto, 1:NTSC,....
  15      =1  #define EEP_AUTODETECTTYTE              0x08    //BYTE  1       Type of Auto-detect(will be value of register 0x1d)
  16      =1  //                      ---------------------------------------------------------------
  17      =1  #define EEP_WIDEMODE                    0x09    //BYTE  1   Wide Mode
  18      =1  
  19      =1  #define EEP_AUTORECOGNITION             0x0a    //BYTE  1       Auto Recognition
  20      =1  #define EEP_VIDEOMODE                   0x0b    //BYTE  1   Video Mode
  21      =1  
  22      =1  #define EEP_OSDLANG                             0x0c    //BYTE  1   OSDLang                                             // 0
  23      =1  
  24      =1  #define EEP_OSDPOSITIONMODE     0x0d    //BYTE  1       OSD Position Mode
  25      =1  #define EEP_CCD                                 0x0e    //BYTE  1       Closed Caption- 0: off, 1:on
  26      =1  
  27      =1  #define EEP_INPUTSELECTION              0x0f    //BYTE  1       InputSelection
  28      =1  
  29      =1  //
  30      =1  #define EEP_PC_CONTRAST                 0x10
  31      =1  #define EEP_PC_BRIGHT                   0x11
  32      =1  
  33      =1  #define EEP_CONTRAST                    0x12    //BYTE  1       Contrast 
  34      =1  #define EEP_BRIGHTNESS                  0x13    //BYTE  1       Brightness
  35      =1  #define EEP_SATURATION_U                0x14    //BYTE  1       Saturation :U
  36      =1  #define EEP_SATURATION_V                0x15    //BYTE  1       Saturation :V
  37      =1  #define EEP_SHARPNESS                   0x16    //BYTE  1       Sharpness 
  38      =1  #define EEP_HUE                                 0x17    //BYTE  1       Hue                    
  39      =1  
  40      =1  //====================================HS AWT 981001
  41      =1  #define  EEP_AutoMode           0xa0
  42      =1  #define  EEP_IMAGEMode          0xa1
  43      =1  #define  EEP_RearMode           0xa2
  44      =1  #define  EEP_COSDMode           0xa3
  45      =1  #define  EEP_GAUGEMode          0xa4
  46      =1  #define  EEP_CAMAMode           0xa5 
  47      =1  #define  EEP_CAMBMode           0xa6
  48      =1  #define  EEP_CAMCMode           0xa7
  49      =1  #define  EEP_CAMRMode           0xa8
  50      =1  #define  EEP_CAMOutMode         0xa9    
  51      =1  #define  EEP_TimeStep           0xaa
  52      =1  #define  EEP_Powerflag          0xab   
  53      =1  #define  EEP_ONOFFChoice        0xac 
  54      =1  
  55      =1  #define  EEP_PRIORITY           0xad
  56      =1  #define  EEP_JUMPMode           0xae
  57      =1  #define  EEP_NowModeState       0xaf
  58      =1  #define  EEP_SelectMode         0xb0
  59      =1  #define  EEP_PriorityOffSelectMode      0xb1
  60      =1  #define  EEP_AudioRecord                0xb2
  61      =1  
  62      =1  #define  EEP_FirstNumber                0xb3
  63      =1  #define  EEP_SecondNumber               0xb4
  64      =1  #define  EEP_ThridNumber                0xb5
  65      =1  #define  EEP_FourthNumber               0xb6
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 35  

  66      =1  
  67      =1  #define  EEP_CAMNUMBER     0xb7
  68      =1  #define  EEP_PELCO                 0xb8
  69      =1  #define  EEP_Baud_rate     0xb9
  70      =1  #define  EEP_TriggerVGA    0xba
  71      =1  #define  EEP_DVRDisplay    0xbb
  72      =1  #define  EEP_IMAGE_A_Mode    0xbc//andy A1.4 20100113
  73      =1  #define  EEP_IMAGE_B_Mode    0xbd//andy A1.4 20100113
  74      =1  #define  EEP_IMAGE_C_Mode    0xbe//andy A1.4 20100113
  75      =1  
  76      =1  //#define  EEP_SelectModeBuf         0xb2
  77      =1  
  78      =1  #if 0
           =1 #define  EEP_Resolution                 0xc0
           =1 #define  EEP_FPS                                0xc1
           =1 #define  EEP_Quality                    0xc2
           =1 #define  EEP_RecordMode                 0xc3
           =1 #define  EEP_RecordLength               0xc4
           =1 #define  EEP_PreAlarmLength             0xc5
           =1 #define  EEP_PostAlarmLength    0xc6
           =1 #endif
  87      =1  //====================================HS AWT 981001
  88      =1  
  89      =1  //
  90      =1  //              ---------------------------------------------------------------
  91      =1  #define EEP_PCAUDIOPVOL         0x37    //BYTE  1   AudioVol
  92      =1  #define EEP_AUDIOPVOL                   0x38    //BYTE  1   AudioVol
  93      =1  #define EEP_AUDIOBALANCE                0x39    //BYTE  1   AudioBalance
  94      =1  //
  95      =1  //              ---------------------------------------------------------------
  96      =1  
  97      =1  #define EEP_BLOCKMOVIE                  0x40    //BYTE  1       BlockedMovie:Blocked rating for Movie   
  98      =1  #define EEP_BLOCKTV                             0x41    //BYTE  1       BlockedTV:Blocked rating for TV                 
  99      =1  #define EEP_FVSLD                               0x42    //BYTE  6
 100      =1  //                                                              7    6       4    3    2    1    0
 101      =1  //  FVSLD Level                        ALL   FV(V)   S    L    D    
 102      =1  //  0x43    BYTE    1   TV-Y            X  
 103      =1  //  0x44        BYTE    1   TV-Y7           X    X 
 104      =1  //  0x45        BYTE    1   TV-G            X 
 105      =1  //  0x46        BYTE    1   TV-PG           X       X    X    X    X
 106      =1  //  0x47        BYTE    1   TV-14           X       X    X    X    X 
 107      =1  //  0x48        BYTE    1   TV-MA           X       X    X    X
 108      =1  //
 109      =1  #define EEP_VCHIPPASSWORD               0x49    //BYTE  4   OSDPassword                                 //Defualt:3366
 110      =1  //                      ---------------------------------------------------------------
 111      =1  //
 112      =1  //
 113      =1  //      0x61    WORD    2   PanelXRes
 114      =1  //      0x63    WORD    2       PanelYRes
 115      =1  //      0x65    BYTE    1       PanelHsyncMinPulseWidth
 116      =1  //      0x66    BYTE    1       PanelVsyncMinPulseWidth
 117      =1  //      0x67    WORD    2       PanelHminBackPorch
 118      =1  //      0x69    BYTE    1       PanelHsyncPolarity
 119      =1  //      0x6a    BYTE    1       PanelVsyncPolarity
 120      =1  //      0x6b    WORD    2       PanelDotClock
 121      =1  //      0x6d    BYTE    1       PanelPixsPerClock
 122      =1  //      0x6e    BYTE    1       PanelDEonly
 123      =1  //                      ---------------------------------------------------------------
 124      =1  //
 125      =1  //      0x80    PC Data
 126      =1  //
 127      =1  //                      ---------------------------------------------------------------
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 36  

 128      =1  //
 129      =1  //      0x300   TV Data
 130      =1  //
 131      =1  //      --- NTSC_TV -------------------------------------------------------------
 132      =1  //      CNT_SAVEDAIR                    BYTE    1   Total count of saved Air TV Channel.
 133      =1  //      IDX_CURAIR                              BYTE    1   Index of Current Air TV Channel
 134      =1  //      CHN_CURAIR                              BYTE    1   Current Air TV Channel.
 135      =1  //
 136      =1  //      FIRSTSAVED_AIRCHN               BYTE    1       First saved Air TV channel no   (maximum 100)
 137      =1  //      ....
 138      =1  //
 139      =1  //      CNT_SAVEDCABLE                  BYTE    1   Total count of saved Cable TV Channel.
 140      =1  //      IDX_CURCABLE                    BYTE    1   Index of Current Cable TV Channel
 141      =1  //      CHN_CURCABLE                    BYTE    1   Current Cable TV Channel.
 142      =1  //
 143      =1  //      FIRSTSAVED_CABLECHN             BYTE    1       First saved Cable TV channel no (maximum 100)
 144      =1  //
 145      =1  //      --- PAL_TV --------------------------------------------------------------
 146      =1  //      PR_CUR                                  BYTE    1   Current PR no.
 147      =1  //      FIRST_SAVEDPR                   DWORD   4   Freq of PR0.        (TOTAL_PR)
 148      =1  //      FIRST_SAVEDPR+4                 DWORD   4   Freq of PR1.
 149      =1  //      .....
 150      =1  //
 151      =1  
 152      =1  
 153      =1  
 154      =1  //
 155      =1  // Offset of EEPROM
 156      =1  //
 157      =1  /*
 158      =1  #define VIDEOCONTRAST           0x18            // for NTSC.(PAL:0x20,SECAM:0x28)
 159      =1  #define VIDEOBRIGHTNESS         0x19
 160      =1  #define VIDEOSATURATION_U       0x1a
 161      =1  #define VIDEOSATURATION_V       0x1b
 162      =1  #define VIDEOHUE                        0x1c            // only for NTSC
 163      =1  #define VIDEOSHARPNESS          0x1d
 164      =1  */
 165      =1  #define CCCOLOR         0x52
 166      =1  #define VOLZOOM         0x53
 167      =1  
 168      =1  #define PANELINFO       0x61
 169      =1  
 170      =1  // PAL_TV
 171      =1  #define  PR_CUR                                 0x301   
 172      =1  #define  FIRST_SAVEDPR                  0x308   
 173      =1   #define TVFREQ_HIGH 0 
 174      =1   #define TVFREQ_LOW  1
 175      =1  #ifdef PAL_TV
           =1  #define TVFINETUNE  2
           =1                 // NOT Finetune: 0 , Range: -32 ~ +32
           =1  #define TVPRSYSTEM  3  
           =1                 // bit 7: Add:1 Ereased :0
           =1                 // 
           =1  #define TVCHNAME    4
           =1 
           =1  #define BYTEPERCHANNEL 9 
           =1 #endif
 185      =1  // NTSC_TV
 186      =1  #define  EEP_TVInputSel                 0x302
 187      =1  #define  CHN_CURAIR                             0x303   
 188      =1  #define  FIRSTSAVED_AIRCHN              0x308   
 189      =1  #define  CHN_CURCABLE                   0x403   
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 37  

 190      =1  #define  FIRSTSAVED_CABLECHN    0x408   
 191      =1  #ifdef NTSC_TV
           =1  #define TVFINETUNE  0
           =1                 // NOT Finetune: 0 , Range: -32 ~ +32
           =1  #define TVPRSYSTEM  1  
           =1                 // bit 7: Add:1 Ereased :0
           =1                 // 
           =1  #define BYTEPERCHANNEL 2
           =1 #endif
 199      =1  
 200      =1  
 201      =1  
 202      =1  
 203      =1  WORD GetFWRevEE(void);
 204      =1  void SaveFWRevEE(WORD);
 205      =1  
 206      =1  BYTE GetDebugLevelEE(void);
 207      =1  void SaveDebugLevelEE(BYTE);
 208      =1  
 209      =1  #ifdef WIDE_SCREEN
 210      =1  BYTE GetWideModeEE(void);
 211      =1  void SaveWideModeEE(BYTE dl);
 212      =1  #endif
 213      =1  
 214      =1  
 215      =1  //BYTE GetRange4CoarseEE(void);
 216      =1  //void SaveRange4CoarseEE(BYTE);
 217      =1  
 218      =1  BYTE GetPossibleAutoDetectStdEE(void);
 219      =1  void SetPossibleAutoDetectStdEE(void);
 220      =1  
 221      =1  //BYTE GetOSDXPositionEE(void);
 222      =1  //BYTE GetOSDYPositionEE(void);
 223      =1  BYTE GetClosedCaptionFlagEE(void);
 224      =1  
 225      =1  BYTE GetVideoDatafromEE(BYTE);
 226      =1  void SaveVideoDatatoEE(BYTE offset, BYTE ndata);
 227      =1  
 228      =1  //BYTE GetVideoBrightnessEE(void);
 229      =1  //BYTE GetVideoSaturationEE(BYTE);
 230      =1  //BYTE GetVideoHueEE(void);
 231      =1  //BYTE GetVideoSharpnessEE(void);
 232      =1  
 233      =1  //void SaveVideoContrastEE(BYTE ndata);
 234      =1  //void SaveVideoBrightnessEE(BYTE ndata);
 235      =1  //void SaveVideoSaturationEE(BYTE, BYTE ndata);
 236      =1  //void SaveVideoHueEE(BYTE ndata);
 237      =1  //void SaveVideoSharpnessEE(BYTE ndata);
 238      =1  
 239      =1  BYTE GetOSDPositionModeEE(void);
 240      =1  void SaveOSDPositionModeEE(BYTE ndata);
 241      =1  //void SaveOSDXPositionEE(BYTE);
 242      =1  //void SaveOSDYPositionEE(BYTE);
 243      =1  
 244      =1  void SaveClosedCaptionFlagEE(BYTE);
 245      =1  
 246      =1  BYTE GetBlockedTVEE(void);                      
 247      =1  void SaveBlockedTVEE(BYTE vi);          
 248      =1  BYTE GetBlockedTV_FLDSLEE( BYTE level ) ;
 249      =1  void SaveBlockedTV_FLDSLEE(BYTE level, BYTE vi) ;
 250      =1  
 251      =1  BYTE GetBlockedMovieEE(void);           
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 38  

 252      =1  void SaveBlockedMovieEE(BYTE vi);       
 253      =1  #if 0
           =1 BYTE GetInputSelectionEE(void);
           =1 #endif
 256      =1  void SaveInputSelectionEE(BYTE val);
 257      =1  
 258      =1  //BYTE GetOSDDurationEE(void);
 259      =1  //void SaveOSDDurationEE(BYTE val);
 260      =1  
 261      =1  BYTE GetOSDLangEE(void);
 262      =1  void SaveOSDLangEE(BYTE val);
 263      =1  
 264      =1  //ljy100303...BYTE GetOSDZoomEE(void);
 265      =1  //ljy100303...void SaveOSDZoomEE(BYTE val);
 266      =1  
 267      =1  BYTE GetAudioVolEE(void);
 268      =1  void SetAudioVolEE( BYTE vol );
 269      =1  BYTE GetPCAudioVolEE(void);
 270      =1  void SetPCAudioVolEE( BYTE vol );
 271      =1  #if 0
           =1 BYTE GetAudioBalanceEE(void);
           =1 void SetAudioBalanceEE( BYTE vol );
           =1 BYTE GetAudioBassEE(void);
           =1 void SetAudioBassEE( BYTE vol );
           =1 BYTE GetAudioTrebleEE(void);
           =1 void SetAudioTrebleEE( BYTE vol );
           =1 #endif
 279      =1  //BYTE GetAudioEffectEE(void);
 280      =1  //void SetAudioEffectEE( BYTE vol );
 281      =1  
 282      =1  void ClearBasicEE(void);
 283      =1  
 284      =1  BYTE ValidPassword(DATA_P BYTE *numstr, BYTE index);
 285      =1  BYTE SetNewPassword(DATA_P BYTE *numstr, BYTE index);
 286      =1  
 287      =1  //WORD GetPanelXRes(void);
 288      =1  //WORD GetPanelYRes(void);
 289      =1  BYTE GetPanelHsyncMinPulseWidth(void);
 290      =1  BYTE GetPanelVsyncMinPulseWidth(void);
 291      =1  WORD GetPanelHMinBackPorch(void);
 292      =1  BYTE GetPanelHsyncPolarity(void);
 293      =1  BYTE GetPanelVsyncPolarity(void);
 294      =1  WORD GetPanelDotClock(void);
 295      =1  WORD GetPanelMaxClock(void);
 296      =1  BYTE GetPanelPixsPerClock(void);
 297      =1  // Not used yet *************************  BYTE GetPanelDEonly(void);
 298      =1  
 299      =1  void AddTVChannelEE( BYTE tvtype, BYTE chn);
 300      =1  BYTE GetTVChannelEE( BYTE tvtype, BYTE inx);
 301      =1  void ResetTVChannelEE( BYTE tvtype );
 302      =1  BYTE GetTVChannelCntEE(BYTE tvtype);
 303      =1  BYTE GetTVChnIdxEE(BYTE tvtype);
 304      =1  BYTE GetCurTVChannelEE(BYTE tvtype);
 305      =1  void SetTVChnIdxEE(BYTE tvtype, BYTE newd);
 306      =1  void SetCurTVChannelEE(BYTE tvtype, BYTE newd);
 307      =1  BYTE InsertTVChannelEE(BYTE tvtype, BYTE newd);
 308      =1  BYTE RemoveTVChannelEE(BYTE tvtype, BYTE newd);
 309      =1  
 310      =1  void SetTVPrEE(void);
 311      =1  BYTE GetTVPrEE(void);
 312      =1  void SetTVFreqEE(BYTE, WORD);
 313      =1  WORD GetTVFreqEE(BYTE);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 39  

 314      =1  void SetFineTuneEE(BYTE, BYTE);
 315      =1  BYTE GetFineTuneEE(BYTE);
 316      =1  BYTE GetTVPrSystem(BYTE);
 317      =1  void SetTVPrSystem(BYTE, BYTE);
 318      =1  BYTE GetTVInputSelEE(void);
 319      =1  void SetTVInputSelEE(BYTE);
 320      =1  
 321      =1  #define GetVInputStdDetectModeEE()                              ReadEEP(EEP_AUTODETECTTYTE)
 322      =1  #define SaveVInputStdDetectModeEE(A)                    WriteEEP(EEP_AUTODETECTTYTE, A)
 323      =1  
 324      =1  #define GetAutoRecogntionEE()                                   ReadEEP(EEP_AUTORECOGNITION)
 325      =1  #define SaveAutoRecogntionEE(A)                                 WriteEEP(EEP_AUTORECOGNITION, A)
 326      =1  
 327      =1  #define SetVideoModeEE( ctid )                                  WriteEEP( EEP_VIDEOMODE, ctid )
 328      =1  #define GetVideoModeEE()                                                ReadEEP( EEP_VIDEOMODE )
 329      =1  
 330      =1  #define GetPanelContrastEE()                                    ReadEEP(0x10)
 331      =1  
 332      =1  #if defined( SUPPORT_PC ) || defined( SUPPORT_DTV )
 333      =1  //#define GetPanelHueEE()                                                       ReadEEP(0x28)
 334      =1  //#define GetPanelSharpnessEE()                                 ReadEEP(0x29)
 335      =1  #define GetPanelBrightnessEE()                                  ReadEEP(0x11)
 336      =1  //#define GetPanelSaturationEE()                                        ReadEEP(0x2a)
 337      =1  
 338      =1  //#define SavePanelHueEE(A)                                             WriteEEP(0x28, A)
 339      =1  //#define SavePanelSharpnessEE(A)                                       WriteEEP(0x29, A)
 340      =1  #define SavePanelContrastEE(A)                                  WriteEEP(0x10, A)
 341      =1  #define SavePanelBrightnessEE(A)                                WriteEEP(0x11, A)
 342      =1  //#define SavePanelSaturationEE(A)                              WriteEEP(0x2a, A)
 343      =1  #endif
 344      =1  
 345      =1  /*
 346      =1  #define GetDigitalVideoContrastEE()                             ReadEEP(0x2b)
 347      =1  #define GetDigitalVideoBrightnessEE()                   ReadEEP(0x2c)
 348      =1  #define GetDigitalVideoHueEE()                                  ReadEEP(0x2d)
 349      =1  #define GetDigitalVideoSaturationEE(off)                ReadEEP(0x2e+off)
 350      =1  
 351      =1  #define SaveDigitalVideoContrastEE(A)                   WriteEEP(0x2b, A)
 352      =1  #define SaveDigitalVideoBrightnessEE(A)                 WriteEEP(0x2c, A)
 353      =1  #define SaveDigitalVideoHueEE(A)                                WriteEEP(0x2d, A)
 354      =1  #define SaveDigitalVideoSaturationEE(off,A)             WriteEEP(0x2e+off, A)
 355      =1  */
 356      =1  
 357      =1  #endif  // __ETC_EEP__
  24          #include "measure.h"
   1      =1  #ifndef __MEASURE__
   2      =1  #define __MEASURE__
   3      =1  
   4      =1  #define EE_DOS                          0
   5      =1  
   6      =1  #define EE_SP1                          1
   7      =1  #define EE_SP2                          2
   8      =1  #define EE_SP3                          3
   9      =1  
  10      =1  #define EE_VGA_60                       4
  11      =1  #define EE_VGA_66                       5
  12      =1  #define EE_VGA_70                       6
  13      =1  #define EE_VGA_72                       7
  14      =1  #define EE_VGA_75                       8
  15      =1  #define EE_VGA_85                       9
  16      =1  
  17      =1  #define EE_SVGA_56                      10
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 40  

  18      =1  #define EE_SVGA_60                      11
  19      =1  #define EE_SVGA_70                      12
  20      =1  #define EE_SVGA_72                      13
  21      =1  #define EE_SVGA_75                      14
  22      =1  #define EE_SVGA_85                      15
  23      =1  
  24      =1  #define EE_832_75                       16
  25      =1  
  26      =1  #define EE_XGA_60                       17
  27      =1  #define EE_XGA_70                       18
  28      =1  #define EE_XGA_72                       19
  29      =1  #define EE_XGA_75                       20
  30      =1  #define EE_XGA_85                       21
  31      =1  
  32      =1  #define EE_1152_60                      22
  33      =1  #define EE_1152_70                      23
  34      =1  #define EE_1152_75                      24
  35      =1  
  36      =1  #define EE_SXGA_60                      25
  37      =1  #define EE_SXGA_70                      26
  38      =1  #define EE_SXGA_75                      27
  39      =1  
  40      =1  #define EE_RGB_480P                     28
  41      =1  #define EE_RGB_720P                     29
  42      =1  #define EE_RGB_720P50           30
  43      =1  #define EE_RGB_1080I            31
  44      =1  #define EE_RGB_1080I50A         32
  45      =1  #define EE_RGB_1080I50B         33
  46      =1  #define EE_RGB_480I                     34
  47      =1  #define EE_RGB_576I                     35
  48      =1  #define EE_RGB_576P                     36
  49      =1  
  50      =1  #define EE_YPbPr_480P           37
  51      =1  #define EE_YPbPr_720P           38
  52      =1  #define EE_YPbPr_720P50         39
  53      =1  #define EE_YPbPr_1080I          40
  54      =1  #define EE_YPbPr_1080I50A       41
  55      =1  #define EE_YPbPr_1080I50B       42
  56      =1  #define EE_YPbPr_480I           43
  57      =1  #define EE_YPbPr_576I           44
  58      =1  #define EE_YPbPr_576P           45
  59      =1  
  60      =1  #define EE_PC_MAX                       46
  61      =1  
  62      =1  #define EE_PC_NO_SIGNAL         0xfe
  63      =1  #define EE_PC_UNKNOWN           0xff
  64      =1  
  65      =1  struct _PCMDATA {
  66      =1          CODE_P BYTE  Support;
  67      =1          CODE_P WORD  HAN;
  68      =1          CODE_P WORD  VAN;
  69      =1          CODE_P WORD  IVF;
  70      =1          CODE_P WORD  CLOCK;
  71      =1          CODE_P WORD  low;
  72      =1          CODE_P WORD  high;
  73      =1          CODE_P WORD  Hstart;
  74      =1          CODE_P WORD  Vstart;
  75      =1          CODE_P WORD  IPF;               // 0.1MHz
  76      =1          CODE_P WORD  PPF;               // 0.1MHz
  77      =1          CODE_P BYTE  VBack;
  78      =1  };
  79      =1  #ifndef AUTOCALC_PC
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 41  

           =1 
           =1 #ifdef SUPPORT_DTV
           =1 struct _DTVMDATA {
           =1         CODE_P BYTE Reg62;
           =1         CODE_P BYTE RegBC;
           =1         CODE_P BYTE RegBD;
           =1         CODE_P BYTE RegBE;
           =1         CODE_P WORD PHP;
           =1 };
           =1 #endif
           =1 #endif
  91      =1  #if defined     XGA
           =1         #define MAX_PPF          90000000
           =1 #elif defined SXGA
           =1         #define MAX_PPF         135000000
           =1 #elif defined WXGA
           =1         #define MAX_PPF          90000000
           =1 #elif defined WVGA
  98      =1          #define MAX_PPF          90000000
  99      =1  #elif defined VGA
           =1         #define MAX_PPF          50000000
           =1 #elif defined SVGA
           =1         #define MAX_PPF          80000000
           =1 #elif defined QVGA
           =1         #define MAX_PPF          30000000
           =1 #elif defined WQVGA
           =1         #define MAX_PPF          30000000
           =1 #endif
 108      =1  
 109      =1  extern BYTE cLastSyncLoss;
 110      =1  extern BYTE PcMode;
 111      =1  
 112      =1  void CompLT170E2(void);
 113      =1  
 114      =1  WORD gap(WORD a, WORD b);
 115      =1  
 116      =1  //===================================================================
 117      =1  WORD GetHpnVpn(BYTE);
 118      =1  
 119      =1  WORD ConvertBasedOnInput(WORD dat);
 120      =1  
 121      =1  BYTE IsDTVInput(void);
 122      =1  
 123      =1  void SetVValueForPanel(WORD vstart);
 124      =1  BYTE SetHValueForPanel(void);
 125      =1  BYTE GetActiveRegion(void);
 126      =1  
 127      =1  BYTE DetectAndSetForVGAInput(BYTE);
 128      =1  #ifdef SUPPORT_DTV
           =1 BYTE DetectAndSetForDTVInput(BYTE);
           =1 #endif
 131      =1  void CheckPCinput(void);
 132      =1  void CheckDTVinput(void);
 133      =1  
 134      =1  WORD GetCoarseValue(void);
 135      =1  BYTE GetPhaseValue(void);
 136      =1  WORD SetPCCoarseValue(BYTE val);
 137      =1  BYTE SetPhaseValue(BYTE val);
 138      =1  
 139      =1  void DisplayResultAndSetActiveRange(void);
 140      =1  
 141      =1  //=============================================================================
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 42  

 142      =1  //                    PC Screen Position Move Functions
 143      =1  //=============================================================================
 144      =1  void MoveActiveVpos(BYTE val);          // Up/Down
 145      =1  void MoveActiveHpos(BYTE val);          // Left/Right
 146      =1  
 147      =1  BYTE GetVPosition(void);
 148      =1  BYTE SetVPosition(BYTE val);
 149      =1  BYTE GetHPosition(void);
 150      =1  BYTE SetHPosition(BYTE val);
 151      =1  
 152      =1  void ResetPCValue(void);
 153      =1  
 154      =1  CODE_P BYTE *GetPCInputSourceName(void);
 155      =1  BYTE AutoAdjust(void);
 156      =1  
 157      =1  #endif // __MEASURE__
  25          #include "Printf.h"
   1      =1  #ifndef __PRINTF__
   2      =1  #define __PRINTF__
   3      =1  
   4      =1  #define _outchar(c) while(1) { if( !RS_Xbusy ) { SBUF = c; RS_Xbusy=1; break; } }
   5      =1  #define Putch(c) _outchar(c)
   6      =1  
   7      =1  #ifdef SERIAL
   8      =1  
   9      =1   void Printf ( const char CODE_P *fmt, ... );
  10      =1   void Puts ( CODE_P char *ptr );
  11      =1  
  12      =1  #define TW2835Cmd(a)   Puts ( a )
  13      =1  
  14      =1  #else
           =1 
           =1  #undef  DEBUG
           =1  #define Printf(a,b)    //
           =1  #define Puts(a)                //
           =1 
           =1 #endif
  21      =1  
  22      =1  
  23      =1  #ifndef DEBUG
  24      =1  
  25      =1   #define dPuts(a)               //
  26      =1   #define wPuts(a)               //
  27      =1   #define ePuts(a)               //
  28      =1  
  29      =1  #else
           =1 
           =1  void dPrintf( const char CODE_P *fmt, ... );
           =1  void wPrintf( const char CODE_P *fmt, ... );
           =1  void ePrintf( const char CODE_P *fmt, ... );
           =1 
           =1  void dPuts( CODE_P char *ptr );
           =1  void wPuts( CODE_P char *ptr );
           =1  void ePuts( CODE_P char *ptr );
           =1 
           =1 #endif  // DEBUG
  40      =1  
  41      =1  BYTE Getch(void);
  42      =1  BYTE Getche(void);
  43      =1  
  44      =1  
  45      =1  #endif  //__PRINTF__
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 43  

  26          #include "audio.h"
   1      =1  
   2      =1  
   3      =1  extern  BYTE    AudioVol;
   4      =1  extern  BYTE    PCAudioVol;
   5      =1  
   6      =1  //BYTE ResetMSP(void);
   7      =1  //void SetMSPSCARTPrescale(void);
   8      =1  //void SetMSPSourceSel(void);
   9      =1  //void SetMSPVol(void);
  10      =1  
  11      =1  //BYTE AudioAutoStdDetection(void);
  12      =1  //BYTE SteroMonoDetection(void);
  13      =1  
  14      =1  //BYTE TunerAudio(void);
  15      =1  //void ExtAudio(void);
  16      =1  //id PCAudio(void);
  17      =1  //id MuteOn(void);
  18      =1  //BYTE GetAudioVol(void);
  19      =1  BYTE ChangeVol(char);
  20      =1  //BYTE GetAudioBalance(void);
  21      =1  //BYTE ChangeBalance(char);
  22      =1  //BYTE GetAudioBass(void);
  23      =1  //BYTE ChangeBass(char);
  24      =1  //BYTE GetAudioTreble(void);
  25      =1  //BYTE ChangeTreble(char);
  26      =1  //BYTE GetAudioEffect(void);
  27      =1  //BYTE ChangeAudioEffect(char amount);
  28      =1  //void ToggleAudioMute(void);
  29      =1  //void CheckAndClearMuteOn(void);
  30      =1  
  31      =1  //BYTE IsAudioMuteOn(void);
  32      =1  //void SetAudioMute(BYTE on );
  33      =1  //void ChangeMTS(BYTE type);
  34      =1  //void AudioOff(void);
  35      =1  void AudioMute(bit mute);
  36      =1  
  37      =1  //#define AudioOn()                     SetMSPVol()
  38      =1  //void ResetAudioValue();
  27          #include "osdmenu.h"
   1      =1  //osdmenu.h
   2      =1  //LJY10292001
   3      =1  #ifndef __OSDMENU__
   4      =1  #define __OSDMENU__
   5      =1  
   6      =1  //=======================================================================
   7      =1  // 
   8      =1  //BYTE GetOSDDuration(void);
   9      =1  
  10      =1  void ResetVideoValue(void);
  11      =1  //#if defined( SUPPORT_PC ) || defined( SUPPORT_DTV )
  12      =1  //void ResetPCValue(void);
  13      =1  //#endif
  14      =1  BYTE GetOSDMenuLevel( void );
  15      =1  
  16      =1  void DrawMenulist(BYTE);
  17      =1  void Display_EnterPin(void);
  18      =1  void OSDHighMenu_sub(void);
  19      =1  void ResetOSDValue(void);
  20      =1  #ifdef E_Wintek
           =1 void ResetUESROSDValue(void);
           =1 #endif
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 44  

  23      =1  //BYTE OnChangingValue(void);
  24      =1  //Not used yet *******************BYTE OnChangingTime(void);
  25      =1  
  26      =1  //WORD GetOSDclock(void);
  27      =1  
  28      =1  void InitOSDMenu(void);
  29      =1  BYTE CloseOSDMenu(void);
  30      =1  void OpenOSDMenu(void);
  31      =1  void OSDHighMenu(void);
  32      =1  void OSDSelect(void);
  33      =1  void OSDCursorMove(BYTE flag );
  34      =1  void OSDLeftRight(BYTE flag );
  35      =1  void OSDValueUpDn(BYTE flag);
  36      =1  WORD SetItemValue( BYTE id, BYTE flag );
  37      =1  BYTE DoAction(BYTE id);
  38      =1  
  39      =1  BYTE SaveValue1(void);
  40      =1  void ClearValueWin(void);
  41      =1  
  42      =1  void OSDNumber( BYTE num );
  43      =1  
  44      =1  void Set4WideScreen(BYTE id);
  45      =1  
  46      =1  void SetRGBContrast( BYTE id, BYTE val );
  47      =1  BYTE SetPCColorTemp(BYTE flag);
  48      =1  void ResetPanelAttributeValue(void);
  49      =1  WORD GetItemValue( BYTE);
  50      =1  void DisplayViewBar( WORD,BYTE);
  51      =1  void DrawNum(WORD, CODE_P struct NumType *, WORD);
  52      =1  void DrawStringByLang( WORD, CODE_P struct EnumType *, WORD);
  53      =1  
  54      =1  void DisplayVolumebar(BYTE val);
  55      =1  BYTE GetOSDLang(void);
  56      =1  void InitOSDMenuXY(void);
  57      =1  
  58      =1  void Display_TVGuide_Window(void);
  59      =1  void Display_TVGuide_Status(void);
  60      =1  
  61      =1  void ChangeVchip_LevelCursor(BYTE);
  62      =1  void ChangeVchip_ContentCursor(BYTE);
  63      =1  void Select_VchipLevel(void);
  64      =1  void SetVideoMode(BYTE mode);
  65      =1  BYTE GetVideoDatawithOffset(BYTE offset);
  66      =1  void SetVideoContrast(BYTE newv);
  67      =1  void SetVideoBrightness(BYTE newv);
  68      =1  void SetVideoHue(BYTE newv) ;
  69      =1  void SetVideoSaturation(BYTE svtype, BYTE newv) ;
  70      =1  BYTE SetVideoSharpness(BYTE flag) ;
  71      =1  void SetVideoBacklight(BYTE newv) ;
  72      =1  //------------------------------------------------andy awt 981013
  73      =1  //void DaySelect(BYTE);
  74      =1  void CAMOutDSel(BYTE val);
  75      =1  void DVRAodioSel(BYTE  val);
  76      =1  
  77      =1  //------------------------------------------------andy awt 981013
  78      =1  
  79      =1  void DisplayLineOSD(void);      // OSD Line display Demo
  80      =1  
  81      =1  
  82      =1  struct MenuType {
  83      =1          BYTE    width,  height;
  84      =1          BYTE    TitleColor;     
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 45  

  85      =1          BYTE    CursorColor;
  86      =1  };
  87      =1  
  88      =1  struct NumType {
  89      =1          BYTE    PrePostCharLen;         // high nibble(pre) / low nibble(post)
  90      =1          BYTE    PrePostChar[4];
  91      =1  };
  92      =1  
  93      =1  struct NumberStringType {
  94      =1          BYTE    x, y;
  95      =1          BYTE    width;
  96      =1          BYTE    BackColor;
  97      =1          BYTE    Radix;
  98      =1          BYTE    NumColor;
  99      =1          BYTE    MaxLen;                         // maximum length of string
 100      =1          BYTE    PrePostCharLen;         // high nibble(pre) / low nibble(post)
 101      =1          BYTE    PrePostChar[3];
 102      =1  };
 103      =1  
 104      =1  struct TimeType {
 105      =1          BYTE    x, y;
 106      =1          BYTE    width;
 107      =1          BYTE    BackColor;
 108      =1          BYTE    Format;                         //_24H_TIME
 109      =1          BYTE    TimeColor;
 110      =1          BYTE    CursorColor;
 111      =1  };
 112      =1  
 113      =1  struct EnumType {
 114      =1          BYTE    Sz;//size
 115      =1          BYTE    ByLang;
 116      =1          BYTE    Str[15];                        // doesn't matter the size !!!
 117      =1  };
 118      =1  
 119      =1  #define ICON_CH_SZ              2
 120      =1  //#define BAR_NUM_SZ            4
 121      =1  #define ICON_BUF_SZ             2
 122      =1  struct DefineMenu {
 123      =1          //WORD                                          Icon[ICON_BUF_SZ];      
 124      =1          BYTE                            CODE    *Icon;
 125      =1          BYTE                                            **Desc;                         
 126      =1          BYTE                                            PreFnId, 
 127      =1                                                                  PostFnId;
 128      =1  //      void            (*CalltoFunction)(void);                                    // Un/Dn/Sel Function
 129      =1          BYTE                                            IconColor;                      //NIL: not to display icon
 130      =1          BYTE                                            DescColor;                      //NIL: not to display desc. (IconColor==NIL && DescColor==NIL)->Last Item
 131      =1          struct DefineMenu       CODE    *Child;
 132      =1          BYTE                                            Type;                           // MENU, CHOICEMENU, BAR, NUMBER, TIME, ACTION, ENUM_STRING
 133      =1          BYTE                                            ActiveWithCursor;
 134      =1          BYTE                                            Id;
 135      =1          BYTE                            CODE    *TypeData;      //MenuType, BarType, NumType,,,
 136      =1  } ;
 137      =1  
 138      =1  struct PictureInfo {
 139      =1  
 140      =1          BYTE Register_Addr;
 141      =1          BYTE EEPROM_Addr;
 142      =1          struct RegisterInfo     CODE    *Control_Range;
 143      =1  };
 144      =1  
 145      =1  
 146      =1  //-------------------------------------------------------------------
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 46  

 147      =1  // OSD Window Information
 148      =1  //-------------------------------------------------------------------
 149      =1  // Window Number
 150      =1  #define OSDCURSORWINDOW                 1
 151      =1  #define OSDMENUWINDOW                   OSDCURSORWINDOW+1
 152      =1  #define OSDMENU_TOPWIN                  OSDCURSORWINDOW+2
 153      =1  #define OSDMENU_TITLEWIN                OSDCURSORWINDOW+3
 154      =1  #define OSDBARWINDOW                    OSDCURSORWINDOW
 155      =1  
 156      =1  #define TECHWELLOGO_OSDWIN      1       
 157      =1  #define TVINFO_OSDWIN           2       
 158      =1  #define FONTTEST_OSDWIN         2       
 159      =1  #define INPUTINFO_OSDWIN        3  
 160      =1  #define RATINGINFO_OSDWIN       1       
 161      =1  #define PCINFO_OSDWIN           3//4/   
 162      =1  
 163      =1  //-------------OSDMENU_TITLEWIN------------------------------------------------------
 164      =1  // Window Start address
 165      =1  #define OSDMENU_MAINADDR        0
 166      =1  #define OSDMENU_SUBADDR     OSDMENU_MAINADDR+15    //25*9:196
 167      =1  #define OSDMENU_BARADDR         175 //OSDMENU_SUBADDR+225    //256   //25x2:50
 168      =1  
 169      =1  #define INPUTINFO_ADDR          160     // 9x1:9
 170      =1  #ifdef WQVGA
           =1 #define INPUTINFO1_ADDR         INPUTINFO_ADDR+17       //17x3:51
           =1 #else
 173      =1  #define INPUTINFO1_ADDR         INPUTINFO_ADDR+34       //17x2:51
 174      =1  #endif
 175      =1  
 176      =1  #define MUTEINFO_ADDR       INPUTINFO1_ADDR+51  // 4x1:4
 177      =1  #define TVCHINFO_ADDR           MUTEINFO_ADDR//324      // 3X1:3
 178      =1  #define LOGO_ADDR                       0
 179      =1  #define RATINGINFO_ADDR         0       //addr:210(8x1:8)
 180      =1  #define PCMEASUREINFO_ADDR  OSDMENU_BARADDR //10x1
 181      =1  
 182      =1  
 183      =1  //--------------------------------------------------------------------
 184      =1  // OSD Menu Position Range
 185      =1  #if ((defined WQVGA) && (defined ANALOG_7INCH)) || ((defined QVGA) && (defined SHARP_LQ050Q5DR01))
           =1         #define OSD_PHR_ PHR_/2
           =1 #else
 188      =1          #define OSD_PHR_ PHR_
 189      =1  #endif
 190      =1  
 191      =1  #define OSDHSTART_MAX (OSD_PHR_-(12+1)*25 - 56*2 -4)  //PHR - (pixelsize +Hspace)*MenuWidth - Hborder*2 - 
             -outlinewidth*2
 192      =1  #define OSDVSTART_MAX (PVR_-(18+11)*9 - 5*2 ) //  PVR - (Linesize+Vspace)*MENU_HEIGHT - Vborder*2  - outli
             -newidth*2
 193      =1  
 194      =1  #define OSDMENUX_MIN 1//0
 195      =1  #define OSDMENUX_MAX (OSDHSTART_MAX>>3)
 196      =1  #define OSDMENUX_50  (OSDHSTART_MAX>>4)
 197      =1  
 198      =1  #define OSDMENUY_MIN 2//0
 199      =1  #define OSDMENUY_MAX (OSDVSTART_MAX>>2)
 200      =1  #define OSDMENUY_50  (OSDVSTART_MAX>>3)
 201      =1  
 202      =1  //--------------------------------------------------------------------
 203      =1  // OSD Menu Width, Height 
 204      =1  #ifdef E_Wintek
           =1 #define ICON_HIGH                               0x14
           =1 #else
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 47  

 207      =1  #define ICON_HIGH                               0x0a
 208      =1  #endif
 209      =1  #define TOTAL_MAX_HIGHT                 9
 210      =1  
 211      =1  #define TOPMENU_WIDTH                   2
 212      =1  #define TOTAL_TOP_HEIGHT                5       // Include blank line!
 213      =1  
 214      =1  #define TOPMENU_HEIGHT                  4       
 215      =1  
 216      =1  #if (defined QVGA) && (defined SHARP_LQ050Q5DR01)
           =1 #define MENU_WIDTH                              17 //23//25 
           =1 #define TITLE_MAX_DESC                  17//25  //
           =1 #define BAR_LENGTH                              0
           =1 #else
 221      =1  #define MENU_WIDTH                              23//23//25 
 222      =1  #define TITLE_MAX_DESC                  23//25  //
 223      =1  #define BAR_LENGTH                              5//8
 224      =1  #endif
 225      =1  
 226      =1  #define MENU_HEIGHT                             7//6 
 227      =1  
 228      =1  #define BARNUM_LENGTH                   8       //11
 229      =1  #ifdef REFERENCE
           =1 #define BACK_COLOR                              BG_COLOR_CYAN
           =1 #define DEFAULT_COLOR                   BG_COLOR_CYAN   | CH_COLOR_WHITE
           =1 //#define ACTIVE_COLOR                  BG_COLOR_YELLOW | CH_COLOR_WHITE
           =1 #define TITLE_BACK_COLOR                BG_COLOR_MAGENTA
           =1 #define TITLE_COLOR                             TITLE_BACK_COLOR | CH_COLOR_YELLOW
           =1 #define COMMENT_COLOR                   TITLE_BACK_COLOR | CH_COLOR_WHITE
           =1 #define CURSOR_COLOR                    BG_COLOR_YELLOW | CH_COLOR_BLUE
           =1 #define OSD_INFO_COLOR                  DEFAULT_COLOR
           =1 #define BAR_COLOR                               DEFAULT_COLOR   
           =1 #define BAR_NUM_COLOR                   DEFAULT_COLOR
           =1 #define NUM_COLOR                               DEFAULT_COLOR
           =1 
           =1 #define OSDMENU_OUTLINE_COLOR   BG_COLOR_BLUE
           =1 
           =1 #else
 245      =1  #define BACK_COLOR                              BG_COLOR_CYAN
 246      =1  #define DEFAULT_COLOR                   BG_COLOR_CYAN | CH_COLOR_WHITE
 247      =1  //#define ACTIVE_COLOR                  BG_COLOR_YELLOW | CH_COLOR_WHITE
 248      =1  #define TITLE_BACK_COLOR                BG_COLOR_BLUE
 249      =1  #define TITLE_COLOR                             TITLE_BACK_COLOR | CH_COLOR_YELLOW
 250      =1  #define COMMENT_COLOR                   TITLE_BACK_COLOR | CH_COLOR_WHITE
 251      =1  #define CURSOR_COLOR                    BG_COLOR_YELLOW  | CH_COLOR_BLUE
 252      =1  #define OSD_INFO_COLOR                  BG_COLOR_CYAN    | CH_COLOR_GREEN
 253      =1  #define BAR_COLOR                               DEFAULT_COLOR   
 254      =1  #define BAR_NUM_COLOR                   DEFAULT_COLOR
 255      =1  #define NUM_COLOR                               DEFAULT_COLOR
 256      =1  
 257      =1  #define VER_COLOR               BG_COLOR_CYAN   | CH_COLOR_YELLOW   /// V1.1 03/07/07 simonsung
 258      =1  
 259      =1  
 260      =1  #define OSDMENU_OUTLINE_COLOR   BG_COLOR_CYAN
 261      =1  #endif 
 262      =1  
 263      =1  
 264      =1  //DisplayedOSD
 265      =1  //              new       |     MENU    TVINFO          CC              INPUTINFO               PCINFO          RATINGINFO
 266      =1  //      current   |
 267      =1  //============|=========================================================================
 268      =1  //      MENU      |                     TVINFO          --              INPUTINFO               PCINFO          MENU + RATINGINFO       
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 48  

 269      =1  //                        |                                              
 270      =1  //------------|-------------------------------------------------------------------------
 271      =1  //      TVINFO    |     MENU    TVINFO          --              INPUTINFO               PCINFO          TVINFO+RATING
 272      =1  //------------|-------------------------------------------------------------------------
 273      =1  //      CC                |     MENU->  TVINFO->                        INPUTINFO->             PCINFO          RATINGINFO
 274      =1  //                        |      CC              CC                                      CC                                              
 275      =1  //------------|-------------------------------------------------------------------------
 276      =1  //      INPUTINFO |     MENU    TVINFO          --              INPUTINFO               PCINFO          --
 277      =1  //------------|-------------------------------------------------------------------------
 278      =1  //      PCINFO    |     MENU    x                       x               INPUTINFO               PCINFO          x
 279      =1  //------------|-------------------------------------------------------------------------
 280      =1  //      RATINGINFO|     MENU    TVINFO     RATING   INPUTINFO           x                       RATINGINFO
 281      =1  //                                                                      
 282      =1  
 283      =1  //=======================================================================================
 284      =1  // OSD Menu Constant define.
 285      =1  //=======================================================================================
 286      =1  //Time type
 287      =1  #define _24H_TIME               1
 288      =1  
 289      =1  //for previous, next, parent or child
 290      =1  #define YES                             0xfe    
 291      =1  #define NO                              0
 292      =1  
 293      =1  
 294      =1  //#define OVERWRITE             0
 295      =1  //#define POPUP                 1
 296      =1  
 297      =1  //CursorMove
 298      =1  #define VERT                    0
 299      =1  #define HORI                    1
 300      =1  
 301      =1  //Type of MenuItem
 302      =1  #define OSDMENU                 1
 303      =1  #define CHOICEMENU              2
 304      =1  #define ACTION                  3
 305      =1  #define BAR                             4
 306      =1  #define NUMBER                  5
 307      =1  #define CHOICE                  6
 308      =1  #define ENUM_STRING             7 //YESNO                       7
 309      =1  #define CHOICE1                 8
 310      =1  #define TIME                    9
 311      =1  #define NUMBER_STRING   10
 312      =1  #define TEXT_STR              11   // V1.1 02/28/07 simonsung
 313      =1  
 314      =1  
 315      =1  //Bar type
 316      =1  #define LEFT_FILLED             1
 317      =1  #define RIGHT_FILLED    2
 318      =1  #define NO_FILLED               3
 319      =1  
 320      =1  //OSDmenu up and down key
 321      =1  #define UP                                      1
 322      =1  #define DN                                      2
 323      =1  #define RIGHT                           3
 324      =1  #define LEFT                            4
 325      =1  
 326      =1  // Action Id
 327      =1  #define DISP_INFO                       0x16
 328      =1  
 329      =1  #define INPUTSELECTION                          0x2f
 330      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 49  

 331      =1  #define CHANGE_TO_COMPOSITE                     (0x20|CH_TW2835)                        // Low nibble need to start from 1 
 332      =1  #define CHANGE_TO_SVIDEO                        (0x20|SVIDEO)                           // so that it match with COMPOSITE...
 333      =1  #define CHANGE_TO_COMPONENT                     (0x20|COMPONENT)                
 334      =1  #define CHANGE_TO_DTV                           (0x20|DTV)              
 335      =1  #define CHANGE_TO_TV                            (0x20|TV)                                       
 336      =1  #define CHANGE_TO_PC                            (0x20|PC)                                       
 337      =1  #define CHANGE_TO_DIGITALVGA            (0x20|DIGITALVGA)                       
 338      =1  #define CHANGE_TO_SCART                         (0x20|SCART)                            
 339      =1  
 340      =1  
 341      =1  #define OSDPOSITIONMODE     0x10
 342      =1  #define OSD_VPOS                        0x11
 343      =1  #define OSD_HPOS                        0x12
 344      =1  #define OSD_HALFTONE            0x13
 345      =1  #define OSD_DURATION            0x14
 346      =1  #define RESET_OSDVALUE          0x15
 347      =1  #define OSDLANG                         0x16
 348      =1  
 349      =1  #define PANEL_CONTRAST          0x58
 350      =1  #define PANEL_BRIGHTNESS        0x59
 351      =1  #define PANEL_HUE                       0x5a
 352      =1  #define PANEL_SHARPNESS         0x5b
 353      =1  #define PANEL_SATURATION        0x5c
 354      =1  
 355      =1  #define PC_VPOS                         0x43
 356      =1  #define PC_HPOS                         0x44
 357      =1  #define PC_HSIZE                        0x4d
 358      =1  
 359      =1  #define PC_CLOCK                        0x45
 360      =1  #define PC_PHASE                        0x46
 361      =1  
 362      =1  #define AUTOADJUST                      0x47
 363      =1  #define AUTOADJUST2                     0x48
 364      =1  //#define SAVE_AUTOADJUST               0x49
 365      =1  #define RESET_AUTOADJUST        0x4a
 366      =1  
 367      =1  #define PCCOLORADJUST           0x4b
 368      =1  #define SAVE_COLORADJUST        0x4c
 369      =1  //#define RESET_COLORADJUST     0x4d
 370      =1  
 371      =1  #define RESET_PCVALUE           0x4e
 372      =1  #define CameraOSD                       0x4f
 373      =1  
 374      =1  #define PC_COLOR_MODE           0x3f
 375      =1  #define PC_COLOR_TEMP           0x30
 376      =1  #define PC_COLOR_MODE1          0x31
 377      =1  #define PC_COLOR_MODE2          0x32
 378      =1  #define PC_COLOR_MODE3          0x33
 379      =1  #define PC_COLOR_USER           0x34
 380      =1  #define PC_COLOR_R                      0x35
 381      =1  #define PC_COLOR_G                      0x36
 382      =1  #define PC_COLOR_B                      0x37
 383      =1  
 384      =1  #define VIDEO_MODE                      0x90
 385      =1  #define VIDEO_MODE1                     0x91
 386      =1  #define VIDEO_MODE2                     0x92
 387      =1  #define VIDEO_MODE3                     0x93
 388      =1  #define VIDEO_USER                      0x94
 389      =1  #define VIDEO_CONTRAST          0x95
 390      =1  #define VIDEO_BRIGHTNESS        0x96
 391      =1  #define VIDEO_SATURATION        0x97
 392      =1  #define VIDEO_HUE                       0x99
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 50  

 393      =1  #define VIDEO_SHARPNESS         0x9a
 394      =1  #define VIDEO_BACKLIGHT         0x9c            // add new value 
 395      =1  #define RESET_VIDEOVALUE        0x9b
 396      =1  #ifdef E_Wintek
           =1 #define RESET_USERVALUE 0x9d
           =1 #endif
 399      =1  #define VIDEOPICTURE            0x9f
 400      =1  
 401      =1  #define INPUTSTD                        0x6f
 402      =1  #define CHANGE_TO_AUTO          0x60
 403      =1  #define CHANGE_TO_NTSC          (0x60 | NTSC)
 404      =1  #define CHANGE_TO_PAL           (0x60 | PAL)
 405      =1  #define CHANGE_TO_SECAM         (0x60 | SECAM)
 406      =1  #define CHANGE_TO_NTSC4         (0x60 | NTSC4)
 407      =1  #define CHANGE_TO_PALM          (0x60 | PALM)
 408      =1  #define CHANGE_TO_PALN          (0x60 | PALN)
 409      =1  #define CHANGE_TO_PAL60         (0x60 | PAL60)
 410      =1  
 411      =1  
 412      =1  
 413      =1  
 414      =1  #define CLOSED_CAPTION          0x7f
 415      =1  #define CLOSEDCAP_OFF           0x70
 416      =1  #define CLOSEDCAP_CC1           0x71
 417      =1  #define CLOSEDCAP_CC2           0x72
 418      =1  #define CLOSEDCAP_CC3           0x73
 419      =1  #define CLOSEDCAP_CC4           0x74
 420      =1  #define CLOSEDCAP_T1            0x75
 421      =1  #define CLOSEDCAP_T2            0x76
 422      =1  #define CLOSEDCAP_T3            0x77
 423      =1  #define CLOSEDCAP_T4            0x78
 424      =1  
 425      =1  #define TV_GUIDE                        0x8f
 426      =1  #define NO_VCHIP_LOCK           0
 427      =1  #define VCHIP_TV_Y                      1
 428      =1  #define VCHIP_TV_Y7                     2
 429      =1  #define VCHIP_TV_G                      3
 430      =1  #define VCHIP_TV_PG                     4
 431      =1  #define VCHIP_TV_14                     5
 432      =1  #define VCHIP_TV_MA                     6
 433      =1  #define PASSWORD                        0x87
 434      =1  #define NEW_PASSWORD            0x88
 435      =1  #define CHK_PASSWORD            0x89
 436      =1  #define RET_CHK_PASSWORD        0x8a
 437      =1  
 438      =1  #define MPAA_RATING                     0x9f
 439      =1  #define NO_MPAA_RATING          0
 440      =1  #define MPAA_G                          1
 441      =1  #define MPAA_PG                         2
 442      =1  #define MPAA_PG_13                      3
 443      =1  #define MPAA_R                          4
 444      =1  #define MPAA_NC_17                      5
 445      =1  #define MPAA_X                          6
 446      =1  
 447      =1  #define TVINSTALL                       0xa0
 448      =1  #define SCAN_CHANNEL            0xa1
 449      =1  #define AIR_CABLE_TV            0xa3
 450      =1  #define STORE_CLEAR_TVCHN       0xa4
 451      =1  #define MTS                                     0xa5
 452      =1  #define EDIT_CHANNEL            0xa6
 453      =1          #define         MTS_STEREO                      0//0x10
 454      =1          #define         MTS_MONO                        1//0x11
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 51  

 455      =1  
 456      =1  #define AUDIO_VOLUME            0xb7
 457      =1  
 458      =1  #if 0 //andy AWT8.4 20090811
           =1 
           =1 #define AUDIO_BALANCE           0xb9
           =1 #define AUDIO_BASS                      0xba
           =1 #define AUDIO_TREBLE            0xbb
           =1 
           =1 #define AUDIO_LOUDNESS          0xbc
           =1 #define AUDIO_EFFECT            0xbd
           =1 #define AUDIO_MUTE                      0xbe
           =1 #endif
 468      =1  
 469      =1  #define DayChoice           0xb8
 470      =1  #define CAMOSDONOFF         0xb9
 471      =1  #define GAUGEChoice         0xba
 472      =1  #define OsdLockChoice       0xbb
 473      =1  #define PRIORITYChoice      0xcA
 474      =1  #define DVRDisplay              0xcc
 475      =1  
 476      =1  #define CAMAONOFF                   0xc1
 477      =1  #define CAMBONOFF               0xc2
 478      =1  #define CAMCONOFF                   0xc3
 479      =1  #define CAMRONOFF                       0xc4
 480      =1  
 481      =1  #define IMAGEChoice         0xc5 
 482      =1  #define REARChoice          0xc6
 483      =1  #define JUMPChoice          0xc7
 484      =1  #define CAMOUTChoice        0xc8 
 485      =1  #define STIME_STEP                  0xc9
 486      =1  #define TriggerVGA                  0xcb
 487      =1  #define IMAGE_A_Choice         0xcd
 488      =1  #define IMAGE_B_Choice         0xce
 489      =1  #define IMAGE_C_Choice         0xcf
 490      =1  
 491      =1  
 492      =1  #define MANUAL_TUNE_CHANNEL     0xab
 493      =1  #define FINE_TUNE_CHANNEL       0xac
 494      =1  #define STORE_PALCHANNEL        0xad
 495      =1  
 496      =1  //#define CLEAR_TVCHN                   0xb0
 497      =1  //#define STORE_TVCHN                   0xb1
 498      =1  
 499      =1  #define WIDESCREEN                      0xc0
 500      =1  #define WIDESCREEN_NORMAL       0 
 501      =1  #define WIDESCREEN_WIDE         1 
 502      =1  #define WIDESCREEN_PANO         2
 503      =1  #define WIDESCREEN_FULL         3 
 504      =1  #define WIDESCREEN_ZOOM         4 
 505      =1  
 506      =1  #define SYSTEM_CLOCK            0xd1
 507      =1  #define SYSTEM_CLOCK_H          0xd2
 508      =1  #define WAKEUP_TIME                     0xd3
 509      =1  #define WAKEUP_TIME_H           0xd4
 510      =1  #define WAKEUP_PR                       0xd5
 511      =1  #define OFF_TIME                        0xd6
 512      =1  #define OFF_TIME_H                      0xd7
 513      =1  #define SLEEP_TIMER                     0xd8
 514      =1  
 515      =1  #define Resolution                      0xe0
 516      =1  #define FPS                                     0xe1
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 52  

 517      =1  #define Quality                         0xe2
 518      =1  #define RecordMode                      0xe3
 519      =1  #define RecordLength            0xe4
 520      =1  #define PreAlarmLength          0xe5
 521      =1  #define PostAlarmLength         0xe6
 522      =1  #define Apply                           0xe7
 523      =1  #define ManualRecordStart       0xe8
 524      =1  #define ManualRecordStop        0xe9
 525      =1  #define Snapshot                        0xea
 526      =1  #define FormatSD                        0xeb
 527      =1  #define AudioRecord                     0xec
 528      =1  #define FirmwareUpdate          0xed
 529      =1  #define ChangePassword          0xee
 530      =1  #define OverWrite                       0xef
 531      =1  
 532      =1  
 533      =1  
 534      =1  
 535      =1  #define Year                            0x20
 536      =1  #define Month                           0x21
 537      =1  #define Day                                     0x22
 538      =1  #define Hour                            0x23
 539      =1  #define Minute                          0x24
 540      =1  
 541      =1  #define DaylightSaving                          0x25
 542      =1  #define TimeBeginesMonth                        0x26
 543      =1  #define TimeBeginesWeek                         0x27
 544      =1  #define TimeBeginesTime                         0x28
 545      =1  #define StandardTimeBeginesMonth        0x29
 546      =1  #define StandardTimeBeginesWeek         0x2a
 547      =1  #define StandardTimeBeginesTime         0x2b
 548      =1  #define TimeZone                                        0x2c
 549      =1  #define FirstNumber                                     0x2d
 550      =1  #define SecondNumber                            0x2e
 551      =1  #define ThridNumber                                     0x2f
 552      =1  #define FourthNumber                            0x38
 553      =1  
 554      =1  
 555      =1  
 556      =1  #define OSDLANGI                        0xd9
 557      =1  #define OSDLANGII                       OSDLANGI+1
 558      =1  #define OSDLANGIII                      OSDLANGI+2
 559      =1  #define OSDLANGIV                       OSDLANGI+3
 560      =1  
 561      =1  
 562      =1  #define TOHIGHMENU                      0xf1
 563      =1  #define MOVECURSOR2FIRST        0xf2
 564      =1  #define RESET_ALL                       0xf3
 565      =1  #define EXITMENU                        0xf4
 566      =1  #define DVRParamApply           0xf5
 567      =1  #define DATETIMEApply           0xf6
 568      =1  
 569      =1  
 570      =1  #define CHOICE1_VAL                     0xfc
 571      =1  #define CHOICE_VAL                      0xfd
 572      =1  #define BAR_VAL                         0xfe
 573      =1  #define NUM_VAL                         0xff
 574      =1  
 575      =1  #define CAMNumberChoice     0xa3 
 576      =1  #define PelcoChoice         0xa4
 577      =1  #define Baud_rateChoice         0xa5
 578      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 53  

 579      =1  #endif  // __OSDMENU__
  28          #include "pc_eep.h"
   1      =1  #ifndef __PC_EEP__
   2      =1  #define __PC_EEP__
   3      =1  
   4      =1  
   5      =1  // -----------------------------------------------------------------------------
   6      =1  #define PC_COLOR_DATA   0x80    // StartAddress of EEPROM for PC Color Temperature
   7      =1  #define PC_USERCOLOR    0x8A
   8      =1  #define SetPCColorTempModeEE( ctid )                    WriteEEP( PC_COLOR_DATA, ctid )
   9      =1  #define GetPCColorTempModeEE()                                  ReadEEP( PC_COLOR_DATA )
  10      =1  
  11      =1  #define GetPCUserColorTempEE( ucolorr)                  ReadEEP( PC_USERCOLOR+ucolorr )
  12      =1  #define SavePCUserColorTempEE( ucolorw, uval)   WriteEEP( PC_USERCOLOR+ucolorw, uval )
  13      =1  #define GetPCColorEE(index)                                             ReadEEP(index)
  14      =1  
  15      =1  // -----------------------------------------------------------------------------
  16      =1  #define EE_ADC_GO               0x90    // ADC Gain Offset for PC
  17      =1  #define EE_ADC_GO_DTV   0x98    // ADC Gain Offset for DTV
  18      =1  
  19      =1  #define EE_PCDATA               0xC0    // StartAddress of EEPROM for PCDATA
  20      =1  #define LEN_PCDATA              5               // Length of PCDATA
  21      =1  
  22      =1  WORD GetHPNfromEE(BYTE mode);
  23      =1  
  24      =1  BYTE CheckPcDataEEValid(BYTE, WORD);
  25      =1  
  26      =1  WORD GetVactiveStartEE(BYTE mode);
  27      =1  WORD GetHactiveStartEE(BYTE mode);
  28      =1  
  29      =1  void GetPCDataEE(BYTE mode);
  30      =1  void SavePCDataEE(BYTE mode);
  31      =1  void SaveDefaultPCDataEE(void);
  32      =1  void SaveDefaultPCDataAllEE(void);
  33      =1  
  34      =1  void SaveHactiveEE(BYTE mode);
  35      =1  void SaveVactiveEE(BYTE mode);
  36      =1  void SaveVBackPorchEE(BYTE mode);
  37      =1  void SaveCoarseEE(BYTE mode);
  38      =1  void SavePhaseEE(BYTE mode);
  39      =1  /*
  40      =1  WORD GetHactiveStartEE(BYTE mode);
  41      =1  WORD GetVactiveStartEE(BYTE mode);
  42      =1  */
  43      =1  void DumpPCData(void);
  44      =1  
  45      =1  void SaveActiveVEE(WORD);
  46      =1  void SaveBackPorchEE(BYTE);
  47      =1  void SaveActiveHEE(WORD);
  48      =1  
  49      =1  void SaveADCGainOffsetEE(BYTE mod);
  50      =1  void GetADCGainOffsetEE(void);
  51      =1  
  52      =1  void SaveADCGainOffsetForDTVEE(BYTE mod);
  53      =1  void GetADCGainOffsetForDTVEE(void);
  54      =1  
  55      =1  #endif  // __PC_EEP__
  29          #include "KeyRemo.h"
   1      =1  //
   2      =1  // KeyRemo.h
   3      =1  // Default function for Key Input and Remocon Input
   4      =1  //
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 54  

   5      =1  //=============================================================================
   6      =1  //                                  Operation Key Mapping
   7      =1  //=============================================================================
   8      =1  
   9      =1  
  10      =1  
  11      =1  
  12      =1  #define ResetKey()              { P2 = 0xff;}
  13      =1  //#define ReadKey()             (~P1 & 0xfc);
  14      =1  
  15      =1  #define POWERKEY                0x04 //andy AWT 980907
  16      =1  #define MENUKEY                 0x08
  17      =1  #define INPUTSOURCEKEY  0x10
  18      =1  #define UPKEY               0x20
  19      =1  #define DOWNKEY             0x40
  20      =1  #define SELECTKEY           0x80
  21      =1  #define VersionKEY          0x90
  22      =1  
  23      =1  #define REMO_CUSTOM             0
  24      =1  
  25      =1  #define REMO_NUM0               0
  26      =1  #define REMO_NUM1               1
  27      =1  #define REMO_NUM2               2
  28      =1  #define REMO_NUM3               3
  29      =1  #define REMO_NUM4               4
  30      =1  #define REMO_NUM5               5
  31      =1  #define REMO_NUM6               6
  32      =1  #define REMO_NUM7               7
  33      =1  #define REMO_NUM8               8
  34      =1  #define REMO_NUM9               9
  35      =1  
  36      =1  #define REMO_STANDBY    12
  37      =1  #define REMO_CHNUP              32
  38      =1  #define REMO_CHNDN              33
  39      =1  #define REMO_VOLUP              16
  40      =1  #define REMO_VOLDN              17
  41      =1  #define REMO_SELECT             21
  42      =1  #define REMO_MENU               63
  43      =1  #define REMO_MUTE               13
  44      =1  #define REMO_INPUT              56
  45      =1  
  46      =1  #define REMO_AUTO               10
  47      =1  #define REMO_INFO               58
  48      =1  #define REMO_AUDIO              38
  49      =1  #define REMO_ASPECT             62
  50      =1  #define REMO_CC                 15
  51      =1  #define REMO_EXIT               0x16
  52      =1  
  53      =1  #define REMO_TTXRED                     0x37
  54      =1  #define REMO_TTXGREEN           0x36
  55      =1  #define REMO_TTXYELLOW          0x32
  56      =1  #define REMO_TTXCYAN            0x34
  57      =1  
  58      =1  
  59      =1  
  60      =1  //=============================================================================
  61      =1  //                                 RC5 type
  62      =1  //=============================================================================
  63      =1  #ifdef REMO_RC5
           =1 
           =1 #ifdef TECHWELL_REMOCON
           =1 #define REMO_CUSTOM             0
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 55  

           =1 
           =1 #define REMO_NUM0               0
           =1 #define REMO_NUM1               1
           =1 #define REMO_NUM2               2
           =1 #define REMO_NUM3               3
           =1 #define REMO_NUM4               4
           =1 #define REMO_NUM5               5
           =1 #define REMO_NUM6               6
           =1 #define REMO_NUM7               7
           =1 #define REMO_NUM8               8
           =1 #define REMO_NUM9               9
           =1 
           =1 #define REMO_STANDBY    12
           =1 #define REMO_CHNUP              32
           =1 #define REMO_CHNDN              33
           =1 #define REMO_VOLUP              16
           =1 #define REMO_VOLDN              17
           =1 #define REMO_SELECT             21
           =1 #define REMO_MENU               63
           =1 //#define REMO_TV                       63
           =1 //#define REMO_VCR              60
           =1 //#define REMO_SVIDEO           56
           =1 #define REMO_MUTE               13
           =1 #define REMO_INPUT              56
           =1 
           =1 #define REMO_AUTO               10
           =1 #define REMO_INFO               58
           =1 #define REMO_AUDIO              38
           =1 #define REMO_ASPECT             62
           =1 #define REMO_CC                 15
           =1 #define REMO_EXIT               0x16
           =1 
           =1 #define REMO_TTXRED                     0x37
           =1 #define REMO_TTXGREEN           0x36
           =1 #define REMO_TTXYELLOW          0x32
           =1 #define REMO_TTXCYAN            0x34
           =1 
           =1 #ifdef SUPPORT_DEBUG
           =1 #define REMO_DEBUG              0x2b
           =1 #define REMO_READ               0x29
           =1 #define REMO_WRITE              0x2a
           =1 #define REMO_RESERVED   0x30
           =1 #endif
           =1 
           =1 #else 
           =1 #define REMO_CUSTOM             0
           =1 
           =1 #define REMO_NUM0               0
           =1 #define REMO_NUM1               1
           =1 #define REMO_NUM2               2
           =1 #define REMO_NUM3               3
           =1 #define REMO_NUM4               4
           =1 #define REMO_NUM5               5
           =1 #define REMO_NUM6               6
           =1 #define REMO_NUM7               7
           =1 #define REMO_NUM8               8
           =1 #define REMO_NUM9               9
           =1 
           =1 #define REMO_STANDBY    12
           =1 #define REMO_CHNUP              32
           =1 #define REMO_CHNDN              33
           =1 #define REMO_VOLUP              16
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 56  

           =1 #define REMO_VOLDN              17
           =1 #define REMO_SELECT             18
           =1 #define REMO_MENU               48
           =1 #define REMO_TV                 63
           =1 #define REMO_VCR                60
           =1 #define REMO_SVIDEO             56
           =1 #define REMO_MUTE               13
           =1 #define REMO_INPUT              0xff
           =1 
           =1 #define REMO_INFO               0x0a //??
           =1 #endif
           =1 
           =1 //=============================================================================
           =1 //                                 NEC type
           =1 //=============================================================================
           =1 #elif defined REMO_NEC
           =1 /*
           =1 // Techwell Origin
           =1 #define REMO_CUSTOM1    0x20
           =1 #define REMO_CUSTOM2    0xdf
           =1 
           =1 
           =1 #define REMO_NUM0               0x08
           =1 #define REMO_NUM1               0x88
           =1 #define REMO_NUM2               0x48
           =1 #define REMO_NUM3               0xc8
           =1 #define REMO_NUM4               0x28
           =1 #define REMO_NUM5               0xa8
           =1 #define REMO_NUM6               0x68
           =1 #define REMO_NUM7               0xe8
           =1 #define REMO_NUM8               0x18
           =1 #define REMO_NUM9               0x98
           =1 
           =1 #define REMO_STANDBY    0x10
           =1 #define REMO_CHNUP              0x00
           =1 #define REMO_CHNDN              0x80
           =1 #define REMO_VOLUP              0x40
           =1 #define REMO_VOLDN              0xc0
           =1 #define REMO_SELECT             0x70
           =1 #define REMO_MENU               0x9c
           =1 #define REMO_MUTE               0x90
           =1 #define REMO_INPUT              0xd0
           =1 */
           =1 
           =1 // Techwell New Remocon after 4/7/2005
           =1 #ifdef PHILIPS_REMOCON
           =1 #define REMO_CUSTOM1    0x02
           =1 #define REMO_CUSTOM2    0xfd
           =1 
           =1 #define REMO_NUM0               0x00
           =1 #define REMO_NUM1               0x80
           =1 #define REMO_NUM2               0x40
           =1 #define REMO_NUM3               0xc0
           =1 #define REMO_NUM4               0x20
           =1 #define REMO_NUM5               0xa0
           =1 #define REMO_NUM6               0x60
           =1 #define REMO_NUM7               0xe0
           =1 #define REMO_NUM8               0x10
           =1 #define REMO_NUM9               0x90
           =1 
           =1 #define REMO_STANDBY    0x48
           =1 #define REMO_CHNUP              0xd8
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 57  

           =1 #define REMO_CHNDN              0xf8
           =1 #define REMO_VOLUP              0x58
           =1 #define REMO_VOLDN              0x78
           =1 #define REMO_SELECT             0xe8
           =1 #define REMO_MENU               0x01
           =1 #define REMO_MUTE               0x08
           =1 #define REMO_INPUT              0xf0
           =1 
           =1 #define REMO_INFO               0x38
           =1 
           =1 
           =1 
           =1 #define REMO_TTXRED                     0x4E
           =1 #define REMO_TTXGREEN           0x8E
           =1 #define REMO_TTXYELLOW          0xC6
           =1 #define REMO_TTXCYAN            0x86
           =1 
           =1 #else
           =1 // RYU For Test
           =1 #define REMO_CUSTOM1            0x04
           =1 #define REMO_CUSTOM2            0xfb
           =1 
           =1 #define REMO_NUM0               0xf8
           =1 #define REMO_NUM1               0x48
           =1 #define REMO_NUM2               0xc8
           =1 #define REMO_NUM3               0x28
           =1 #define REMO_NUM4               0xa8
           =1 #define REMO_NUM5               0x18
           =1 #define REMO_NUM6               0x98
           =1 #define REMO_NUM7               0x58
           =1 #define REMO_NUM8               0xd8
           =1 #define REMO_NUM9               0x78
           =1 
           =1 #define REMO_STANDBY    0x00
           =1 #define REMO_CHNUP              0x40    //
           =1 #define REMO_CHNDN              0x70    //
           =1 #define REMO_VOLUP              0x90    //
           =1 #define REMO_VOLDN              0xe0    //
           =1 #define REMO_SELECT             0x11//??
           =1 #define REMO_MENU               0x10
           =1 
           =1 #define REMO_MUTE               0x60
           =1 #define REMO_INPUT              0xc0
           =1 #define REMO_AUTO               0x30
           =1 #define REMO_AUTOSCAN   0x80
           =1 #define REMO_TV                 0x20
           =1 #define REMO_EXIT               0xa0
           =1 #define REMO_INFO               0x08
           =1 #define REMO_ASPECT             0x62
           =1 
           =1 #define REMO_TTXRED             0xb8
           =1 #define REMO_TTXGREEN   0x02
           =1 #define REMO_TTXYELLOW  0x82
           =1 #define REMO_TTXCYAN    0x42
           =1 
           =1 #ifdef SUPPORT_DEBUG
           =1 #define REMO_DEBUG              0xb8
           =1 #define REMO_READ               0x02
           =1 #define REMO_WRITE              0x82
           =1 #endif
           =1 
           =1 #endif //PHILIPS_REMOCON
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 58  

           =1 
           =1 #endif // REMO_NEC
 255      =1  
 256      =1  
 257      =1  
 258      =1  BYTE ActionRemo(BYTE, BYTE);
 259      =1  BYTE CheckKeyIn(void);
 260      =1  BYTE GetKey(BYTE repeat);
 261      =1  BYTE IsRemoDataReady(BYTE *, BYTE *);
 262      =1  
 263      =1  
  30          #include "Monitor.h"
   1      =1  /* monitor.h */
   2      =1  
   3      =1  
   4      =1  void Mon_tx(BYTE ch);
   5      =1  
   6      =1  void MonHelp(void);
   7      =1  BYTE MonGetCommand(void);
   8      =1  void Monitor(void);
   9      =1  void Prompt(void);
  10      =1  
  11      =1  BYTE GetMonAddress(void);
  12      =1  void SetMonAddress(BYTE addr);
  13      =1  void MonReadI2C(void);
  14      =1  void MonWriteI2C(void);
  15      =1  
  31          #include "CPU.h"
   1      =1  #ifndef __CPU__
   2      =1  #define __CPU__
   3      =1  
   4      =1  /*
   5      =1  #ifdef INTERNAL_MCU
   6      =1  #define I2C_SCL         P2_0
   7      =1  #else
   8      =1  #define I2C_SCL         P1_0
   9      =1  #endif
  10      =1  #define I2C_SDA         P1_1
  11      =1  */
  12      =1  #define I2C_SCL         P1_0
  13      =1  #define I2C_SDA         P1_1
  14      =1  #define BUF_MAX         8
  15      =1  #define DVR_BUF_MAX     30
  16      =1  
  17      =1  #ifdef REMO_RC5
           =1 #define EnableRemoconInt()      { RemoDataReady = 0;    EX0 = 1;}
           =1 #endif
  20      =1  void    InitCPU(void);
  21      =1  void    InitVars(void);
  22      =1  void    InitTechwell(void);
  23      =1  void    main_init (void);
  24      =1  void    PowerDown( void );
  25      =1  #if 0
           =1 BYTE    OKSleepTime(void);
           =1 #endif
  28      =1  #ifdef REMO_RC5
           =1 void    InitForRemo(void);
           =1 #endif
  31      =1  void    PowerLED(BYTE flag);
  32      =1  void    Wait_ms(WORD Tms);
  33      =1  BYTE    TW2835Command(char,char,char,char,char);
  34      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 59  

  35      =1  #endif
  32          #include "HS_keyremo.h"
   1      =1  #ifndef _HS_keyremo_
   2      =1  #define _HS_keyremo_
   3      =1  
   4      =1  //
   5      =1  // KeyRemo.h
   6      =1  // Default function for Key Input and Remocon Input
   7      =1  //
   8      =1  //=============================================================================
   9      =1  //                                  Operation Key Mapping
  10      =1  //=============================================================================
  11      =1  
  12      =1  
  13      =1  
  14      =1  #define  SelectMode 0
  15      =1  #define  JumpMode       1
  16      =1  
  17      =1  
  18      =1  
  19      =1  
  20      =1  extern BYTE NowModeState;
  21      =1  extern BYTE TriggerFlag;
  22      =1  extern bit      ParkFlag;
  23      =1  extern BYTE  Attr_A,Attr_B,Attr_C,Attr_R; 
  24      =1  extern BYTE TimeStep;
  25      =1  extern BYTE SEQFlag;
  26      =1  extern BYTE SEQIndex;
  27      =1  extern BYTE TriggerMode;
  28      =1  extern bit AVFlag;
  29      =1  extern bit VGAAudio;
  30      =1  
  31      =1  
  32      =1  
  33      =1  //BYTE TW2835Command(char,char,char,char,char);
  34      =1  void SetSourceMode(BYTE Index,char ,char ,char ,char );
  35      =1  void SetSelectMode(void);
  36      =1  //void PriorityOffSelectMode(void);
  37      =1  void SetJumpMode(void);
  38      =1  void SetNowMode(void);
  39      =1  void SetRearSource(void);
  40      =1  void SetLeftSource(void);
  41      =1  void SetRightSource(void);
  42      =1  
  43      =1  
  44      =1  BYTE CheckTrigger(void);
  45      =1  void TriggerHandler(BYTE T_Flag);
  46      =1  void SEQMode(void);
  47      =1  
  48      =1  
  49      =1  
  50      =1  
  51      =1  #endif
  33          #include "HS_DisplayOSD.h"
   1      =1  #ifndef _HS_DisplayOSD_
   2      =1  #define _HS_DisplayOSD_
   3      =1  
   4      =1  
   5      =1  
   6      =1  
   7      =1  
   8      =1  #define         NORMAL_Record   0x01
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 60  

   9      =1  #define         Manual_Record   0x02
  10      =1  #define         ALARM_Record    0x04
  11      =1  #define         OverWrite_Record        0x80
  12      =1  
  13      =1  void DisplayGaugeOSD(void);
  14      =1  void ClearGAUGEINFO(void);
  15      =1  void DisplaylockOSD(void); 
  16      =1  void DisplayactvOSD(void); 
  17      =1  
  18      =1  
  19      =1  void DisplayNumber(BYTE addr,WORD val,BYTE type);
  20      =1  
  21      =1  //#ifdef SUPPORT_SDCARD
  22      =1  void DisplayDVRStatus(void);
  23      =1  void DisplayFormatOSD(void);
  24      =1  void DisplayFormatOkOSD(void);
  25      =1  void DisplayFormatFailOSD(void);
  26      =1  void DisplayFWUpDate(void);
  27      =1  void DisplayFWUpDateOK(void);
  28      =1  void DisplayFWUpDateFail(void);
  29      =1  void DisplayFWVersion(void) ;
  30      =1  void DisplayDVRnotReady(void);
  31      =1  //#endif                //#ifdef SUPPORT_SDCARD
  32      =1  #endif
  34          #include "rgbmix.h"                     
   1      =1  #ifndef __RGBMIX__
   2      =1  #define __RGBMIX__
   3      =1  
   4      =1  #include "RegMap.h"
   1      =2  #ifndef __REGMAP__
   2      =2  #define __REGMAP__
   3      =2  
   4      =2  //-----------------------------------------------------------------------------
   5      =2  //                              Individual Decoder Registers 
   6      =2  //-----------------------------------------------------------------------------
   7      =2  
   8      =2  #define MCU_STOP_MODE   0xc8    // bit 7 is mcu stop, bit5 is MCU debug
   9      =2  
  10      =2  #define LAD0                    0xc9    // Low speed AD channel 0
  11      =2  #define LAD1                    0xca    // Low speed AD channel 1
  12      =2  
  13      =2  #define REG_PAGE                0xff
  14      =2  #define STATUS0                 0xd0
  15      =2  #define STATUS1                 0xd1
  16      =2  #define IRQ_EN1                 0xd2
  17      =2  #define IRQ_EN0                 0xd3
  18      =2  
  19      =2  //-----------------------------------------------------------------------------
  20      =2  //                              Individual Decoder Registers 
  21      =2  //-----------------------------------------------------------------------------
  22      =2  
  23      =2  #define DECODERADDRESS  TW88I2CAddress
  24      =2  
  25      =2  #define CVFMT                   0x1e    // Component Video Format
  26      =2  #define FBSHIFT                 0x38    // RGB Anti-Alias Filter/FB Shift Level
  27      =2  #define SHUE                    0x3e    // RGB Hue
  28      =2  #define SCONTRAST               0x3b    // RGB Contrast
  29      =2  #define SBRIGHT                 0x3a    // RGB Brightness
  30      =2  #define SCbGAIN                 0x3c    // RGB Cb Gain
  31      =2  #define SCrGAIN                 0x3d    // RGB Cb Gain
  32      =2  #define RGBCONTROL              0x36    // RGB Powerdown..
  33      =2  #define RGBMISC                 0x39
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 61  

  34      =2  #define FBCONTRL                0x3F
  35      =2  
  36      =2  //#define OSD_ADJ                       0xce
  37      =2  #define PNLSHARPNESS    0x78    // Sharpness Control
  38      =2  #define OSDWINSTATUS    0x95
  39      =2  //-----------------------------------------------------------------------------
  40      =2  //                              Common Registers
  41      =2  //-----------------------------------------------------------------------------
  42      =2  #define CSTATUS                 0x01    // Chip Status
  43      =2  #define INFORM                  0x02    // Input Format
  44      =2  #define ACNTL                   0x06    // Analog Control
  45      =2  #define CROP_HI                 0x07    // Cropping High
  46      =2  #define VDELAY_LO               0x08    // Vertical Delay Low
  47      =2  #define VACTIVE_LO              0x09    // Vertical Active Low
  48      =2  #define HDELAY_LO               0x0a    // Horizontal Delay Low
  49      =2  #define HACTIVE_LO              0x0b    // Horizontal Active Low
  50      =2  #define CNTRL1                  0x0c    // Control 1
  51      =2  
  52      =2  #define BRIGHT                  0x10    // Brightness Control
  53      =2  #define CONTRAST                0x11    // Contrast Control
  54      =2  #define SHARPNESS               0x12    // Sharpness Control
  55      =2  #define SAT_U                   0x13    // Chroma(U) Gain
  56      =2  #define SAT_V                   0x14    // Chroma(V) Gain
  57      =2  #define HUE                             0x15    // Hue Conrol
  58      =2  #define V_PEAKING               0x17    // Vertical Peaking
  59      =2  
  60      =2  #define CC_STATUS               0x1a    // CC/EDS Status
  61      =2  #define CC_DATA                 0x1b    // CC/EDS Data
  62      =2  #define SDT                             0x1c    // Standard Selection
  63      =2  #define SDTR                    0x1d    // Standard Recognition
  64      =2  
  65      =2  #define V_CONTROL2              0x29    // Vertical Control II
  66      =2  #define HFILTER                 0x2c
  67      =2  #define MISC1                   0x2d    // Miscellaneous Control 1
  68      =2  #define MISC2                   0x2e    // Miscellaneous Control 2
  69      =2  #define MISC3                   0x2f    // Miscellaneous Control 2
  70      =2  
  71      =2  #define VBI_CNTL2               0x34    // VBI control 2 - WSSEN
  72      =2  #define CC_ODDLINE              0x35    // CC Odd Line
  73      =2  
  74      =2  #define LADC0                   0xc9    //LADC Channel 0 Input Value 
  75      =2  #define LADC1                   0xca    //LADC Channel 1 Input Value 
  76      =2  
  77      =2  #define WriteDecoder(index, val)                WriteTW88( index, val )
  78      =2  #define ReadDecoder(index)                              ReadTW88(  index )
  79      =2  #endif // __REGMAP__
   5      =1  
   6      =1  //#define       SetDigitalVideoContrastReg(vcval)                               WriteTW88(0x3b, vcval)
   7      =1  //#define       SetDigitalVideoBrightnessReg(vbval)                             WriteTW88(0x3c, vbval )
   8      =1  //#define       SetDigitalVideoHueReg(vhval)                                    WriteTW88(0x32, vhval )
   9      =1  //#define       SetDigitalVideoSaturationReg(gain, vhval)               WriteTW88(0x3d+gain, (ReadTW88(0x3d+gain)&0x80) + vhv
             -al )
  10      =1  #define SetDigitalVideoContrastReg(vcval)                               WriteI2C(DECODERADDRESS, SCONTRAST, vcval)
  11      =1  #define SetDigitalVideoBrightnessReg(vbval)                             WriteI2C(DECODERADDRESS, SBRIGHT,       vbval )
  12      =1  #define SetDigitalVideoHueReg(vhval)                                    WriteI2C(DECODERADDRESS, SHUE,  vhval )
  13      =1  #define SetDigitalVideoSaturationReg(gain, vhval)               WriteI2C(DECODERADDRESS, SCbGAIN+gain, (ReadI2C(DECODER
             -ADDRESS, SCbGAIN+gain)&0x80) + vhval )
  14      =1  
  15      =1  #endif // __RGBMIX__
  35          #include "panel.h"
   1      =1  //PanelConfig
   2      =1  
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 62  

   3      =1          #if   defined SXGA
           =1                                                 #define PHR_ 1280
           =1                                                 #define PVR_ 1024
           =1         #elif defined XGA       
           =1                                                 #define PHR_ 1024
           =1                                                 #define PVR_ 768
           =1         #elif defined SVGA
           =1                                                 #define PHR_ 800
           =1                                                 #define PVR_ 600
           =1         #elif defined VGA
           =1                                                 #define PHR_ 640
           =1                                                 #define PVR_ 480
           =1         #elif defined QVGA
           =1                                                 #define PHR_ 320
           =1                                                 #define PVR_ 240
           =1         #elif defined WXGA
           =1                                                 #define PHR_ 1280 //1366
           =1                                                 #define PVR_ 768
           =1         #elif defined WSVGA
           =1                                                 #define PHR_ 1024
           =1                                                 #define PVR_ 600
           =1         #elif defined WVGA
  25      =1                                                  #define PHR_ 800
  26      =1                                                  #define PVR_ 600
  27      =1          #elif defined WQVGA
           =1                                 //              #define PHR_ 960 //480
           =1                                 //              #define PVR_ 237
           =1                                                 #define PHR_ 480 //480
           =1                                                 #define PVR_ 240
           =1         #endif
  33      =1  
  34      =1   
  35      =1  
  36      =1  /*
  37      =1  #define ACTIVE_LOW                      0
  38      =1  #define ACTIVE_HIGH                     1
  39      =1  
  40      =1  CODE struct PanelConfig {
  41      =1          unsigned                x_res,                                  y_res;
  42      =1          unsigned char   h_sync_min_pulse_width, v_sync_min_pulse_width;
  43      =1          unsigned                h_min_back_porch;
  44      =1          unsigned char   h_sync_polarity,                v_sync_polarity;
  45      =1          unsigned                dot_clock,                              max_clock;                      // in unit Mhz*10
  46      =1          unsigned char   pixs_per_clock;
  47      =1          unsigned char   DE_only;
  48      =1  } PanelConfig=
  49      =1          {
  50      =1          //----------------------------------------------------
  51      =1          #ifdef WXGA
  52      =1          //LG  LM171W01 WXGA
  53      =1          1280,                   768,
  54      =1          8,                              1,
  55      =1          8,
  56      =1          ACTIVE_LOW,             ACTIVE_LOW,
  57      =1          #ifdef DOUBLE_PIXEL
  58      =1          320,                    470,
  59      =1          2,
  60      =1          #else
  61      =1          650,                    950,                                    //65Mhz
  62      =1          1,
  63      =1          #endif
  64      =1          0
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 63  

  65      =1          //----------------------------------------------------
  66      =1          #elif defined XGA
  67      =1          //Samsung  LT150x1-151 XGA
  68      =1          1024,                   768,
  69      =1          68,                             1,
  70      =1          80,
  71      =1          ACTIVE_LOW,             ACTIVE_LOW,
  72      =1          #ifdef DOUBLE_PIXEL
  73      =1          325,                    400,                                    //32.5Mhz
  74      =1          2,
  75      =1          #else
  76      =1          650,                    800,
  77      =1          1,
  78      =1          #endif
  79      =1          0
  80      =1          //----------------------------------------------------
  81      =1          #elif defined SXGA
  82      =1          //Samsung  LT170E2-131  SXGA
  83      =1          1280,                   1024,
  84      =1          1,                              1,
  85      =1          1,
  86      =1          ACTIVE_LOW,             ACTIVE_LOW,
  87      =1          #ifdef DOUBLE_PIXEL
  88      =1          540,                    540,                                    //54.5Mhz
  89      =1          2,
  90      =1          #else
  91      =1          1080,                   1080,
  92      =1          1,
  93      =1          #endif
  94      =1          0
  95      =1          //----------------------------------------------------
  96      =1          #elif defined WSVGA                                             // Thosiba
  97      =1          1024,                   600,
  98      =1          8,                              3,
  99      =1          1,//80,                         
 100      =1          ACTIVE_LOW,             ACTIVE_LOW,
 101      =1          #ifdef DOUBLE_PIXEL
 102      =1          325,                    450,
 103      =1          2,
 104      =1          #else
 105      =1          500,                    550,                                    //50Mhz
 106      =1          1,
 107      =1          #endif
 108      =1          0
 109      =1          //----------------------------------------------------
 110      =1  
 111      =1          #elif defined SVGA
 112      =1          //NEC NL8060AC26-11 SVGA
 113      =1          800,                    600,
 114      =1          2,                              1,
 115      =1          13,
 116      =1          ACTIVE_LOW,             ACTIVE_LOW,
 117      =1          #ifdef DOUBLE_PIXEL
 118      =1          384,                    500,                                    //38.4MHz
 119      =1          2,
 120      =1          #else
 121      =1          670,                    1000,
 122      =1          1,
 123      =1          #endif
 124      =1          0
 125      =1          //----------------------------------------------------
 126      =1          #elif defined VGA
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 64  

 127      =1          //NEC NL6448AC33        VGA                                     // OK with SetPanelRegisters
 128      =1          640,                    480,
 129      =1          10,                             1,
 130      =1          4,
 131      =1          ACTIVE_LOW,             ACTIVE_LOW,
 132      =1          #ifdef DOUBLE_PIXEL
 133      =1          130,                    150,                                    //25.2MHz
 134      =1          2,
 135      =1          #else
 136      =1          250,                    300,
 137      =1          1,
 138      =1          #endif
 139      =1          0
 140      =1          //----------------------------------------------------
 141      =1  
 142      =1          #elif defined WVGA
 143      =1          // Panasonic  EDTCB27QBF WVGA
 144      =1          800,                    480,
 145      =1          4,                              1,
 146      =1          7,
 147      =1          ACTIVE_LOW,             ACTIVE_LOW,
 148      =1          #ifdef DOUBLE_PIXEL
 149      =1          166,                    200,                                    //33.2MHz
 150      =1          2,
 151      =1          #else
 152      =1          332,                    360,                                    //33.2MHz
 153      =1          1,
 154      =1          #endif
 155      =1          0
 156      =1  
 157      =1          //----------------------------------------------------
 158      =1          #else
 159      =1          // Default : XGA panel
 160      =1          // Samsung  LT150x1-151 XGA
 161      =1          1024,                   768,
 162      =1          68,                             1,
 163      =1          80,
 164      =1          ACTIVE_LOW,             ACTIVE_LOW,
 165      =1          #ifdef DOUBLE_PIXEL
 166      =1          325,                    400,                                    //32.5Mhz
 167      =1          2,
 168      =1          #else
 169      =1          650,                    800,                                    //32.5Mhz
 170      =1          1,
 171      =1          #endif
 172      =1          0
 173      =1          #endif
 174      =1          };
 175      =1  
 176      =1  */
  36          #include "HS_IOdef.h"
   1      =1  #ifndef _HS_IOdef_
   2      =1  #define _HS_IOdef_
   3      =1  
   4      =1  
   5      =1  
   6      =1  #include "Reg.h"
   1      =2  //
   2      =2  //Registers.h   : Register declaration
   3      =2  //
   4      =2  
   5      =2  #ifndef __REGISTERS__
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 65  

           =2 #define __REGISTERS__
           =2 
           =2 #ifdef INTERNAL_MCU
           =2 /*  BYTE Registers  */
           =2 sfr P0    = 0x80;
           =2 sfr P1    = 0x90;
           =2 sfr P2    = 0xA0;
           =2 sfr P3    = 0xB0;
           =2 sfr PSW   = 0xD0;
           =2 sfr ACC   = 0xE0;
           =2 sfr B     = 0xF0;
           =2 sfr SP    = 0x81;
           =2 sfr DPL   = 0x82;
           =2 sfr DPH   = 0x83;
           =2 sfr PCON  = 0x87;
           =2 sfr TCON  = 0x88;
           =2 sfr TMOD  = 0x89;
           =2 sfr TL0   = 0x8A;
           =2 sfr TL1   = 0x8B;
           =2 sfr TH0   = 0x8C;
           =2 sfr TH1   = 0x8D;
           =2 sfr IE    = 0xA8;
           =2 sfr IP    = 0xB8;
           =2 sfr SCON  = 0x98;
           =2 sfr SBUF  = 0x99;
           =2 
           =2 //sfr P4    = 0xd8;
           =2 
           =2 /*  8052 Extensions  */
           =2 sfr EXIF  = 0x91;               // external interrupt 2,3,4,5 flags should be cleared by software
           =2 sfr T2CON = 0xC8;
           =2 sfr RCAP2L = 0xCA;
           =2 sfr RCAP2H = 0xCB;
           =2 sfr TL2   = 0xCC;
           =2 sfr TH2   = 0xCD;
           =2 sfr EICON = 0xD8;
           =2 sfr EIE   = 0xE8;
           =2 sfr EIP   = 0xF8;
           =2 
           =2 /*      TW88 Core Extension */
           =2 sfr     BANKREG         = 0x9A;
           =2 sfr     SPICONTROL      = 0x9B;
           =2 sfr     T0HIGH          = 0x9C;
           =2 sfr     T0LOW           = 0x9D;
           =2 sfr     T1HIGH          = 0x9E;
           =2 sfr     T1LOW           = 0x9F;
           =2 sfr     T2HIGH          = 0x93;
           =2 sfr     T2LOW           = 0x94;
           =2 
           =2 /*  BIT Registers  */
           =2 /*  PSW  */
           =2 sbit CY    = 0xD7;
           =2 sbit AC    = 0xD6;
           =2 sbit F0    = 0xD5;
           =2 sbit RS1   = 0xD4;
           =2 sbit RS0   = 0xD3;
           =2 sbit OV    = 0xD2;
           =2 sbit P     = 0xD0;
           =2 
           =2 /*  TCON  */
           =2 sbit TF1   = 0x8F;
           =2 sbit TR1   = 0x8E;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 66  

           =2 sbit TF0   = 0x8D;
           =2 sbit TR0   = 0x8C;
           =2 sbit IE1   = 0x8B;
           =2 sbit IT1   = 0x8A;
           =2 sbit IE0   = 0x89;
           =2 sbit IT0   = 0x88;
           =2 
           =2 /*  IE  */
           =2 sbit EA    = 0xAF;
           =2 sbit ES    = 0xAC;
           =2 sbit ET1   = 0xAB;
           =2 sbit EX1   = 0xAA;
           =2 sbit ET0   = 0xA9;
           =2 sbit EX0   = 0xA8;
           =2 
           =2 /*  EIE  */
           =2 sbit EWDI  = 0xEC;              // Watch dog timer interrupt enable
           =2 sbit EX5   = 0xEB;              // external interrupt 5 enable
           =2 sbit EX4   = 0xEA;              // external interrupt 4 enable
           =2 sbit EX3   = 0xE9;              // external interrupt 3 enable
           =2 sbit EX2   = 0xE8;              // external interrupt 2 enable
           =2 
           =2 /*  IP  */
           =2 sbit PS    = 0xBC;
           =2 sbit PT1   = 0xBB;
           =2 sbit PX1   = 0xBA;
           =2 sbit PT0   = 0xB9;
           =2 sbit PX0   = 0xB8;
           =2 
           =2 /*  EIP  */
           =2 sbit PWDI  = 0xFC;              // Watch dog timer interrupt priority
           =2 sbit PX5   = 0xFB;              // external interrupt5 priority
           =2 sbit PX4   = 0xFA;              // external interrupt4 priority
           =2 sbit PX3   = 0xF9;              // external interrupt3 priority
           =2 sbit PX2   = 0xF8;              // external interrupt2 priority
           =2 
           =2 /*  P3  */
           =2 sbit RD    = 0xB7;
           =2 sbit WR    = 0xB6;
           =2 sbit T1    = 0xB5;
           =2 sbit T0    = 0xB4;
           =2 sbit INT1  = 0xB3;
           =2 sbit INT0  = 0xB2;
           =2 sbit TXD   = 0xB1;
           =2 sbit RXD   = 0xB0;
           =2 
           =2 /*  SCON  */
           =2 sbit SM0   = 0x9F;
           =2 sbit SM1   = 0x9E;
           =2 sbit SM2   = 0x9D;
           =2 sbit REN   = 0x9C;
           =2 sbit TB8   = 0x9B;
           =2 sbit RB8   = 0x9A;
           =2 sbit TI    = 0x99;
           =2 sbit RI    = 0x98;
           =2 
           =2 /*  8052 Extensions  */
           =2 /*  IE  */
           =2 sbit ET2   = 0xAD;
           =2 
           =2 /*  IP  */
           =2 sbit PT2   = 0xBD;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 67  

           =2 
           =2 /*  P1  */
           =2 sbit T2EX  = 0x91;
           =2 sbit T2    = 0x90;
           =2              
           =2 /*  T2CON  */
           =2 sbit TF2   = 0xCF;
           =2 sbit EXF2  = 0xCE;
           =2 sbit RCLK  = 0xCD;
           =2 sbit TCLK  = 0xCC;
           =2 sbit EXEN2 = 0xCB;
           =2 sbit TR2   = 0xCA;
           =2 sbit C_T2  = 0xC9;
           =2 sbit CP_RL2= 0xC8;
           =2 
           =2 sfr     CHPENR = 0xF6;
           =2 sfr     CHPCON = 0xBF;
           =2 sfr     SFRAL  = 0xC4;
           =2 sfr     SFRAH  = 0xC5;
           =2 sfr     SFRFD  = 0xC6;
           =2 sfr     SFRCN  = 0xC7;
           =2 
           =2 sbit P0_0  = 0x80;
           =2 sbit P0_1  = 0x81;
           =2 sbit P0_2  = 0x82;
           =2 sbit P0_3  = 0x83;
           =2 sbit P0_4  = 0x84;
           =2 sbit P0_5  = 0x85;
           =2 sbit P0_6  = 0x86;
           =2 sbit P0_7  = 0x87;
           =2 
           =2 sbit P1_0  = 0x90;
           =2 sbit P1_1  = 0x91;
           =2 sbit P1_2  = 0x92;
           =2 sbit P1_3  = 0x93;
           =2 sbit P1_4  = 0x94;
           =2 sbit P1_5  = 0x95;
           =2 sbit P1_6  = 0x96;
           =2 sbit P1_7  = 0x97;
           =2 
           =2 sbit P2_0  = 0xa0;
           =2 sbit P2_1  = 0xa1;
           =2 sbit P2_2  = 0xa2;
           =2 sbit P2_3  = 0xa3;
           =2 sbit P2_4  = 0xa4;
           =2 sbit P2_5  = 0xa5;
           =2 sbit P2_6  = 0xa6;
           =2 sbit P2_7  = 0xa7;
           =2 
           =2 sbit P3_0  = 0xb0;
           =2 sbit P3_1  = 0xb1;
           =2 sbit P3_2  = 0xb2;
           =2 sbit P3_3  = 0xb3;
           =2 sbit P3_4  = 0xb4;
           =2 sbit P3_5  = 0xb5;
           =2 sbit P3_6  = 0xb6;
           =2 sbit P3_7  = 0xb7;
           =2 
           =2 #else   // external MCU=WINBOND
           =2 /*  BYTE Registers  */
           =2 sfr P0    = 0x80;
           =2 sfr P1    = 0x90;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 68  

           =2 sfr P2    = 0xA0;
           =2 sfr P3    = 0xB0;
           =2 sfr PSW   = 0xD0;
           =2 sfr ACC   = 0xE0;
           =2 sfr B     = 0xF0;
           =2 sfr SP    = 0x81;
           =2 sfr DPL   = 0x82;
           =2 sfr DPH   = 0x83;
           =2 sfr PCON  = 0x87;
           =2 sfr TCON  = 0x88;
           =2 sfr TMOD  = 0x89;
           =2 sfr TL0   = 0x8A;
           =2 sfr TL1   = 0x8B;
           =2 sfr TH0   = 0x8C;
           =2 sfr TH1   = 0x8D;
           =2 sfr CKCON = 0x8E;               //clock control register, default =0x01
           =2 sfr IE    = 0xA8;
           =2 sfr IP    = 0xB8;
           =2 sfr SCON  = 0x98;
           =2 sfr SBUF  = 0x99;
           =2 sfr P4 = 0xE8; //Megawin Ryan@970716
           =2 //sfr P4    = 0xa5;      //SST MCU
           =2 //sfr P4    = 0xd8;             //winbond<960820>
           =2 
           =2 
           =2 /*  8052 Extensions  */
           =2 sfr T2CON = 0xC8;
           =2 sfr RCAP2L = 0xCA;
           =2 sfr RCAP2H = 0xCB;
           =2 sfr TL2   = 0xCC;
           =2 sfr TH2   = 0xCD;
           =2 
           =2 // for UART2
           =2 sfr S2CON  = 0xAA;
           =2 sfr S2BRT  = 0xBA;
           =2 sfr S2BUF  = 0x9A;
           =2 sfr AUXR2  = 0xA6;
           =2 sfr AUXIE  = 0xAD;
           =2 
           =2 
           =2 sfr P1M0  = 0x91;
           =2 sfr P1M1  = 0x92;
           =2 sfr P0M0  = 0x93;
           =2 sfr P0M1  = 0x94;
           =2 
           =2 
           =2 
           =2 // for PCA
           =2 sfr CCON   = 0xD8;
           =2 sfr CMOD   = 0xD9;
           =2 sfr CCAPM0 = 0xDA;
           =2 sfr CCAPM1 = 0xDB;
           =2 sfr CCAPM2 = 0xDC;
           =2 sfr CCAPM3 = 0xDD;
           =2 sfr CCAPM4 = 0xDE;
           =2 sfr CCAPM5 = 0xDF;
           =2 sfr CL     = 0xE9;
           =2 sfr CH     = 0xF9;
           =2 sfr CCAP0L = 0xEA;
           =2 sfr CCAP0H = 0xFA;
           =2 sfr CCAP1L = 0xEB;
           =2 sfr CCAP1H = 0xFB;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 69  

           =2 sfr CCAP2L = 0xEC;
           =2 sfr CCAP2H = 0xFC;
           =2 sfr CCAP3L = 0xED;
           =2 sfr CCAP3H = 0xFD;
           =2 sfr CCAP4L = 0xEE;
           =2 sfr CCAP4H = 0xFE;
           =2 sfr CCAP5L = 0xEF;
           =2 sfr CCAP5H = 0xFF;
           =2 sfr PCAPWM0= 0xF2;
           =2 sfr PCAPWM1= 0xF3;
           =2 sfr PCAPWM2= 0xF4;
           =2 sfr PCAPWM3= 0xF5;
           =2 sfr PCAPWM4= 0xF6;
           =2 sfr PCAPWM5= 0xF7;
           =2 
           =2 /*  BIT Registers  */
           =2 /*  PSW  */
           =2 sbit CY    = 0xD7;
           =2 sbit AC    = 0xD6;
           =2 sbit F0    = 0xD5;
           =2 sbit RS1   = 0xD4;
           =2 sbit RS0   = 0xD3;
           =2 sbit OV    = 0xD2;
           =2 sbit P     = 0xD0;
           =2 
           =2 /*  TCON  */
           =2 sbit TF1   = 0x8F;
           =2 sbit TR1   = 0x8E;
           =2 sbit TF0   = 0x8D;
           =2 sbit TR0   = 0x8C;
           =2 sbit IE1   = 0x8B;
           =2 sbit IT1   = 0x8A;
           =2 sbit IE0   = 0x89;
           =2 sbit IT0   = 0x88;
           =2 
           =2 /*  IE  */
           =2 sbit EA    = 0xAF;
           =2 sbit ES    = 0xAC;
           =2 sbit ET1   = 0xAB;
           =2 sbit EX1   = 0xAA;
           =2 sbit ET0   = 0xA9;
           =2 sbit EX0   = 0xA8;
           =2 
           =2 /*  IP  */
           =2 sbit PS    = 0xBC;
           =2 sbit PT1   = 0xBB;
           =2 sbit PX1   = 0xBA;
           =2 sbit PT0   = 0xB9;
           =2 sbit PX0   = 0xB8;
           =2 
           =2 /*  P3  */
           =2 sbit RD    = 0xB7;
           =2 sbit WR    = 0xB6;
           =2 sbit T1    = 0xB5;
           =2 sbit T0    = 0xB4;
           =2 sbit INT1  = 0xB3;
           =2 sbit INT0  = 0xB2;
           =2 sbit TXD   = 0xB1;
           =2 sbit RXD   = 0xB0;
           =2 
           =2 /*  SCON  */
           =2 sbit SM0   = 0x9F;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 70  

           =2 sbit SM1   = 0x9E;
           =2 sbit SM2   = 0x9D;
           =2 sbit REN   = 0x9C;
           =2 sbit TB8   = 0x9B;
           =2 sbit RB8   = 0x9A;
           =2 sbit TI    = 0x99;
           =2 sbit RI    = 0x98;
           =2 
           =2 /*  8052 Extensions  */
           =2 /*  IE  */
           =2 sbit ET2   = 0xAD;
           =2 
           =2 /*  IP  */
           =2 sbit PT2   = 0xBD;
           =2 
           =2 /*  P1  */
           =2 sbit T2EX  = 0x91;
           =2 sbit T2    = 0x90;
           =2              
           =2 /*  T2CON  */
           =2 sbit TF2   = 0xCF;
           =2 sbit EXF2  = 0xCE;
           =2 sbit RCLK  = 0xCD;
           =2 sbit TCLK  = 0xCC;
           =2 sbit EXEN2 = 0xCB;
           =2 sbit TR2   = 0xCA;
           =2 sbit C_T2  = 0xC9;
           =2 sbit CP_RL2= 0xC8;
           =2 
           =2 sfr     CHPENR = 0xF6;
           =2 sfr     CHPCON = 0xBF;
           =2 sfr     SFRAL  = 0xC4;
           =2 sfr     SFRAH  = 0xC5;
           =2 sfr     SFRFD  = 0xC6;
           =2 sfr     SFRCN  = 0xC7;
           =2 
           =2 sbit P0_0  = 0x80;
           =2 sbit P0_1  = 0x81;
           =2 sbit P0_2  = 0x82;
           =2 sbit P0_3  = 0x83;
           =2 sbit P0_4  = 0x84;
           =2 sbit P0_5  = 0x85;
           =2 sbit P0_6  = 0x86;
           =2 sbit P0_7  = 0x87;
           =2 
           =2 sbit P1_0  = 0x90;
           =2 sbit P1_1  = 0x91;
           =2 sbit P1_2  = 0x92;
           =2 sbit P1_3  = 0x93;
           =2 sbit P1_4  = 0x94;
           =2 sbit P1_5  = 0x95;
           =2 sbit P1_6  = 0x96;
           =2 sbit P1_7  = 0x97;
           =2 
           =2 sbit P2_0  = 0xa0;
           =2 sbit P2_1  = 0xa1;
           =2 sbit P2_2  = 0xa2;
           =2 sbit P2_3  = 0xa3;
           =2 sbit P2_4  = 0xa4;
           =2 sbit P2_5  = 0xa5;
           =2 sbit P2_6  = 0xa6;
           =2 sbit P2_7  = 0xa7;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 71  

           =2 
           =2 sbit P3_0  = 0xb0;
           =2 sbit P3_1  = 0xb1;
           =2 sbit P3_2  = 0xb2;
           =2 sbit P3_3  = 0xb3;
           =2 sbit P3_4  = 0xb4;
           =2 sbit P3_5  = 0xb5;
           =2 sbit P3_6  = 0xb6;
           =2 sbit P3_7  = 0xb7;
           =2 
           =2 sbit P4_0  = P4^0;
           =2 sbit P4_1  = P4^1;
           =2 sbit INT3  = P4^2;
           =2 sbit INT2  = P4^3;
           =2 #endif  // INTERNAL_MCU
           =2 
           =2 #endif  //__REGISTERS__
   7      =1  
   8      =1  #define LEFT_T     P0_0
   9      =1  #define Right_T    P0_1
  10      =1  #define REVERSE_T  P0_2
  11      =1  #define PARK_T     P0_3
  12      =1  #define VGA_T      P0_4
  13      =1  #define CAMC_T     P0_5
  14      =1  #define CAMD_T     P0_6
  15      =1  //#define Audio_Select1     P2_0
  16      =1  //#define Audio_Select2     P2_1
  17      =1  //#define Audio_Mute        P0_7
  18      =1  //#define AVOutPutSelect    P1_7
  19      =1  #define RS232Select     P4_0
  20      =1  #define ACC_B           P1_6
  21      =1  
  22      =1  #define PPWR            P3_6
  23      =1  
  24      =1  
  25      =1  #endif
  37          #include "HS_DVRProtocol.h"
   1      =1  
   2      =1  
   3      =1  
   4      =1  #ifndef _HS_DVRProtocol_
   5      =1  #define _HS_DVRProtocol_
   6      =1  
   7      =1  //==================================================
   8      =1  //
   9      =1  //
  10      =1  //
  11      =1  //==================================================
  12      =1  
  13      =1  
  14      =1  enum HS_DvrCommand
  15      =1  {
  16      =1          CMD_NULL,
  17      =1          SetDVRParam,    // 1
  18      =1          SetDVRDefault,
  19      =1          SetDATETIME,
  20      =1          GetDVRParam,
  21      =1          GetDVRStatus,
  22      =1          GetDATETIME, 
  23      =1          SetFormatSD, 
  24      =1          SendAlarm, 
  25      =1          GetDVRVersion=0x09, 
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 72  

  26      =1          SendDVRStatus=0x14,
  27      =1          GetLCDMode=0x15,
  28      =1          SendDVRParam=0x16,
  29      =1          SendDVRParamDT=0x17,
  30      =1          SetFormatSDDone=0x18,
  31      =1          Halt_Start=0xc8,
  32      =1          Halt_OK=0xc9,
  33      =1          FW_Update_Start=0xca,
  34      =1          FW_Update_OK=0xcb,
  35      =1          MANUALRECSTART=0xdc,
  36      =1          MANUALRECSTOP=0xdd,
  37      =1          SNAPSHOT=0xde,
  38      =1          CMD_UNKNOWN=0xff,
  39      =1          CMD_NUM
  40      =1  };
  41      =1  
  42      =1  
  43      =1  //RS485 TX or RX define
  44      =1  enum
  45      =1  {
  46      =1          RS485_TX,               //RS485 Transmit        
  47      =1          RS485_RX                //Rs485 Receive
  48      =1  };
  49      =1  
  50      =1  enum
  51      =1  {
  52      =1          Baud_rate2400,          
  53      =1          Baud_rate4800,  
  54      =1          Baud_rate9600
  55      =1  };
  56      =1  
  57      =1  
  58      =1  //Camera Command ID define
  59      =1  enum
  60      =1  {
  61      =1  //      CAM_CLEAR,                              //Clear 
  62      =1          CAM_ZOOM_OUT_START,                     //Zoom Out  Start
  63      =1  //      CAM_ZOOM_OUT_END,                       //Zoom Out  End
  64      =1          CAM_ZOOM_IN_START,                      //Zoom In Start
  65      =1  //      CAM_ZOOM_IN_END,                        //Zoom In End
  66      =1  //      CAM_IRIS_CLOSE_START,           //IRIS Close Start
  67      =1  //      CAM_IRIS_CLOSE_END,             //IRIS Close End
  68      =1  //      CAM_IRIS_OPEN_START,                    //IRIS Open Start
  69      =1  //      CAM_IRIS_OPEN_END,                      //IRIS Open End
  70      =1  //      CAM_FOCUS_FAR_START,            //Focus Far Start
  71      =1  //      CAM_FOCUS_FAR_END,              //Focus Far End
  72      =1  //      CAM_FOCUS_NEAR_START,           //Focus Near Start
  73      =1  //      CAM_FOCUS_NEAR_END,             //Focus Near End
  74      =1          CAM_SET,                                //Set 
  75      =1          CAM_CALL,                               //Call 
  76      =1  //      CAM_FOCUS_SPEED,                //Focus Speed
  77      =1  //      CAM_ZOOM_SPEED,         //Zoom Speed
  78      =1          CAM_PTZ_RIGHT,                  //PTZ Right 
  79      =1          CAM_PTZ_LEFT,                   //PTZ Left
  80      =1          CAM_PTZ_UP,                     //PTZ Up
  81      =1          CAM_PTZ_DOWN,                   //PTZ Down
  82      =1          CAM_MENU_ENTER,                 //PTZ Down
  83      =1          CAM_Iris_Open,
  84      =1  
  85      =1  //      CAM_PTZ_RIGHT_UP,               //PTZ Right with Up
  86      =1  //      CAM_PTZ_RIGHT_DOWN,     //PTZ Right with Down
  87      =1  //      CAM_PTZ_LEFT_UP,                //PTZ Left with Up
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 73  

  88      =1  //      CAM_PTZ_LEFT_DOWN,      //PTZ Left with Down
  89      =1          CAM_PTZ_STOP                    //PTZ Control Stop
  90      =1  };
  91      =1  
  92      =1  void Hs_DvrTxCmdPaser(BYTE Cmd_Id );
  93      =1  void Hs_Protocol_Init(void);
  94      =1  BYTE DvrReceivePaser(void);
  95      =1  extern bit       DVR_Ready;
  96      =1  void CAM_TxCommand_toRS485(BYTE Com_ID);
  97      =1  void Send_PelcoP_Command(void);
  98      =1  void Send_PelcoD_Command(void);
  99      =1  void Send_GE_Command(void);
 100      =1  #endif
 101      =1  
  38          #include <math.h>
   1      =1  /*--------------------------------------------------------------------------
   2      =1  MATH.H
   3      =1  
   4      =1  Prototypes for mathematic functions.
   5      =1  Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc.
   6      =1  All rights reserved.
   7      =1  --------------------------------------------------------------------------*/
   8      =1  
   9      =1  #ifndef __MATH_H__
  10      =1  #define __MATH_H__
  11      =1  
  12      =1  #pragma SAVE
  13      =1  #pragma REGPARMS
  14      =1  extern char  cabs  (char  val);
  15      =1  extern int    abs  (int   val);
  16      =1  extern long  labs  (long  val);
  17      =1  extern float fabs  (float val);
  18      =1  extern float sqrt  (float val);
  19      =1  extern float exp   (float val);
  20      =1  extern float log   (float val);
  21      =1  extern float log10 (float val);
  22      =1  extern float sin   (float val);
  23      =1  extern float cos   (float val);
  24      =1  extern float tan   (float val);
  25      =1  extern float asin  (float val);
  26      =1  extern float acos  (float val);
  27      =1  extern float atan  (float val);
  28      =1  extern float sinh  (float val);
  29      =1  extern float cosh  (float val);
  30      =1  extern float tanh  (float val);
  31      =1  extern float atan2 (float y, float x);
  32      =1  
  33      =1  extern float ceil  (float val);
  34      =1  extern float floor (float val);
  35      =1  extern float modf  (float val, float *n);
  36      =1  extern float fmod  (float x, float y);
  37      =1  extern float pow   (float x, float y);
  38      =1  
  39      =1  #pragma RESTORE
  40      =1  
  41      =1  #endif
  39          
  40          //bit   AccessEnable = 1;
  41          
  42          void Loader(BYTE);
  43          
  44          extern  CODE BYTE NTSC_Regs[];
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 74  

  45          extern  CODE BYTE PAL_Regs[];
  46          extern  CODE BYTE DVI_Regs[];
  47          #ifdef ADD_ANALOGPANEL
              extern CODE BYTE NTSC_Regs_Analog[];
              extern CODE BYTE PAL_Regs_Analog[];
              #endif
  51          
  52          #ifdef SUPPORT_COMPONENT
              extern CODE BYTE COMP_YPbPr_480I_Reg[];
              extern CODE BYTE COMP_YPbPr_576I_Reg[];
               #ifndef WQVGA
              extern CODE BYTE COMP_YPbPr_480P_Reg[];
              extern CODE BYTE COMP_YPbPr_576P_Reg[];
              extern CODE BYTE COMP_YPbPr_1080I_Reg[];
              extern CODE BYTE COMP_YPbPr_720P_Reg[];
               #endif
              #endif
  62          
  63          #ifdef SUPPORT_GAMMA
              extern CODE BYTE GammaRed[];
              extern CODE BYTE GammaBlue[];
              extern CODE BYTE GammaGreen[];
              #endif
  68          
  69          BYTE CAMNumber;
  70          BYTE PelcoChoiceFLAG;
  71          BYTE Baud_rate;
  72          
  73          BYTE    SelectModeType;
  74          //BYTE  JumpModeType;
  75          BYTE    Priority;
  76          BYTE    PowerFlag;
  77          bit VGAflag=0;
  78          bit GetDATETIMEflag;
  79          extern DATA BYTE        RS2_in;
  80          extern bit DVR_Ready;
  81          extern bit      GetDVRStatusflag;
  82          
  83          extern DATA BYTE        RS_buf2[BUF_MAX];
  84          
  85          BYTE DVR_AudioRecord;
  86          bit             PowerDownStart=0;
  87          extern BYTE     PowerDownWait;
  88          bit     AccPowerDown=0;
  89          extern bit CAM_PTZ_RUN_flag;
  90          DATA BYTE PWMLevel=0;
  91          
  92          extern  DATA  WORD  tic_pc;
  93          extern void CheckPanelImage(void);
  94          extern CODE BYTE Init_Osd_DisplayDVRstatus[];
  95          
  96          
  97                          BYTE  InputSelection;
  98          //              IDATA BYTE      InputSelectionInx = 0;
  99          ///         bit   PcDetectFlag = 1;
 100          //              bit       PowerMode = ON;
 101                          IDATA WORD  IVF;
 102                          IDATA DWORD     IHF;
 103                          BYTE  VInputStd;
 104          
 105                          bit   Range4Coarse=0;
 106                          //bit     AutoDetect=0;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 75  

 107                          BYTE  VInputStdDetectMode;
 108                          //BYTE  CheckBuf;
 109                          BYTE  SEQTime;
 110                          BYTE  AutoDayNight;
 111          
 112          CODE struct struct_IdName       struct_InputSelection[]={
 113                  { UNKNOWN                       ,       "" },                           //don't remove or change this.
 114                  { CH_TW2835,    "CVBS" },                       //don't remove or change this.
 115                  { CH_CAMD  ,   "CAM D"},
 116                  { CH_AV    ,    "AV  "},
 117                                                                                                          // you can change the order of the followings
 118                  #ifdef SUPPORT_SVIDEO
                      { SVIDEO                        ,       "S-Video" },
                      #endif
 121          
 122                  #ifdef SUPPORT_COMPONENT
                      { COMPONENT     ,                       "Component" },
                      #endif
 125          
 126                  #ifdef SUPPORT_DTV
                      { DTV   ,                               "DTV-SOG" },
                      #endif
 129          
 130                  #ifdef SUPPORT_PC
 131                  { PC                            ,       "VGA"},
 132                  #endif
 133          
 134                  #ifdef SUPPORT_DVI
                      { DIGITALVGA            ,       "DVI" },
                      #endif
 137          
 138                  {0                                      ,       ""},                            //don't remove or change this.
 139          };
 140          
 141          
 142          CODE struct struct_IdName struct_VInputStd[]={
 143                  { UNKNOWN                       ,       "" },                           //don't remove or change this.
 144                  { NTSC,                                 "NTSC"},                        //don't remove or change this.
 145          
 146                  #ifdef SUPPORT_PAL
 147                  { PAL,                                  "PAL"},
 148                  #endif
 149          
 150                  #ifdef SUPPORT_SECAM
 151                  { SECAM,                                "SECAM"},
 152                  #endif
 153          
 154                  #ifdef SUPPORT_PALM
 155                  { PALM,                                 "PALM"},
 156                  #endif
 157          
 158                  #ifdef SUPPORT_PALN
 159                  { PALN,                                 "PALN"},
 160                  #endif
 161          
 162                  #ifdef SUPPORT_PAL60
 163                  { PAL60,                                "PAL60"},
 164                  #endif
 165          
 166                  #ifdef SUPPORT_NTSC4
 167                  { NTSC4,                                "NTSC4.43"},
 168                  #endif
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 76  

 169          
 170                  {0                                      ,       ""},                            //don't remove or change this.
 171          };
 172          
 173          
 174          
 175          //===================== OSD ===================================================
 176                      WORD  OSDLastKeyInTime;             // in ms
 177          //===================== Button Key ============================================
 178          
 179          //================= Etc. ======================================================
 180          #ifdef WIDE_SCREEN
 181                          BYTE  WideScreenMode;
 182          #endif
 183                          BYTE    DebugLevel;
 184          
 185                          bit   Flag4AutoPanelRegs = 0;
 186                          bit   I2CAutoIncFlagOn = 0;
 187          #ifdef SUPPORT_COMPONENT
                          BYTE  ComponentMode;
                              WORD  OLD_hpn;
              #endif
 191          //extern  bit               OnChangingValue;
 192          //extern  BYTE  TVInputSel;
 193          #ifdef SUPPORT_DEBUG
              extern  bit Debug_On;
              #endif
 196          
 197          #ifdef NO_INITIALIZE
                              bit             NoInitAccess=0;
              #endif
 200          
 201                      //bit   DisplayInputHold = 0;               //william-981029
 202          
 203          #if 0   //william-981105
              //////////////////////////////////////////////////////////////////////////////
              
              //=============================================================================
              //              Prompt                                                                         
              //=============================================================================
              
              void CheckDipSwitch(void)
              {
                      static bit BW_STATUS=0, EDGE_STATUS=0;
                                      //----- Check DIP Switch ---------------
              
                                      if( EDGE_STATUS != DIP_EDGE_ENHANCE ) {
                                              if( DIP_EDGE_ENHANCE==0 ) {
                                                      EDGE_STATUS = 0;
                                                      WriteTW88(0xdd, ReadTW88(0xdd) | 0x80);
                                                      //Printf("\r\nEnable Color Enhancement");
                                              }
                                              else {
                                                      EDGE_STATUS = 1;
                                                      WriteTW88(0xdd, ReadTW88(0xdd) & 0x7f);
                                                      //Printf("\r\nDisable Color Enhancement");
                                              }
                                      }
                                      
                                      if( BW_STATUS != DIP_BW_STRETCH ) {
                                              if( DIP_BW_STRETCH==0 ) {
                                                      BW_STATUS = 0;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 77  

                                                      #ifdef WQVGA
                                                      WriteTW88(0x86, 0x0c);
                                                      WriteTW88(0x87, 0xff);
                                                      #else
                                                      WriteTW88(0x86, 0x20);
                                                      WriteTW88(0x87, 0xe0);
                                                      #endif
                                                      //Printf("\r\nEnable Black/White Stretch");
                                              }
                                              else {
                                                      BW_STATUS = 1;
                                                      WriteTW88(0x86, 0x00);
                                                      WriteTW88(0x87, 0xff);
                                                      //Printf("\r\nDisable Black/White Stretch");
                                              }
                                      }
                                      if( AutoDetect != DIP_AUTO_DETECT ) {
                                              AutoDetect = DIP_AUTO_DETECT;
                                              //if ( AutoDetect )
                                                      //Puts("\r\nAutoDetect Mode Enabled" );
                                              //else
                                                      //Puts("\r\nAutoDetect Mode Disabled" );
                                      }
              }
              #endif
 256          #ifdef SUPPORT_GAMMA
              
              #include "Gamma.c"
              
              void DownLoadGamma(void)
              {
                              // Red
                              WriteI2C(TW88I2CAddress, 0xf0, 0xe8|1 ); 
                              WriteI2C(TW88I2CAddress, 0xf1, 0x00); //  Start Address
                              WriteI2C(TW88I2CAddress, 0xf2, GammaRed[0]); //  
                              WriteI2Cn(TW88I2CAddress, 0xf2, &GammaRed[1], 255);
                              // Blue
                              WriteI2C(TW88I2CAddress, 0xf0, 0xe8|2 ); 
                              WriteI2C(TW88I2CAddress, 0xf1, 0x00); //  Start Address
                              WriteI2C(TW88I2CAddress, 0xf2, GammaGreen[0]); //  
                              WriteI2Cn(TW88I2CAddress, 0xf2, &GammaGreen[1], 255);
                              // Red
                              WriteI2C(TW88I2CAddress, 0xf0, 0xe8|3 ); 
                              WriteI2C(TW88I2CAddress, 0xf1, 0x00); //  Start Address
                              WriteI2C(TW88I2CAddress, 0xf2, GammaBlue[0]); //  
                              WriteI2Cn(TW88I2CAddress, 0xf2, &GammaBlue[1], 255);
              
              }
              #endif
 280          
 281          void I2CDeviceInitialize( CODE_P BYTE *RegSet)
 282          {
 283   1              int     cnt=0;
 284   1              BYTE addr, index, val;
 285   1      
 286   1              addr = *RegSet;
 287   1              #ifdef DEBUG_TW88
                      dPrintf("\r\nI2C address : %02x", (WORD)addr);
                      #endif
 290   1              cnt = *(RegSet+1);
 291   1              RegSet+=2;
 292   1      
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 78  

 293   1              while (( RegSet[0] != 0xFF ) || ( RegSet[1]!= 0xFF )) {                 // 0xff, 0xff is end of data
 294   2                      index = *RegSet;
 295   2                      val = *(RegSet+1);
 296   2                      WriteI2C(addr, index, val);
 297   2      
 298   2                      #ifdef DEBUG_TW88
                              dPrintf("\r\n    addr=%02x  index=%02x   val=%02x", (WORD)addr, (WORD)index, (WORD)val );
                              #endif
 301   2      
 302   2                      RegSet+=2;
 303   2              }
 304   1              WriteTW88(0xff, 0x00);          // set page 0
 305   1      }
 306          
 307          extern CODE struct RegisterInfo UserRange;
 308          extern CODE struct RegisterInfo VideoContrastRange;
 309          extern CODE struct RegisterInfo VideoBrightnessRange;
 310          extern CODE struct RegisterInfo VideoSaturationRange;
 311          extern CODE struct RegisterInfo VideoHueRange;
 312          extern CODE struct RegisterInfo VideoSharpnessRange;
 313          extern CODE struct RegisterInfo DigitalVideoSaturationRange;
 314          
 315          #ifdef ADD_ANALOGPANEL
              BYTE IsAnalogOn(void)
              {
                      if(DIP_PANEL_SWITCH==0) return 1;
                      else return 0;
              }
              #endif
 322          
 323          void InitVideoData(BYTE src)
 324          {
 325   1      
 326   1              #ifdef DEBUG_DECODER
                      Printf("\r\n++(InitVideoData)src:%02x", (WORD)src);
                      #endif
 329   1      
 330   1              #ifdef ADD_ANALOGPANEL
                      if(IsAnalogOn())
                              I2CDeviceInitialize(NTSC_Regs_Analog);
                      else
                      #endif
 335   1              I2CDeviceInitialize(NTSC_Regs);
 336   1              WriteTW88(0xff, 0);
 337   1                                              
 338   1              switch( src ) {
 339   2      
 340   2              #ifdef SUPPORT_PAL
 341   2              case PAL:                       
 342   2                      #ifdef ADD_ANALOGPANEL
                                      if(IsAnalogOn())
                                              I2CDeviceInitialize(PAL_Regs_Analog);
                                      else
                              #endif
 347   2                      I2CDeviceInitialize(PAL_Regs);  
 348   2                      break;
 349   2              #endif
 350   2              #ifdef SUPPORT_SECAM
 351   2              case SECAM:             
 352   2                      #ifdef ADD_ANALOGPANEL
                                      if(IsAnalogOn())
                                              I2CDeviceInitialize(PAL_Regs_Analog);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 79  

                                      else
                              #endif
 357   2                      I2CDeviceInitialize(PAL_Regs);  
 358   2                      break;
 359   2              #endif
 360   2              #ifdef SUPPORT_PALN
 361   2              case PALN:              
 362   2                      #ifdef ADD_ANALOGPANEL
                                      if(IsAnalogOn())
                                              I2CDeviceInitialize(PAL_Regs_Analog);
                                      else
                              #endif
 367   2                      I2CDeviceInitialize(PAL_Regs);  
 368   2                      break;
 369   2              #endif
 370   2      
 371   2              #ifdef SUPPORT_NTSC4
 372   2              case NTSC4:
 373   2              #endif
 374   2              #ifdef SUPPORT_PALM
 375   2              case PALM:
 376   2              #endif
 377   2              #ifdef SUPPORT_PAL60
 378   2              case PAL60:
 379   2              #endif
 380   2              case NTSC:
 381   2      
 382   2              case UNKNOWN:
 383   2              case NOINPUT:   src = NTSC;                                             break;
 384   2              }
 385   1      
 386   1              if( InputSelection == TV ) 
 387   1              {
 388   2                      if( VInputStdDetectMode==AUTO ) SetAutoDetectStd();
 389   2                      else                                                    ClearAutoDetectStd(src-1);
 390   2              }
 391   1              else // Always Auto Detect.
 392   1                      SetAutoDetectStd();
 393   1                      
 394   1              //----- Set Panel Characteristics
 395   1      ///     SetPanelSingleDouble(PIXEL_SINGLE);
 396   1      
 397   1      
 398   1              WriteDecoder(V_CONTROL2, 0x15);                 // Set CC line number of Even Field
 399   1      //      WriteDecoder(CC_ODDLINE, 0x15);                 // Set CC line number of Odd Field
 400   1              WriteTW88(0x5c, 0x06);                  // change error tolerance and enable V/HSYNC change/loss detection
 401   1      
 402   1      //      DefaultPanelAttributeForVideo();
 403   1      
 404   1              SetVideoMode( GetVideoModeEE());                // 02212008 change for ??????? by ybae
 405   1              #ifdef DEBUG
                      dPrintf("\r\n SetVideoMode: %d", (WORD)GetVideoModeEE() );
                      #endif
 408   1      
 409   1              #ifdef WIDE_SCREEN
 410   1              Set4WideScreen(GetWideModeEE());
 411   1              #endif
 412   1      
 413   1      }
 414          
 415          /*********************************/
 416          BYTE IsNoInput(void)
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 80  

 417          {
 418   1              if( ReadDecoder(CSTATUS) & 0x80 ) return 1;
 419   1              return 0;
 420   1      }
 421          
 422          #ifdef ID_CHECK_BY_FW
              BYTE Is50Hz(void)
              {
                      if( ReadDecoder(CSTATUS) & 0x01 ) return 1;
                      return 0;
              }
              
              BYTE Slock(void)
              {
                      if( ReadDecoder(CSTATUS) & 0x20 ) return 1;
                      return 0;
              }
              #endif  // ID_CHECK_BY_FW
 435          
 436          #ifdef SUPPORT_COMPONENT
              void CheckDecoderComponent(void)
              {
                      CODE_P BYTE *reg=0;
                      BYTE mode;
                      WORD    width, height;
                      DWORD   scale;
              
                      extern CODE BYTE COMPONENT_STR[][15] ;
              
                      if( InputSelection != COMPONENT ) return;
              
                      mode = ((ReadDecoder(CVFMT) & 0x70) >> 4);
                      if( mode == ComponentMode ) return;
                      Printf("\n\rCheckDecoderComponent==> Changed component Mode: %2x-> %2x (%s)", (WORD)ComponentMode, (WORD)
             -mode,COMPONENT_STR[mode]);
              
                      ComponentMode = mode;
                      switch (mode)
                      {
                      case YPBPR_576i:        
                              #ifdef ADD_ANALOGPANEL
                                      if(IsAnalogOn())
                                      reg = COMP_YPbPr_576I_Reg;      
                                      else
                              #endif
                                      reg = COMP_YPbPr_576I_Reg;      
                                      width = 700;
                                      height = 280;
                              break;
                      #if (defined WQVGA) || (defined QVGA)
              
                      #else
                      case YPBPR_480p:        reg = COMP_YPbPr_480P_Reg;              width = 630;    height = 480;   break;
                      case YPBPR_576p:        reg = COMP_YPbPr_576P_Reg;              width = 630;    height = 576;   break;
                      case YPBPR_720p:        reg = COMP_YPbPr_720P_Reg;              width = 413;    height = 720;   break;
                      case YPBPR_1080i:       reg = COMP_YPbPr_1080I_Reg;             width = 624;    height = 540;   break;
                      #endif
                      default:                        reg = COMP_YPbPr_480I_Reg;              width = 700;    height = 235;   break;
              
                      }
              
                      //InitVideoData(NTSC);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 81  

              
                      I2CDeviceInitialize(reg);
              
                      scale = width;
                      scale *= 0x10000L;
                      scale /= PWIDTH;
                      XScale2(scale);
                      #ifdef DEBUG_COMPONENT
                      dPrintf("\r\nH scale: %xh - %xh", (WORD)(scale>>8), (WORD)(scale & 0xff));
                      #endif
              
                      scale = height;
                      scale *= 0x10000L;
                      scale /= PHEIGHT;
                      YScale2(scale);
                      #ifdef DEBUG_COMPONENT
                      dPrintf("\r\nV scale: %xh - %xh", (WORD)(scale>>8), (WORD)(scale & 0xff));
                      #endif
              
                      delay(50);
                      
                      //william-981029>>>>>>>
                      //if( IsNoInput() )     DisplayInputHold = 1;           // Hold  Input Information in no signal.
                      //else 
                      //DisplayInputHold = 0;
                      //william-981029>>>>>
              
                      ClearOSDInfo();
              
                      DisplayInput();
              }
              #endif
 510          void CheckDecoderInput(void)
 511          {
 512   1      
 513   1      #ifdef ID_CHECK_BY_FW
              
                      BYTE std, changed=0;
              
                      static DATA BYTE no_cnt=0, secam_cnt=0, check_cnt=0;
              
                      //if( InputSelection == TV ) return;
                      if( InputSelection == COMPONENT ) return;
                      if( ( InputSelection == TV ) && (VInputStdDetectMode != AUTO) ) return;
              
                      if( IsNoInput() ) {
              //              if( VInputStd==NOINPUT ) return;
                              no_cnt++;
                              if( no_cnt>=10 ) {
                                      no_cnt = 0;
                                      
                                      SetVInputStd( NOINPUT );
                                      InitVideoData(NTSC);    
              
                                      #ifdef DEBUG_DECODER
                                      Printf("\r\nDecoder No Input");
                                      #endif
              
                              }
                              return;
                      }
                      else {
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 82  

                              no_cnt = 0;
                      }
              
              
                      switch( VInputStd ) {
              
                      //--------------------------------------------------------------------------------------
                      case NOINPUT:
              
                              WriteDecoder(SDT, 0x0f);                // 0x1c
                              //WriteTW88(0xb6, 0x87);
                              //delay(50);
              
                              switch( ReadDecoder(SDT) & 0x70 ) {
                              case 0x00:      std = NTSC;     break;
                              case 0x10:      std = PAL;      break;
                              case 0x20:      std = SECAM;    break;
                              }
                              changed = 1;
                              check_cnt = 0;
                              secam_cnt = 0;
                              break;
                              
                      //--------------------------------------------------------------------------------------
                      case NTSC:
                              if( Is50Hz() ) {
                                      if( !Slock() ) secam_cnt++;
                                      if( ++check_cnt>=10 ) {
                                              if( secam_cnt>=7 ) {
                                                      std = SECAM;
                                                      changed = 1;
                                              }
                                              else {
                                                      std = PAL;
                                                      changed = 1;
                                              }
                                              check_cnt = 0;
                                              secam_cnt = 0;
                                      }
                              }
                              break;
              
                      //--------------------------------------------------------------------------------------
                      case PAL:
              
                              if( !Is50Hz() ) {
                                      std = NTSC;
                                      changed = 1;
                                      check_cnt = 0;
                                      secam_cnt = 0;
                              }
              
                              if( ReadTW88(0x30) & 0x10 ) secam_cnt++;
                              if( ++check_cnt>=10*10 ) {
                                      if( secam_cnt>=7 ) {
                                              std = SECAM;
                                              changed = 1;
                                      }
                                      check_cnt = 0;
                                      secam_cnt = 0;
                              }
                              break;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 83  

              
                      //--------------------------------------------------------------------------------------
                      case SECAM:
              
                              if( !Is50Hz() ) {
                                      std = NTSC;
                                      changed = 1;
                                      check_cnt = 0;
                                      secam_cnt = 0;
                              }
              
                              if( !(ReadTW88(0x30) & 0x80) ) secam_cnt++;
                              if( ++check_cnt>=10*10 ) {
              
                                      #ifdef DEBUG_DECODER
                                      Printf("%4d", secam_cnt);
                                      #endif
              
                                      if( secam_cnt<=7*10 ) {
                                              std = PAL;
                                              changed = 1;
                                      }
                                      check_cnt = 0;
                                      secam_cnt = 0;
                              }
                              break;
                      
              
                      default:
                              break;
              
                      }
              
                      if( changed ) {
                              SetVInputStd( std );
                              InitVideoData(std);
                              //DisplayInput();
              
                              switch( std ) {
                              case NTSC:      WriteDecoder(SDT, 0x08);        break;
                              case PAL:       WriteDecoder(SDT, 0x09);        break;
                              case SECAM:     WriteDecoder(SDT, 0x0a);        break;
                              }
                              
                              #ifdef DEBUG_DECODER
                              Printf("\r\n-------> Source changed %d", (WORD)VInputStd);
                              #endif
                              delay(99);
                      }
                              
              #else // not ID_CHECK_BY_FW
 653   1      
 654   1              BYTE std1, std, cnt=0, trycnt=0, ChangedNoinput;
 655   1      
 656   1                      #ifdef DEBUG_DECODER
                              Printf("\r\n====>CheckDecoderInput<====");
                              #endif
 659   1              // LJY101002
 660   1              // Algorithm I 
 661   1              //if( InputSelection == TV ) return;
 662   1              //if( InputSelection == COMPONENT ) return;
 663   1              if( ( InputSelection == TV ) && (VInputStdDetectMode != AUTO) ) return;
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 84  

 664   1      
 665   1              //if( VInputStdDetectMode==AUTO ) {
 666   1                      std1 = NOINPUT;
 667   1                      while(1) {                                              // keep checking until it's stable.(check cnt)
 668   2                              std = DetectDecoderInput();
 669   2                              #ifdef DEBUG_DECODER
                                      Printf("\r\nDetectDecoderInput: 0x%X, NOINPUT: 0x%x", (WORD)std, (WORD)std1);
                                      #endif
 672   2                              trycnt++;
 673   2                              if( trycnt>= 200 )                      // so many try, but unstable
 674   2                                      break;
 675   2      
 676   2                              if( std!=UNKNOWN && std!=VInputStd ) 
 677   2                                      {
 678   3                                      //changed!!
 679   3                                      if( std == std1 )               // same as previous one.
 680   3                                              cnt++;
 681   3                                      else
 682   3                                      {                                       // ooh.. different from previous one.
 683   4                                              cnt = 0;
 684   4                                              std1 = std;
 685   4                                      }
 686   3      
 687   3                                      if( cnt >= 2) { //100 ) {
 688   4                              #ifdef REFERENCE
                                      #else
 690   4                                              //ClearOSDInfo();
 691   4                              #endif 
 692   4                                              //LCDPowerOFF();
 693   4                                              if(  std == NOINPUT  )          //some input->NOINPUT
 694   4                                                      {                       
 695   5                                                      SetVInputStd( std );
 696   5                                                      ChangedNoinput = 1;             // Diaplay Input Information for no signal.
 697   5                                                      }
 698   4                                              else if( VInputStd==NOINPUT ) //NOINPUT->some input
 699   4                                                      {               
 700   5                                                      SetVInputStd( std );
 701   5                                                      InitVideoData(std);     
 702   5                                                      ChangedNoinput = 0;             // Diaplay Input Information for no signal.
 703   5                                                      }
 704   4                                              else 
 705   4                                                      {                                                               //some input1->some input2
 706   5      //                                              LCDPowerOFF();
 707   5                                                      //PanelMute(1);
 708   5      
 709   5                                                      SetVInputStd( std );
 710   5                                                      InitVideoData(std);     
 711   5                                                      delay(50);
 712   5      //                                              LCDPowerON(0);
 713   5                                                      ChangedNoinput = 0;             // Diaplay Input Information for no signal.
 714   5                                                      }
 715   4                                              
 716   4                                              //LCDPowerON(0);
 717   4                              #ifdef REFERENCE
                                      #else
 719   4                                              delay(0xff);
 720   4                              #endif 
 721   4                                              //DisplayInput();               //william-981029
 722   4                                              //DisplayInputHold = ChangedNoinput;            //william-981029
 723   4                                              break;
 724   4                                      }
 725   3                              }
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 85  

 726   2                              #if 0           //william-981029
                                      else
                                      {
                                              if(  std == NOINPUT  )                  // NOINPUT->NOINPUT
                                                      DisplayInputHold = 1;           // Hold input information in no signal.
                                              else
                                                      DisplayInputHold = 0;           // clear 
                                              break;
              
                                      }
                                      #endif
 737   2                      }
 738   1                      //Printf("\r\nDisplayInputHold=%02x",(WORD)DisplayInputHold);
 739   1              //}
 740   1              
 741   1      #endif  // ID_CHECK_BY_FW
 742   1      
 743   1      }
 744          
 745          BYTE ReadVInputSTD(void)
 746          {
 747   1              BYTE std;
 748   1              
 749   1              if( IsNoInput() ) return 1; // Noinput!!
 750   1              
 751   1              std = ReadDecoder(SDT) & 0xf0;
 752   1              if( std & 0x80 ) return 1; // Detection in progress..
 753   1              else 
 754   1                      return ((( std & 0x70 ) >> 4 ) + 1 );
 755   1      }
 756          
 757          BYTE GetVInputStdInx(void)
 758          {
 759   1              BYTE i, std;
 760   1      
 761   1              std = ReadVInputSTD();
 762   1      
 763   1              switch( std ) {
 764   2      
 765   2              case NTSC4:
 766   2              case PALM:
 767   2              case PAL60:
 768   2              case NTSC:              IVF = 60;               IHF = 15723;    break;  // 15734
 769   2      
 770   2              case SECAM:
 771   2              case PALN:
 772   2              case PAL:               IVF = 50;               IHF = 15723;    break;  // 15625
 773   2              default:                IVF = 0;                IHF = 0;                break;
 774   2              }
 775   1      
 776   1              for(i=0; ; i++) {
 777   2                      if( struct_VInputStd[i].Id ==std )
 778   2                              return i;
 779   2                      if( struct_VInputStd[i].Id ==0 )
 780   2                              break;
 781   2              }
 782   1              return 0;
 783   1      }
 784          
 785          #ifdef WIDE_SCREEN
 786          BYTE GetVInputStd(void)
 787          {
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 86  

 788   1              return VInputStd;
 789   1      }
 790          #endif
 791          
 792          void SetVInputStd(BYTE newd)
 793          {
 794   1              VInputStd = newd;
 795   1      
 796   1              #ifdef DEBUG
                      //Printf("\r\n(SetVInputStd) VInputStd:(%s)", struct_VInputStd[GetVInputStdInx()].Name);
                      Printf("\r\n(SetVInputStd) VInputStd:%d(%s)", (WORD)newd, struct_VInputStd[GetVInputStdInx()].Name);
                      #endif
 800   1      
 801   1              switch( VInputStd ) {
 802   2      
 803   2              #ifdef SUPPORT_NTSC4
 804   2              case NTSC4:
 805   2              #endif
 806   2              #ifdef SUPPORT_PALM
 807   2              case PALM:
 808   2              #endif
 809   2              #ifdef SUPPORT_PAL60
 810   2              case PAL60:
 811   2              #endif
 812   2              case NTSC:              IVF = 60;               IHF = 15723;    break;  // 15734
 813   2      
 814   2              #ifdef SUPPORT_SECAM
 815   2              case SECAM:
 816   2              #endif
 817   2              #ifdef SUPPORT_PALN
 818   2              case PALN:
 819   2              #endif
 820   2              #ifdef SUPPORT_PAL
 821   2              case PAL:               IVF = 50;               IHF = 15723;    break;  // 15625
 822   2              #endif
 823   2      
 824   2              default:                IVF = 0;                IHF = 0;                break;
 825   2              }
 826   1      }
 827          
 828          BYTE GetInputSelection(void)
 829          {
 830   1              return InputSelection;
 831   1      }
 832          
 833          BYTE GetNextInputSelection(void)
 834          {
 835   1              BYTE i;
 836   1      
 837   1              for (i=1; ;i++)
 838   1                      if( struct_InputSelection[i].Id==InputSelection )  break;
 839   1              i++;
 840   1              if( struct_InputSelection[i].Id == 0 ) i=1;
 841   1      
 842   1              return struct_InputSelection[i].Id;
 843   1      }
 844          
 845          void PowerDown_XTAL(bit flag)
 846          {
 847   1              if( flag ) P3_7 = 1;
 848   1              else      P3_7 = 0;
 849   1      }
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 87  

 850          
 851          void Audio_Select(BYTE flag)
 852          {
 853   1              switch(flag)
 854   1              {
 855   2                      case 0:
 856   2                              TW2835Cmd("\n\raudioselect 0\n\r");     
 857   2                              break;
 858   2                      case 1:
 859   2                              TW2835Cmd("\n\raudioselect 1\n\r");     
 860   2                              break;  
 861   2                      case 2:
 862   2                              TW2835Cmd("\n\raudioselect 2\n\r");     
 863   2                              break;
 864   2                      case 3:
 865   2                              TW2835Cmd("\n\raudioselect 3\n\r");     
 866   2                              break;
 867   2              }
 868   1      
 869   1      }
 870          void ChangeInput(BYTE newsel)
 871          {
 872   1              
 873   1      
 874   1      //      extern  CODE struct _PCMDATA PCMDATA[];
 875   1              #ifdef DEBUG
                      BYTE i;
                      #endif
 878   1              #if (defined SUPPORT_PC) || (defined SUPPORT_DTV)
 879   1              BYTE ret;
 880   1              #endif
 881   1      
 882   1              if( InputSelection==newsel ) return;
 883   1      
 884   1              //DisplayInputHold = 0; // Refresh Input info.  //william-981029
 885   1              ClearOSDInfo();
 886   1      
 887   1              LCDPowerOFF(); 
 888   1              //LCDPowerON(0); 
 889   1      
 890   1              //PanelMute(1);
 891   1      
 892   1              InputSelection = newsel;
 893   1              
 894   1              
 895   1      
 896   1                      #ifdef DEBUG
                              for (i=1; ;i++)
                                      if( struct_InputSelection[i].Id==InputSelection )  break;
                              Printf("\r\n ->->->->->->->->->->-> Changed Input: %s(%02x)", struct_InputSelection[i].Name, (WORD)Input
             -Selection);
                              #endif
 901   1      
 902   1                      InitVideoData(VInputStd);
 903   1      
 904   1                      switch(InputSelection) {
 905   2      
 906   2                              #ifdef SUPPORT_PC
 907   2                              case PC:                
 908   2      
 909   2                                                      AVGAInput();                            // load data and input mux selection to PC                                                      
 910   2                                                      AutoPHPCalDisable();
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 88  

 911   2                                                      tic_pc = 0;
 912   2                                                      ret = DetectAndSetForVGAInput(1);
 913   2                                                      Audio_Select(2);
 914   2                                                      VGAAudio=1;
 915   2                                                      ChangeVol(0);                   //william-v1.1-991208
 916   2                                                      //Audio_Select1=1;                           
 917   2                                                      //Audio_Select2=0;  
 918   2                                                      //ret = DetectAndSetForVGAInput(0);
 919   2      
 920   2                                                      break;
 921   2      
 922   2                              #endif
 923   2               
 924   2                              case CH_TW2835:
 925   2                                                  COMPOSITE1Input();
 926   2                                                      //ExtAudio();
 927   2                                                  Audio_Select(0);
 928   2                                                  VGAAudio=0;
 929   2                                                  ChangeVol(0);                       //william-v1.1-991208
 930   2                                                  //Audio_Select1=0;                           
 931   2                                                 //Audio_Select2=0;  
 932   2                                                      break;
 933   2                              case CH_CAMD:
 934   2                                              COMPOSITE2Input();
 935   2                                                Audio_Select(1);
 936   2                                                VGAAudio=0;
 937   2                                                ChangeVol(0);                 //william-v1.1-991208
 938   2                                                      //Audio_Select1=0;                           
 939   2                                                      //Audio_Select2=1;  
 940   2                                                      break;
 941   2                              case CH_AV:
 942   2                                              COMPOSITE3Input();
 943   2                                               Audio_Select(2);       
 944   2                                               VGAAudio=0;
 945   2                                               ChangeVol(0);                  //william-v1.1-991208
 946   2                                                      //Audio_Select1=1;                           
 947   2                                                    //Audio_Select2=0;  
 948   2                                                      break;
 949   2                      
 950   2                      }
 951   1              CheckPanelImage();              //william-981111                changesource load panelimage
 952   1              SaveInputSelectionEE(InputSelection);           // HHY 1.31
 953   1      //#ifdef WIDE_SCREEN
 954   1      //      WideScreenMode = WIDESCREEN_WIDE;
 955   1      //#endif
 956   1              //InitOSDMenu();  // Standby OSD Menu
 957   1      
 958   1              #ifdef DEBUG_PAUSE
                      Pause("Detect and Set {CR}");
                      #endif
 961   1      
 962   1              #if (defined SUPPORT_PC) || (defined SUPPORT_DTV)
 963   1              if( InputSelection==PC || InputSelection==DTV ) {
 964   2                      if( ret==TRUE ) {
 965   3                              ret = ReadDecoder(ACNTL);
 966   3                              ret |= 0x80;    // Software Reset
 967   3                              WriteDecoder(ACNTL, ret);
 968   3                              delay(30);
 969   3                              WriteTW88( 0xff, 1);
 970   3                              WriteTW88( 0xCD, 1 );   // init LLPLL
 971   3                              WriteTW88( 0xff, 0 );
 972   3                              //DisplayInput();
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 89  

 973   3                      }
 974   2                      else {
 975   3                          //CheckDipSwitch();//andy AWT 981015                
 976   3                              LCDPowerON(0);
 977   3                              delay(100);
 978   3                              WriteTW88( 0xd0, 0xff); // clear status
 979   3                              WriteTW88( 0xd1, 0xff); // clear status
 980   3                              return;
 981   3                      }
 982   2                      
 983   2              }
 984   1              else 
 985   1              #endif
 986   1              {
 987   2                      //DisplayInput();
 988   2      
 989   2                      #ifdef SUPPORT_COMPONENT
                              if( InputSelection == COMPONENT ){
                                      delay(30);
                                      ComponentMode = 0xff;
                                      CheckDecoderComponent();
                              }
                              else 
                              #endif
 997   2                      { 
 998   3                              delay(30);
 999   3                              CheckDecoderInput();
1000   3                      }
1001   2      //william-981110                
1002   2      //Printf("\r\nSetPanelBrightnessReg");
1003   2      //      SetPanelBrightnessReg(RED,  0x80);
1004   2      //      SetPanelBrightnessReg(GREEN,0x80);
1005   2      //      SetPanelBrightnessReg(BLUE, 0x80);
1006   2      //      SetPanelContrastReg(0,0x80);
1007   2      //      SetPanelContrastReg(1,0x80);
1008   2      //      SetPanelContrastReg(2,0x80);
1009   2      //william-981110        
1010   2              }
1011   1              //----- Check DIP Switch ---------------
1012   1              //CheckDipSwitch();                      //andy AWT 981015              
1013   1              //Pause("\r\nBeforn LCD ON");
1014   1              //delay(250);
1015   1      
1016   1      
1017   1              
1018   1              DisplayInput();
1019   1              LCDPowerON(0);
1020   1              
1021   1              delay(100);
1022   1              WriteTW88( 0xd0, 0xff); // clear status
1023   1              WriteTW88( 0xd1, 0xff); // clear status
1024   1      }
1025          
1026          void PowerOff(void)
1027          {
1028   1              Printf("\r\n++(PowerOff)__");
1029   1      //      PowerMode = OFF;
1030   1      
1031   1              //AudioOff();
1032   1              AudioMute(0);
1033   1              ClearOSDInfo();
1034   1              LCDPowerOFF();
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 90  

1035   1              PowerLED(OFF);
1036   1      }
1037          
1038          void WaitPowerOn(void)
1039          {
1040   1      
1041   1              BYTE ikey,val;
1042   1              BYTE VGATrigger=0;
1043   1              //BYTE AutoKey, _RemoDataCode;
1044   1      
1045   1              while(1) 
1046   1              {
1047   2                      ACCPowerControl();
1048   2                      if(RS2_in!=0 && !(GetDisplayedOSD() & MENU))
1049   2                              {
1050   3                              DvrReceivePaser();      
1051   3                              RS2_in=0;
1052   3                              }
1053   2      
1054   2                      if(GetDVRStatusflag==1)
1055   2                              {
1056   3                              Hs_DvrTxCmdPaser(GetDVRStatus);
1057   3                              Hs_DvrTxCmdPaser(GetDVRParam);
1058   3                              Hs_DvrTxCmdPaser(GetDATETIME);
1059   3                              //Hs_DvrTxCmdPaser(GetDVRVersion);              
1060   3                              GetDVRStatusflag=0;
1061   3                              }
1062   2                      //--------------Check Trigger ---------------------
1063   2                      
1064   2                      val=CheckTrigger();
1065   2                      if(val!=0)
1066   2                      {       
1067   3                              TriggerHandler(val);
1068   3                              if(!(TriggerMode==0x08&&ReadEEP(EEP_TriggerVGA)==1))
1069   3                              {
1070   4                                      LCDPowerON(0);  
1071   4                                      AudioMute(1);
1072   4                              }
1073   3                      }
1074   2                      else
1075   2                      {
1076   3                              PowerOff();
1077   3                              AudioMute(0);
1078   3                              //PowerLED(OFF);
1079   3                              //clrBacklight();
1080   3                              //Wait_ms(100);
1081   3                              //Panel_Disable();
1082   3                              TriggerHandler(val);
1083   3                      //if(TriggerMode!=0x08) 
1084   3                      }
1085   2      #if 1   
1086   2                      if(TriggerMode==0x06)
1087   2                              {
1088   3                              PowerFlag=1;
1089   3                              WriteEEP(EEP_Powerflag,PowerFlag);//2007.3.28 Justin
1090   3                              VGATrigger=1;
1091   3                              
1092   3                              break;
1093   3                              }
1094   2      #endif          
1095   2                      if( (ikey = GetKey(0)) ) {
1096   3                              #ifdef POWERKEY
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 91  

1097   3                              if( ikey==POWERKEY && CheckTrigger()==0)
1098   3                                      {
1099   4                                      PowerFlag=1;
1100   4                                      WriteEEP(EEP_Powerflag,PowerFlag);//2007.3.28 Justin
1101   4                                      break;          //poweron
1102   4                                      }
1103   3                              #endif
1104   3                      }
1105   2                      #if 0
                              if( IsRemoDataReady(&_RemoDataCode, &AutoKey) ) {
                                      if( _RemoDataCode==REMO_STANDBY && !AutoKey )           //POWERON
                                              break;          //poweron
                              
                              }
                              #endif
1112   2      
1113   2              }
1114   1      
1115   1              #ifdef DEBUG_MAIN
                      dPuts("\r\n++(PowerOn)__");
                      #endif
1118   1      //      PowerMode = ON;
1119   1            // SetNowMode();
1120   1              PowerLED(ON);
1121   1              AudioMute(1);
1122   1              //Panel_Enable();
1123   1              //Wait_ms(200);
1124   1              //SetBacklight();
1125   1              
1126   1              
1127   1      //      AudioOn();                      //SetMSPVol();
1128   1      if(SelectModeType==VGAMode)
1129   1              cLastSyncLoss=0;                //pc mode update SyncLoss
1130   1              LCDPowerON(0);
1131   1      if(VGATrigger==0)
1132   1              DisplayInput();
1133   1      
1134   1      
1135   1      }
1136          
1137          void SetOSDLastKeyInTime(void)
1138          {
1139   1              OSDLastKeyInTime = GetTime_ms();
1140   1      }
1141          
1142          WORD GetOSDLastKeyInTime(void)
1143          {
1144   1              return OSDLastKeyInTime ;
1145   1      }
1146          
1147          //=============================================================================
1148          //
1149          //=============================================================================
1150          #ifdef SUPPORT_PATTERN
              CODE BYTE PATTERN[7][] = {
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0xff, 0x65,0x00, 0x66,0x00, 0x67,0xff, 0x68,0x00, 0x69,0x00, 0xff,0xff
             -},        // Red
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0x00, 0x65,0xff, 0x66,0x00, 0x67,0x00, 0x68,0xff, 0x69,0x00, 0xff,0xff
             -},        // Green
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0x00, 0x65,0x00, 0x66,0xff, 0x67,0x00, 0x68,0x00, 0x69,0xff, 0xff,0xff
             -},        // Blue
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0xff, 0x65,0xff, 0x66,0xff, 0x67,0xff, 0x68,0xff, 0x69,0xff, 0xff,0xff
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 92  

             -},        // White
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0x00, 0x65,0x00, 0x66,0x00, 0x67,0xff, 0x68,0xff, 0x69,0xff, 0xff,0xff
             -},        // Gray
                      {TW88I2CAddress,7, 0x61,0x5f, 0x64,0x00, 0x65,0x00, 0x66,0x00, 0x67,0x00, 0x68,0x00, 0x69,0x00, 0xff,0xff
             -},        // Black
                      {TW88I2CAddress,7, 0x61,0x00, 0x64,0xc0, 0x65,0xc0, 0x66,0xc0, 0x67,0x88, 0x68,0x88, 0x69,0x88, 0xff,0xff
             -}        // Gray scale
              };
              #endif // SUPPORT_PATTERN
1161          
1162          void AdjustAutoDayNight(BYTE val)
1163          {
1164   1      
1165   1              BYTE page;
1166   1              BYTE PWMLevelTemp;
1167   1              val=0xff-val;
1168   1      
1169   1              if(val>=0&&val<100)
1170   1                      PWMLevelTemp=0;
1171   1              else if(val>=100&&val<140)
1172   1                      PWMLevelTemp=20;
1173   1              else if(val>=140&&val<180)
1174   1                      PWMLevelTemp=50;
1175   1              else if(val>=180&&val<220)
1176   1                      PWMLevelTemp=90;
1177   1              else if(val>=220&&val<256)
1178   1                      {
1179   2                      #ifdef AWT
1180   2                      PWMLevelTemp=100;
1181   2                      #else
                              PWMLevelTemp=115;
                              #endif
1184   2                      }
1185   1              //else
1186   1              //      PWMLevelTemp=0;
1187   1              if(PWMLevel>PWMLevelTemp)
1188   1                      PWMLevel-=1;
1189   1              else if(PWMLevel<PWMLevelTemp)
1190   1                      PWMLevel+=1;
1191   1              
1192   1              //Printf("\r\nLADC0=%02x",(WORD)val);
1193   1              page = ReadTW88( 0xff );
1194   1              WriteTW88( 0xff, 0x00 );                // set page 0
1195   1              WriteTW88( 0xbe, ((ReadTW88(0xbe) & 0xcf) | 0x10) );    // set active Low control, if want active high clear
             - 
1196   1              //WriteTW88( 0xc4, ((ReadTW88(0xc4) & 0x80)|(val>>2)) );        // set pwm number
1197   1              WriteTW88( 0xc4, ((ReadTW88(0xc4) & 0x80)|(PWMLevel)) );        // set pwm number
1198   1              WriteTW88( 0xff, page );
1199   1      
1200   1      }
1201          
1202          void Hs_InitVars(void)
1203          {
1204   1              SEQFlag=0;
1205   1              SEQTime=0;
1206   1              TriggerMode=8;          //No_TRIG
1207   1              AccPowerDown=1;
1208   1      
1209   1      
1210   1      }
1211          
1212          void LoadEEPROM (void)
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 93  

1213          {
1214   1              BYTE val;
1215   1               PowerFlag = ReadEEP(EEP_Powerflag);
1216   1               SelectModeType = ReadEEP(EEP_SelectMode);
1217   1               NowModeState = ReadEEP(EEP_NowModeState);
1218   1               TimeStep = ReadEEP(EEP_TimeStep);
1219   1               Priority = ReadEEP(EEP_PRIORITY);       
1220   1               AutoDayNight= ReadEEP(EEP_AutoMode);
1221   1               PelcoChoiceFLAG = ReadEEP(EEP_PELCO);
1222   1               CAMNumber = ReadEEP(EEP_CAMNUMBER);  
1223   1               Baud_rate = ReadEEP(EEP_Baud_rate);
1224   1              
1225   1               val = ReadEEP(EEP_COSDMode);   //OSD ON & OFF               //william-980428                                                                                               
1226   1                 if(val==0)                                   
1227   1                 {
1228   2                        Attr_A|=0x02;  //*** BIT1: Channel OSD  set 1
1229   2                        Attr_B|=0x02;
1230   2                        Attr_C|=0x02;
1231   2                        Attr_R|=0x02;
1232   2                        //displayhold_flag=0;
1233   2                 }
1234   1                 
1235   1                 else                                                   
1236   1                 {
1237   2                        Attr_A&=0x0d;  //*** BIT1: Channel OSD  set 0
1238   2                        Attr_B&=0x0d;
1239   2                        Attr_C&=0x0d;
1240   2                        Attr_R&=0x0d;
1241   2                 }                                                                                      
1242   1              
1243   1                 val = ReadEEP(EEP_CAMAMode);   //CAM Mirror}]w                                                                                                                    
1244   1                 if(val==0)                                     //ON                          
1245   1                       Attr_A|=0x01;                            //*** BIT0: Horizontal Mirror  set 1
1246   1                 else                                                   //OFF                    
1247   1                       Attr_A&=0x0E;                            //*** BIT0: Horizontal Mirror  set 0
1248   1              
1249   1                 val = ReadEEP(EEP_CAMBMode);                                                                            
1250   1                 if(val==0)                                    //ON                      
1251   1                       Attr_B|=0x01;                           
1252   1                 else                                                  //OFF                                                    
1253   1                       Attr_B&=0x0E;             
1254   1              
1255   1                 val = ReadEEP(EEP_CAMCMode);                                                                                                                         
1256   1                 if(val==0)                                    //ON                                              
1257   1                       Attr_C|=0x01;                                            
1258   1                 else                                                  //OFF                                                   
1259   1                       Attr_C&=0x0E;                                   
1260   1              
1261   1                 val = ReadEEP(EEP_CAMRMode);                                                                                                                         
1262   1                 if(val==0)                                    //ON                                              
1263   1                       Attr_R|=0x01;                                            
1264   1                 else                                                  //OFF                                                   
1265   1                       Attr_R&=0x0E; 
1266   1                      
1267   1                      val=ReadEEP(EEP_CAMOutMode);
1268   1                      CAMOutDSel(val);             //]wCAMOut@   
1269   1      
1270   1                      
1271   1                      AudioVol = GetAudioVolEE();
1272   1                      PCAudioVol = GetPCAudioVolEE();
1273   1                      DVR_AudioRecord = ReadEEP(EEP_AudioRecord); 
1274   1                      DVRAodioSel(DVR_AudioRecord);
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 94  

1275   1      
1276   1                      
1277   1              //if(PowerFlag)
1278   1                      
1279   1      }
1280          
1281          void ACCPowerControl(void)
1282          {
1283   1      
1284   1      if(ACC_B==1 && AccPowerDown==1)
1285   1              {       
1286   2              Hs_DvrTxCmdPaser(Halt_Start);
1287   2              PowerDownStart=1;
1288   2              AccPowerDown=0;
1289   2      
1290   2              if(DVR_Ready==1)                        
1291   2                      {
1292   3                      if(PowerDownWait>29)
1293   3                              {
1294   4                              if(ACC_B==1)    
1295   4                                      {
1296   5                              #ifdef BJTSwitch        
                                              PPWR=0;
                                      #else
1299   5                                      PPWR=1;
1300   5                              #endif
1301   5                                      }
1302   4                              else
1303   4                                      {
1304   5                                      PowerDownStart=0;
1305   5                                      PowerDownWait=0;
1306   5                                      AccPowerDown=1;
1307   5                                      }               
1308   4                              }
1309   3                      }
1310   2              else
1311   2                      {
1312   3                      if(ACC_B==1)
1313   3                              {
1314   4                      #ifdef BJTSwitch        
                                      PPWR=0;
                              #else
1317   4                              PPWR=1;
1318   4                      #endif
1319   4                              }
1320   3                      else
1321   3                              {
1322   4                              PowerDownStart=0;
1323   4                              PowerDownWait=0;
1324   4                              AccPowerDown=1;
1325   4                              }
1326   3                      }
1327   2              }
1328   1      
1329   1      
1330   1      
1331   1      if(((PowerDownWait%10)==0) && PowerDownWait!=0)
1332   1              AccPowerDown=1;
1333   1      
1334   1      }
1335          
1336          
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 95  

1337                  //bit CCFL_status;      
1338          void main_loop(void)
1339          {
1340   1              //static bit AUTO_STATUS=0;
1341   1              BYTE val;
1342   1              
1343   1              TW2835Cmd("  \n\r");
1344   1      
1345   1              //ClearDataCnt(DVRStatus_ADDR,30);         
1346   1              //DrawAttrCnt(DVRStatus_ADDR, DEFAULT_COLOR, 30 ); 
1347   1              //InitOSDWindow(Init_Osd_DisplayDVRstatus);
1348   1      
1349   1              //---------------------------------------------------------------
1350   1              //                                   Main Loop
1351   1              //---------------------------------------------------------------
1352   1              while(1) {
1353   2                      
1354   2                      ACCPowerControl();
1355   2                      //Hs_DvrTxCmdPaser(GetDVRVersion);      
1356   2                      //-------------- Check Serial Port -----------------
1357   2                      #ifdef SERIAL
1358   2                      #ifdef Hs_debug
                              while( RS_ready() ) 
                                      Monitor();                              // for new monitor functions
                              #endif  
1362   2                              //DebugKeyIn( RS_rx() );        // Input - Serial Port
1363   2      
1364   2                      #endif // SERIAL
1365   2      
1366   2                      //if ( AccessEnable == 0 ) continue;
1367   2      
1368   2                      //-------------- Chip Manual Test  ---------------------
1369   2                      #ifdef CHIP_MANUAL_TEST
                              ChipManualTest();
                              #endif
1372   2                      
1373   2              #ifdef SUPPORT_SDCARD
1374   2                      if(RS2_in!=0 && !(GetDisplayedOSD() & MENU))
1375   2                              {
1376   3                              DvrReceivePaser();      
1377   3                              RS2_in=0;
1378   3                              }
1379   2                      
1380   2                      if(GetDVRStatusflag==1)
1381   2                              {
1382   3                              Hs_DvrTxCmdPaser(GetDVRStatus);
1383   3                              Hs_DvrTxCmdPaser(GetDVRParam);
1384   3                              Hs_DvrTxCmdPaser(GetDATETIME);
1385   3                              //Hs_DvrTxCmdPaser(GetDVRVersion);              
1386   3                              GetDVRStatusflag=0;
1387   3                              }
1388   2      
1389   2                      if(GetDATETIMEflag==1)
1390   2                      {
1391   3                              Hs_DvrTxCmdPaser(GetDATETIME);
1392   3                              GetDATETIMEflag=0;
1393   3                      }
1394   2      
1395   2                      if((GetDisplayedOSD() & INPUTINFO) && DVR_Ready==1)
1396   2                              DisplayDVRStatus();
1397   2              #endif
1398   2      
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 96  

1399   2                      //--------------Check Trigger ---------------------
1400   2              
1401   2                      val=CheckTrigger();
1402   2                      TriggerHandler(val);
1403   2      
1404   2                      //-------------- Check Key in --------------------------
1405   2      
1406   2                      if(TriggerFlag==0)                                       //Dku
1407   2                       { 
1408   3                              if(SEQFlag)                                             // SEQ Mode
1409   3                                 { 
1410   4                                        if(SEQTime>=TimeStep) 
1411   4                                              {
1412   5                                              SEQMode();
1413   5                                          SEQTime=0;
1414   5                                              }
1415   4                                      }
1416   3                               }
1417   2      
1418   2                      //--------------AUTO DAY & NIGHT-------------
1419   2                      if(AutoDayNight==0)
1420   2                      {
1421   3                              val=ReadDecoder(LADC0);
1422   3                              AdjustAutoDayNight(val);
1423   3                      }
1424   2                      
1425   2                      if( !CheckKeyIn() ) break;                      // POWEROFF
1426   2      
1427   2      
1428   2      
1429   2                      CheckAndClearOSD();
1430   2                      //============== Check each input status ===============
1431   2                      
1432   2                      switch ( GetInputSelection() ) {
1433   3      
1434   3                      case CH_TW2835:
1435   3                  case CH_CAMD:
1436   3                      case CH_AV:             
1437   3                              //----- Check Decoder ----------------
1438   3      
1439   3                              if(!( GetDisplayedOSD() & MENU ) )
1440   3                                      {               
1441   4                                              CheckDecoderInput();    
1442   4                                      }
1443   3                      
1444   3                              break;
1445   3      
1446   3                      #ifdef SUPPORT_PC
1447   3                      case PC:
1448   3                              //if ( AutoDetect == 0 ) break;
1449   3                              //----- Check PC input changed -------
1450   3                                      CheckPCinput();
1451   3                              break;
1452   3                      #endif
1453   3      
1454   3                      }
1455   2              if(CAM_PTZ_RUN_flag&&(P2_4&&P2_5&&P2_6&&P2_7))
1456   2              {
1457   3                      CAM_TxCommand_toRS485(CAM_PTZ_STOP);
1458   3                      CAM_PTZ_RUN_flag=0;
1459   3              }
1460   2              }
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 97  

1461   1      
1462   1      }
1463          
1464          void main(void)
1465          {
1466   1      BYTE i;
1467   1      WORD  TW2835Check=0;
1468   1      #ifdef BJTSwitch
                      PPWR=1;
              #else
1471   1              PPWR=0;
1472   1      #endif
1473   1              RS232Select=0;
1474   1              clrBacklight();
1475   1              Wait_ms(1000);
1476   1              TW88HWReset = 0;                        //TW88 HW reset by port pin, internal MCU no meaning
1477   1              Wait_ms(200);
1478   1              TW88HWReset = 0;        
1479   1              InitCPU();
1480   1      #ifdef Hs_debug
                      SetMonAddress(TW88I2CAddress);
              #endif
1483   1              InitVars();
1484   1              Hs_InitVars();
1485   1              InitTechwell();
1486   1              Hs_Protocol_Init();
1487   1              LCDPowerOFF();
1488   1              
1489   1              main_init();
1490   1              
1491   1      
1492   1      
1493   1              PowerUp = 0;
1494   1      
1495   1              //Wait_ms(3000);
1496   1              Wait_ms(400);
1497   1              //TW2835Cmd("\n\r");
1498   1              
1499   1              //TW2835Cmd("\n\rver\n\r");
1500   1      
1501   1      #if 0
              //WaitCnt=GetTime_ms();
              //while(abs(WaitCnt-GetTime_ms())<8000)
              while(TW2835Check==0)
              {
                      TW2835Cmd("\n\rver\n\r");
                      for(i=0;i<8;i++) 
                      {  
                              if(RS_buf2[i]=='A' /*&& DVR_buf[(i+1)]=='S'*/)
                              {
                               if( RS_buf2[i+1]=='C'  ) 
                                      {
                                      if( RS_buf2[i+2]=='K'  ) 
                                              TW2835Check=1;
                                       //break;
                                      }
                              }
                      }
              }       
              #endif
1521   1      
1522   1      
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 98  

1523   1              //Wait_ms(100);
1524   1              //TW2835Cmd("\n\rbusw 0 1 A1 11\n\r");
1525   1              //Wait_ms(100);
1526   1              //TW2835Cmd("\n\rbusw 0 1 A2 D7\n\r");  
1527   1              //Wait_ms(100);
1528   1              
1529   1      LoadEEPROM();
1530   1      //william-v1.1-991208
1531   1      #if 1
1532   1      for(i=0;i<20;i++) 
1533   1      {
1534   2              TW2835Check=TW2835Command(CAM_A,Attr_A,Attr_B,Attr_C,Attr_R);
1535   2              if(TW2835Check==TRUE)
1536   2                      break;
1537   2              Wait_ms(100);
1538   2      }
1539   1      #endif
1540   1              
1541   1              Wait_ms(1000);
1542   1         if(NowModeState==JumpMode && ReadEEP(EEP_JUMPMode)==14)                      //jump  VGA } AV out |T
1543   1              TW2835Cmd("\n\ravout 0\n\r");
1544   1              SetNowMode();
1545   1              ChangeVol(0);
1546   1      
1547   1      
1548   1      
1549   1              while(1) {
1550   2              if(PowerFlag)
1551   2                      main_loop();            //exit when power off
1552   2                      
1553   2                      PowerOff();
1554   2                      //AudioMute(0);
1555   2                      //PowerLED(OFF);
1556   2                      //clrBacklight();
1557   2                      //Wait_ms(100);
1558   2                      //Panel_Disable();
1559   2                      WaitPowerOn();
1560   2                      //ChangeInput( GetInputSelectionEE() );         //WILLIAM-981029
1561   2              }
1562   1      }
1563          
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 99  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com00BE (BEGIN)
0000         L?0191:
0000         L?0192:
0000 EF                MOV     A,R7
0001 75F011            MOV     B,#011H
0004 A4                MUL     AB
0005 2400        R     ADD     A,#LOW struct_InputSelection
0007 F582              MOV     DPL,A
0009 E4                CLR     A
000A 3400        R     ADDC    A,#HIGH struct_InputSelection
000C F583              MOV     DPH,A
000E E4                CLR     A
000F 93                MOVC    A,@A+DPTR
0010 22                RET     
0011         L?0194:
0011         L?0195:
0011 E4                CLR     A
0012 FB                MOV     R3,A
0013 7DFF              MOV     R5,#0FFH
0015 7F8A              MOV     R7,#08AH
0017 22                RET     
0018         L?0198:
0018         L?0199:
0018 900001            MOV     DPTR,#01H
001B 020000      E     LJMP    ?C?CLDOPTR
001E         L?0200:
001E E4                CLR     A
001F F500        R     MOV     IVF,A
0021 F500        R     MOV     IVF+01H,A
0023 F500        R     MOV     IHF+03H,A
0025 F500        R     MOV     IHF+02H,A
0027 22                RET     
             ; FUNCTION Com00BE (END)

             ; FUNCTION _I2CDeviceInitialize (BEGIN)
                                           ; SOURCE LINE # 281
0000 7800        R     MOV     R0,#LOW RegSet
0002 120000      E     LCALL   ?C?PSTPDATA
                                           ; SOURCE LINE # 282
                                           ; SOURCE LINE # 283
;---- Variable 'cnt' assigned to Register 'R6/R7' ----
0005 E4                CLR     A
0006 FE                MOV     R6,A
                                           ; SOURCE LINE # 286
0007 120000      E     LCALL   ?C?CLDPTR
000A 7800        R     MOV     R0,#LOW addr
000C F2                MOVX    @R0,A
                                           ; SOURCE LINE # 290
000D 120000      R     LCALL   L?0198
                                           ; SOURCE LINE # 291
0010 8025              SJMP    ?C0173
0012         ?C0001:
                                           ; SOURCE LINE # 293
0012 7800        R     MOV     R0,#LOW RegSet
0014 120000      E     LCALL   ?C?PLDPDATA
0017 120000      E     LCALL   ?C?CLDPTR
001A FF                MOV     R7,A
001B B4FF06            CJNE    A,#0FFH,?C0003
001E 120000      R     LCALL   L?0198
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 100 

0021 F4                CPL     A
0022 6020              JZ      ?C0002
0024         ?C0003:
                                           ; SOURCE LINE # 294
0024 7800        R     MOV     R0,#LOW index
0026 EF                MOV     A,R7
0027 F2                MOVX    @R0,A
0028 FD                MOV     R5,A
                                           ; SOURCE LINE # 295
0029 120000      R     LCALL   L?0199
002C 7800        R     MOV     R0,#LOW val
002E F2                MOVX    @R0,A
002F FB                MOV     R3,A
                                           ; SOURCE LINE # 296
0030 7800        R     MOV     R0,#LOW addr
0032 E2                MOVX    A,@R0
0033 FF                MOV     R7,A
0034 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 302
0037         ?C0173:
0037 7800        R     MOV     R0,#LOW RegSet+02H
0039 E2                MOVX    A,@R0
003A 2402              ADD     A,#02H
003C F2                MOVX    @R0,A
003D 18                DEC     R0
003E E2                MOVX    A,@R0
003F 3400              ADDC    A,#00H
0041 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 303
0042 80CE              SJMP    ?C0001
0044         ?C0002:
                                           ; SOURCE LINE # 304
0044 120000      R     LCALL   L?0194
0047 020000      E     LJMP    _WriteI2C
             ; FUNCTION _I2CDeviceInitialize (END)

             ; FUNCTION _InitVideoData (BEGIN)
                                           ; SOURCE LINE # 323
0000 7800        R     MOV     R0,#LOW src
0002 EF                MOV     A,R7
0003 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 335
0004 7BFF              MOV     R3,#0FFH
0006 7A00        E     MOV     R2,#HIGH NTSC_Regs
0008 7900        E     MOV     R1,#LOW NTSC_Regs
000A 120000      R     LCALL   _I2CDeviceInitialize
                                           ; SOURCE LINE # 336
000D 120000      R     LCALL   L?0194
0010 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 338
0013 7800        R     MOV     R0,#LOW src
0015 E2                MOVX    A,@R0
0016 24FE              ADD     A,#0FEH
0018 6013              JZ      ?C0007
001A 14                DEC     A
001B 6010              JZ      ?C0007
001D 24FD              ADD     A,#0FDH
001F 600C              JZ      ?C0007
0021 2406              ADD     A,#06H
0023 24F8              ADD     A,#0F8H
0025 5011              JNC     ?C0014
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 101 

0027 240A              ADD     A,#0AH
0029 600D              JZ      ?C0014
002B 8010              SJMP    ?C0005
                                           ; SOURCE LINE # 341
                                           ; SOURCE LINE # 351
002D         ?C0007:
                                           ; SOURCE LINE # 357
002D         ?C0174:
                                           ; SOURCE LINE # 358
                                           ; SOURCE LINE # 361
002D         ?C0175:
002D 7BFF              MOV     R3,#0FFH
002F 7A00        E     MOV     R2,#HIGH PAL_Regs
0031 7900        E     MOV     R1,#LOW PAL_Regs
0033 120000      R     LCALL   _I2CDeviceInitialize
                                           ; SOURCE LINE # 368
0036 8005              SJMP    ?C0005
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 378
                                           ; SOURCE LINE # 380
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 383
0038         ?C0014:
0038 7800        R     MOV     R0,#LOW src
003A 7401              MOV     A,#01H
003C F2                MOVX    @R0,A
                                           ; SOURCE LINE # 384
003D         ?C0005:
                                           ; SOURCE LINE # 386
003D 7800        R     MOV     R0,#LOW InputSelection
003F E2                MOVX    A,@R0
0040 B40511            CJNE    A,#05H,?C0015
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 388
0043 7800        R     MOV     R0,#LOW VInputStdDetectMode
0045 E2                MOVX    A,@R0
0046 7002              JNZ     ?C0016
0048 800A              SJMP    ?C0176
004A         ?C0016:
                                           ; SOURCE LINE # 389
004A 7800        R     MOV     R0,#LOW src
004C E2                MOVX    A,@R0
004D 14                DEC     A
004E FF                MOV     R7,A
004F 120000      E     LCALL   _ClearAutoDetectStd
                                           ; SOURCE LINE # 390
0052 8003              SJMP    ?C0018
0054         ?C0015:
                                           ; SOURCE LINE # 392
0054         ?C0176:
0054 120000      E     LCALL   SetAutoDetectStd
0057         ?C0018:
                                           ; SOURCE LINE # 398
0057 7B15              MOV     R3,#015H
0059 7D29              MOV     R5,#029H
005B 7F8A              MOV     R7,#08AH
005D 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 400
0060 7B06              MOV     R3,#06H
0062 7D5C              MOV     R5,#05CH
0064 7F8A              MOV     R7,#08AH
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 102 

0066 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 404
0069 7F0B              MOV     R7,#0BH
006B 7E00              MOV     R6,#00H
006D 120000      E     LCALL   _ReadEEP
0070 120000      E     LCALL   _SetVideoMode
                                           ; SOURCE LINE # 410
0073 120000      E     LCALL   GetWideModeEE
0076 020000      E     LJMP    _Set4WideScreen
             ; FUNCTION _InitVideoData (END)

             ; FUNCTION IsNoInput (BEGIN)
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
                                           ; SOURCE LINE # 418
0000 7D01              MOV     R5,#01H
0002 7F8A              MOV     R7,#08AH
0004 120000      E     LCALL   _ReadI2C
0007 EF                MOV     A,R7
0008 30E703            JNB     ACC.7,?C0020
000B 7F01              MOV     R7,#01H
000D 22                RET     
000E         ?C0020:
                                           ; SOURCE LINE # 419
000E 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 420
0010         ?C0021:
0010 22                RET     
             ; FUNCTION IsNoInput (END)

             ; FUNCTION CheckDecoderInput (BEGIN)
                                           ; SOURCE LINE # 510
                                           ; SOURCE LINE # 511
                                           ; SOURCE LINE # 654
0000 E4                CLR     A
0001 7800        R     MOV     R0,#LOW cnt
0003 F2                MOVX    @R0,A
0004 08                INC     R0
0005 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 663
0006 7800        R     MOV     R0,#LOW InputSelection
0008 E2                MOVX    A,@R0
0009 B40505            CJNE    A,#05H,?C0022
000C 7800        R     MOV     R0,#LOW VInputStdDetectMode
000E E2                MOVX    A,@R0
000F 7072              JNZ     ?C0023
0011         ?C0022:
                                           ; SOURCE LINE # 666
0011 E4                CLR     A
0012 7800        R     MOV     R0,#LOW std1
0014 F2                MOVX    @R0,A
0015         ?C0024:
                                           ; SOURCE LINE # 667
                                           ; SOURCE LINE # 668
0015 120000      E     LCALL   DetectDecoderInput
0018 7800        R     MOV     R0,#LOW std
001A EF                MOV     A,R7
001B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 672
001C 7800        R     MOV     R0,#LOW trycnt
001E E2                MOVX    A,@R0
001F 04                INC     A
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 103 

0020 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 673
0021 E2                MOVX    A,@R0
0022 C3                CLR     C
0023 94C8              SUBB    A,#0C8H
0025 505C              JNC     ?C0023
                                           ; SOURCE LINE # 674
0027         ?C0026:
                                           ; SOURCE LINE # 676
0027 7800        R     MOV     R0,#LOW std
0029 E2                MOVX    A,@R0
002A FF                MOV     R7,A
002B 64FE              XRL     A,#0FEH
002D 60E6              JZ      ?C0024
002F 7800        R     MOV     R0,#LOW VInputStd
0031 E2                MOVX    A,@R0
0032 FE                MOV     R6,A
0033 EF                MOV     A,R7
0034 6E                XRL     A,R6
0035 60DE              JZ      ?C0024
                                           ; SOURCE LINE # 677
                                           ; SOURCE LINE # 679
0037 7800        R     MOV     R0,#LOW std1
0039 E2                MOVX    A,@R0
003A FF                MOV     R7,A
003B 08                INC     R0
003C E2                MOVX    A,@R0
003D FE                MOV     R6,A
003E B50706            CJNE    A,AR7,?C0028
                                           ; SOURCE LINE # 680
0041 08                INC     R0
0042 E2                MOVX    A,@R0
0043 04                INC     A
0044 F2                MOVX    @R0,A
0045 8008              SJMP    ?C0029
0047         ?C0028:
                                           ; SOURCE LINE # 682
                                           ; SOURCE LINE # 683
0047 E4                CLR     A
0048 7800        R     MOV     R0,#LOW cnt
004A F2                MOVX    @R0,A
                                           ; SOURCE LINE # 684
004B 7800        R     MOV     R0,#LOW std1
004D EE                MOV     A,R6
004E F2                MOVX    @R0,A
                                           ; SOURCE LINE # 685
004F         ?C0029:
                                           ; SOURCE LINE # 687
004F 7800        R     MOV     R0,#LOW cnt
0051 E2                MOVX    A,@R0
0052 C3                CLR     C
0053 9402              SUBB    A,#02H
0055 40BE              JC      ?C0024
                                           ; SOURCE LINE # 693
0057 18                DEC     R0
0058 E2                MOVX    A,@R0
0059 FF                MOV     R7,A
005A 700A              JNZ     ?C0031
                                           ; SOURCE LINE # 694
                                           ; SOURCE LINE # 695
005C 120000      R     LCALL   _SetVInputStd
                                           ; SOURCE LINE # 696
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 104 

005F 7800        R     MOV     R0,#LOW ChangedNoinput
0061 7401              MOV     A,#01H
0063 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 697
0064 8018              SJMP    ?C0032
0066         ?C0031:
                                           ; SOURCE LINE # 698
0066 7800        R     MOV     R0,#LOW VInputStd
0068 E2                MOVX    A,@R0
0069 7800        R     MOV     R0,#LOW std
006B 7005              JNZ     ?C0033
                                           ; SOURCE LINE # 699
                                           ; SOURCE LINE # 700
                                           ; SOURCE LINE # 701
006D 120000      R     LCALL   L?0196
                                           ; SOURCE LINE # 702
                                           ; SOURCE LINE # 703
0070 8008              SJMP    ?C0177
0072         ?C0033:
                                           ; SOURCE LINE # 705
                                           ; SOURCE LINE # 709
                                           ; SOURCE LINE # 710
0072 120000      R     LCALL   L?0196
                                           ; SOURCE LINE # 711
0075 7F32              MOV     R7,#032H
0077 120000      E     LCALL   _delay
                                           ; SOURCE LINE # 713
007A         ?C0177:
007A E4                CLR     A
007B 7800        R     MOV     R0,#LOW ChangedNoinput
007D F2                MOVX    @R0,A
                                           ; SOURCE LINE # 714
007E         ?C0032:
                                           ; SOURCE LINE # 719
007E 7FFF              MOV     R7,#0FFH
0080 120000      E     LCALL   _delay
                                           ; SOURCE LINE # 723
                                           ; SOURCE LINE # 724
                                           ; SOURCE LINE # 725
                                           ; SOURCE LINE # 737
                                           ; SOURCE LINE # 743
0083         ?C0023:
0083 22                RET     
0084         L?0196:
0084 E2                MOVX    A,@R0
0085 FF                MOV     R7,A
0086 120000      R     LCALL   _SetVInputStd
0089 7800        R     MOV     R0,#LOW std
008B E2                MOVX    A,@R0
008C FF                MOV     R7,A
008D 120000      R     LCALL   _InitVideoData
0090 22                RET     
             ; FUNCTION CheckDecoderInput (END)

             ; FUNCTION ReadVInputSTD (BEGIN)
                                           ; SOURCE LINE # 745
                                           ; SOURCE LINE # 746
                                           ; SOURCE LINE # 749
0000 120000      R     LCALL   IsNoInput
0003 EF                MOV     A,R7
0004 6003              JZ      ?C0035
0006 7F01              MOV     R7,#01H
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 105 

0008 22                RET     
0009         ?C0035:
                                           ; SOURCE LINE # 751
0009 7D1C              MOV     R5,#01CH
000B 7F8A              MOV     R7,#08AH
000D 120000      E     LCALL   _ReadI2C
0010 EF                MOV     A,R7
0011 54F0              ANL     A,#0F0H
0013 FF                MOV     R7,A
;---- Variable 'std' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 752
0014 30E703            JNB     ACC.7,?C0037
0017 7F01              MOV     R7,#01H
0019 22                RET     
001A         ?C0037:
                                           ; SOURCE LINE # 754
001A EF                MOV     A,R7
001B 5470              ANL     A,#070H
001D C4                SWAP    A
001E 540F              ANL     A,#0FH
0020 04                INC     A
0021 FF                MOV     R7,A
                                           ; SOURCE LINE # 755
0022         ?C0036:
0022 22                RET     
             ; FUNCTION ReadVInputSTD (END)

             ; FUNCTION GetVInputStdInx (BEGIN)
                                           ; SOURCE LINE # 757
                                           ; SOURCE LINE # 758
                                           ; SOURCE LINE # 761
0000 120000      R     LCALL   ReadVInputSTD
;---- Variable 'std' assigned to Register 'R3' ----
0003 AB07              MOV     R3,AR7
                                           ; SOURCE LINE # 763
0005 EB                MOV     A,R3
0006 24FE              ADD     A,#0FEH
0008 6019              JZ      ?C0046
000A 14                DEC     A
000B 6016              JZ      ?C0046
000D 24FD              ADD     A,#0FDH
000F 6012              JZ      ?C0046
0011 2402              ADD     A,#02H
0013 24FC              ADD     A,#0FCH
0015 5004              JNC     ?C0043
0017 2407              ADD     A,#07H
0019 7017              JNZ     ?C0047
                                           ; SOURCE LINE # 765
                                           ; SOURCE LINE # 766
                                           ; SOURCE LINE # 767
                                           ; SOURCE LINE # 768
001B         ?C0043:
001B 750000      R     MOV     IVF,#00H
001E 75003C      R     MOV     IVF+01H,#03CH
0021 8006              SJMP    ?C0178
                                           ; SOURCE LINE # 770
                                           ; SOURCE LINE # 771
                                           ; SOURCE LINE # 772
0023         ?C0046:
0023 750000      R     MOV     IVF,#00H
0026 750032      R     MOV     IVF+01H,#032H
0029         ?C0178:
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 106 

0029 E4                CLR     A
002A 75006B      R     MOV     IHF+03H,#06BH
002D 75003D      R     MOV     IHF+02H,#03DH
0030 8003              SJMP    ?C0179
                                           ; SOURCE LINE # 773
0032         ?C0047:
0032 120000      R     LCALL   L?0200
0035         ?C0179:
0035 F500        R     MOV     IHF+01H,A
0037 F500        R     MOV     IHF,A
                                           ; SOURCE LINE # 774
0039         ?C0039:
                                           ; SOURCE LINE # 776
;---- Variable 'i' assigned to Register 'R7' ----
0039 E4                CLR     A
003A FF                MOV     R7,A
003B         ?C0048:
                                           ; SOURCE LINE # 777
003B EF                MOV     A,R7
003C 75F011            MOV     B,#011H
003F A4                MUL     AB
0040 2400        R     ADD     A,#LOW struct_VInputStd
0042 F582              MOV     DPL,A
0044 E4                CLR     A
0045 3400        R     ADDC    A,#HIGH struct_VInputStd
0047 F583              MOV     DPH,A
0049 E4                CLR     A
004A 93                MOVC    A,@A+DPTR
004B FE                MOV     R6,A
004C B50301            CJNE    A,AR3,?C0051
                                           ; SOURCE LINE # 778
004F 22                RET     
0050         ?C0051:
                                           ; SOURCE LINE # 779
0050 EE                MOV     A,R6
0051 6003              JZ      ?C0049
                                           ; SOURCE LINE # 780
                                           ; SOURCE LINE # 781
0053         ?C0050:
0053 0F                INC     R7
0054 80E5              SJMP    ?C0048
0056         ?C0049:
                                           ; SOURCE LINE # 782
0056 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 783
0058         ?C0052:
0058 22                RET     
             ; FUNCTION GetVInputStdInx (END)

             ; FUNCTION GetVInputStd (BEGIN)
                                           ; SOURCE LINE # 786
                                           ; SOURCE LINE # 787
                                           ; SOURCE LINE # 788
0000 7800        R     MOV     R0,#LOW VInputStd
0002 E2                MOVX    A,@R0
0003 FF                MOV     R7,A
                                           ; SOURCE LINE # 789
0004         ?C0054:
0004 22                RET     
             ; FUNCTION GetVInputStd (END)

             ; FUNCTION _SetVInputStd (BEGIN)
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 107 

                                           ; SOURCE LINE # 792
;---- Variable 'newd' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 793
                                           ; SOURCE LINE # 794
0000 7800        R     MOV     R0,#LOW VInputStd
0002 EF                MOV     A,R7
0003 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 801
0004 24FE              ADD     A,#0FEH
0006 6019              JZ      ?C0062
0008 14                DEC     A
0009 6016              JZ      ?C0062
000B 24FD              ADD     A,#0FDH
000D 6012              JZ      ?C0062
000F 2402              ADD     A,#02H
0011 24FC              ADD     A,#0FCH
0013 5004              JNC     ?C0059
0015 2407              ADD     A,#07H
0017 7017              JNZ     ?C0063
                                           ; SOURCE LINE # 804
                                           ; SOURCE LINE # 807
                                           ; SOURCE LINE # 810
                                           ; SOURCE LINE # 812
0019         ?C0059:
0019 750000      R     MOV     IVF,#00H
001C 75003C      R     MOV     IVF+01H,#03CH
001F 8006              SJMP    ?C0180
                                           ; SOURCE LINE # 815
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 821
0021         ?C0062:
0021 750000      R     MOV     IVF,#00H
0024 750032      R     MOV     IVF+01H,#032H
0027         ?C0180:
0027 E4                CLR     A
0028 75006B      R     MOV     IHF+03H,#06BH
002B 75003D      R     MOV     IHF+02H,#03DH
002E 8003              SJMP    ?C0181
                                           ; SOURCE LINE # 824
0030         ?C0063:
0030 120000      R     LCALL   L?0200
0033         ?C0181:
0033 F500        R     MOV     IHF+01H,A
0035 F500        R     MOV     IHF,A
                                           ; SOURCE LINE # 825
                                           ; SOURCE LINE # 826
0037         ?C0064:
0037 22                RET     
             ; FUNCTION _SetVInputStd (END)

             ; FUNCTION GetInputSelection (BEGIN)
                                           ; SOURCE LINE # 828
                                           ; SOURCE LINE # 829
                                           ; SOURCE LINE # 830
0000 7800        R     MOV     R0,#LOW InputSelection
0002 E2                MOVX    A,@R0
0003 FF                MOV     R7,A
                                           ; SOURCE LINE # 831
0004         ?C0065:
0004 22                RET     
             ; FUNCTION GetInputSelection (END)

C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 108 

             ; FUNCTION GetNextInputSelection (BEGIN)
                                           ; SOURCE LINE # 833
                                           ; SOURCE LINE # 834
                                           ; SOURCE LINE # 837
;---- Variable 'i' assigned to Register 'R7' ----
0000 7F01              MOV     R7,#01H
0002         ?C0066:
                                           ; SOURCE LINE # 838
0002 120000      R     LCALL   L?0191
0005 FE                MOV     R6,A
0006 7800        R     MOV     R0,#LOW InputSelection
0008 E2                MOVX    A,@R0
0009 FD                MOV     R5,A
000A EE                MOV     A,R6
000B 6D                XRL     A,R5
000C 6003              JZ      ?C0067
000E         ?C0068:
000E 0F                INC     R7
000F 80F1              SJMP    ?C0066
0011         ?C0067:
                                           ; SOURCE LINE # 839
0011 0F                INC     R7
                                           ; SOURCE LINE # 840
0012 120000      R     LCALL   L?0191
0015 7002              JNZ     ?C0070
0017 7F01              MOV     R7,#01H
0019         ?C0070:
                                           ; SOURCE LINE # 842
0019 120000      R     LCALL   L?0192
001C FF                MOV     R7,A
                                           ; SOURCE LINE # 843
001D         ?C0071:
001D 22                RET     
             ; FUNCTION GetNextInputSelection (END)

             ; FUNCTION PowerDown_XTAL (BEGIN)
                                           ; SOURCE LINE # 845
                                           ; SOURCE LINE # 846
                                           ; SOURCE LINE # 847
0000 300003      R     JNB     flag,?C0072
0003 D2B7              SETB    P3_7
0005 22                RET     
0006         ?C0072:
                                           ; SOURCE LINE # 848
0006 C2B7              CLR     P3_7
                                           ; SOURCE LINE # 849
0008         ?C0074:
0008 22                RET     
             ; FUNCTION PowerDown_XTAL (END)

             ; FUNCTION _Audio_Select (BEGIN)
                                           ; SOURCE LINE # 851
;---- Variable 'flag' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 852
                                           ; SOURCE LINE # 853
0000 EF                MOV     A,R7
0001 14                DEC     A
0002 6012              JZ      ?C0077
0004 14                DEC     A
0005 6017              JZ      ?C0078
0007 14                DEC     A
0008 601C              JZ      ?C0079
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 109 

000A 2403              ADD     A,#03H
000C 7021              JNZ     ?C0080
                                           ; SOURCE LINE # 854
                                           ; SOURCE LINE # 855
000E         ?C0076:
                                           ; SOURCE LINE # 856
000E 7BFF              MOV     R3,#0FFH
0010 7A00        R     MOV     R2,#HIGH ?SC_0
0012 7900        R     MOV     R1,#LOW ?SC_0
                                           ; SOURCE LINE # 857
0014 8016              SJMP    ?C0184
                                           ; SOURCE LINE # 858
0016         ?C0077:
                                           ; SOURCE LINE # 859
0016 7BFF              MOV     R3,#0FFH
0018 7A00        R     MOV     R2,#HIGH ?SC_18
001A 7900        R     MOV     R1,#LOW ?SC_18
001C         ?C0182:
                                           ; SOURCE LINE # 860
001C 800E              SJMP    ?C0184
                                           ; SOURCE LINE # 861
001E         ?C0078:
                                           ; SOURCE LINE # 862
001E 7BFF              MOV     R3,#0FFH
0020 7A00        R     MOV     R2,#HIGH ?SC_36
0022 7900        R     MOV     R1,#LOW ?SC_36
0024         ?C0183:
                                           ; SOURCE LINE # 863
0024 8006              SJMP    ?C0184
                                           ; SOURCE LINE # 864
0026         ?C0079:
                                           ; SOURCE LINE # 865
0026 7BFF              MOV     R3,#0FFH
0028 7A00        R     MOV     R2,#HIGH ?SC_54
002A 7900        R     MOV     R1,#LOW ?SC_54
002C         ?C0184:
002C 120000      E     LCALL   _Puts
                                           ; SOURCE LINE # 866
                                           ; SOURCE LINE # 867
                                           ; SOURCE LINE # 869
002F         ?C0080:
002F 22                RET     
             ; FUNCTION _Audio_Select (END)

             ; FUNCTION _ChangeInput (BEGIN)
                                           ; SOURCE LINE # 870
0000 7800        R     MOV     R0,#LOW newsel
0002 EF                MOV     A,R7
0003 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 871
                                           ; SOURCE LINE # 882
0004 7800        R     MOV     R0,#LOW InputSelection
0006 E2                MOVX    A,@R0
0007 6F                XRL     A,R7
0008 7003              JNZ     $ + 5H
000A 020000      R     LJMP    ?C0082
000D         ?C0081:
                                           ; SOURCE LINE # 885
000D 120000      E     LCALL   ClearOSDInfo
                                           ; SOURCE LINE # 887
0010 120000      E     LCALL   LCDPowerOFF
                                           ; SOURCE LINE # 892
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 110 

0013 7800        R     MOV     R0,#LOW newsel
0015 E2                MOVX    A,@R0
0016 7800        R     MOV     R0,#LOW InputSelection
0018 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 902
0019 7800        R     MOV     R0,#LOW VInputStd
001B E2                MOVX    A,@R0
001C FF                MOV     R7,A
001D 120000      R     LCALL   _InitVideoData
                                           ; SOURCE LINE # 904
0020 7800        R     MOV     R0,#LOW InputSelection
0022 E2                MOVX    A,@R0
0023 14                DEC     A
0024 6027              JZ      ?C0085
0026 14                DEC     A
0027 6030              JZ      ?C0086
0029 14                DEC     A
002A 6039              JZ      ?C0087
002C 24FC              ADD     A,#0FCH
002E 7044              JNZ     ?C0083
                                           ; SOURCE LINE # 907
0030         ?C0084:
                                           ; SOURCE LINE # 909
0030 120000      E     LCALL   AVGAInput
                                           ; SOURCE LINE # 910
0033 120000      E     LCALL   AutoPHPCalDisable
                                           ; SOURCE LINE # 911
0036 E4                CLR     A
0037 F500        E     MOV     tic_pc,A
0039 F500        E     MOV     tic_pc+01H,A
                                           ; SOURCE LINE # 912
003B 7F01              MOV     R7,#01H
003D 120000      E     LCALL   _DetectAndSetForVGAInput
0040 7800        R     MOV     R0,#LOW ret
0042 EF                MOV     A,R7
0043 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 913
0044 7F02              MOV     R7,#02H
0046 120000      R     LCALL   _Audio_Select
                                           ; SOURCE LINE # 914
0049 D200        E     SETB    VGAAudio
                                           ; SOURCE LINE # 915
                                           ; SOURCE LINE # 920
004B 8022              SJMP    ?C0187
                                           ; SOURCE LINE # 924
004D         ?C0085:
                                           ; SOURCE LINE # 925
004D 120000      E     LCALL   COMPOSITE1Input
                                           ; SOURCE LINE # 927
0050 E4                CLR     A
0051 FF                MOV     R7,A
0052 120000      R     LCALL   _Audio_Select
                                           ; SOURCE LINE # 928
0055 C200        E     CLR     VGAAudio
                                           ; SOURCE LINE # 929
0057         ?C0185:
                                           ; SOURCE LINE # 932
0057 8016              SJMP    ?C0187
                                           ; SOURCE LINE # 933
0059         ?C0086:
                                           ; SOURCE LINE # 934
0059 120000      E     LCALL   COMPOSITE2Input
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 111 

                                           ; SOURCE LINE # 935
005C 7F01              MOV     R7,#01H
005E 120000      R     LCALL   _Audio_Select
                                           ; SOURCE LINE # 936
0061 C200        E     CLR     VGAAudio
                                           ; SOURCE LINE # 937
0063         ?C0186:
                                           ; SOURCE LINE # 940
0063 800A              SJMP    ?C0187
                                           ; SOURCE LINE # 941
0065         ?C0087:
                                           ; SOURCE LINE # 942
0065 120000      E     LCALL   COMPOSITE3Input
                                           ; SOURCE LINE # 943
0068 7F02              MOV     R7,#02H
006A 120000      R     LCALL   _Audio_Select
                                           ; SOURCE LINE # 944
006D C200        E     CLR     VGAAudio
                                           ; SOURCE LINE # 945
006F         ?C0187:
006F E4                CLR     A
0070 FF                MOV     R7,A
0071 120000      E     LCALL   _ChangeVol
                                           ; SOURCE LINE # 948
                                           ; SOURCE LINE # 950
0074         ?C0083:
                                           ; SOURCE LINE # 951
0074 120000      E     LCALL   CheckPanelImage
                                           ; SOURCE LINE # 952
0077 7800        R     MOV     R0,#LOW InputSelection
0079 E2                MOVX    A,@R0
007A FF                MOV     R7,A
007B 120000      E     LCALL   _SaveInputSelectionEE
                                           ; SOURCE LINE # 963
007E 7800        R     MOV     R0,#LOW InputSelection
0080 E2                MOVX    A,@R0
0081 FF                MOV     R7,A
0082 6407              XRL     A,#07H
0084 6005              JZ      ?C0089
0086 EF                MOV     A,R7
0087 6404              XRL     A,#04H
0089 703C              JNZ     ?C0088
008B         ?C0089:
                                           ; SOURCE LINE # 964
008B 7800        R     MOV     R0,#LOW ret
008D E2                MOVX    A,@R0
008E 6401              XRL     A,#01H
0090 7040              JNZ     ?C0188
                                           ; SOURCE LINE # 965
0092 7D06              MOV     R5,#06H
0094 7F8A              MOV     R7,#08AH
0096 120000      E     LCALL   _ReadI2C
0099 7800        R     MOV     R0,#LOW ret
009B EF                MOV     A,R7
009C F2                MOVX    @R0,A
                                           ; SOURCE LINE # 966
009D 4480              ORL     A,#080H
009F F2                MOVX    @R0,A
00A0 FB                MOV     R3,A
                                           ; SOURCE LINE # 967
00A1 7D06              MOV     R5,#06H
00A3 7F8A              MOV     R7,#08AH
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 112 

00A5 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 968
00A8 7F1E              MOV     R7,#01EH
00AA 120000      E     LCALL   _delay
                                           ; SOURCE LINE # 969
00AD 7B01              MOV     R3,#01H
00AF 7DFF              MOV     R5,#0FFH
00B1 7F8A              MOV     R7,#08AH
00B3 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 970
00B6 7B01              MOV     R3,#01H
00B8 7DCD              MOV     R5,#0CDH
00BA 7F8A              MOV     R7,#08AH
00BC 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 971
00BF 120000      R     LCALL   L?0195
00C2 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 973
00C5 8008              SJMP    ?C0092
                                           ; SOURCE LINE # 981
                                           ; SOURCE LINE # 983
00C7         ?C0088:
                                           ; SOURCE LINE # 986
                                           ; SOURCE LINE # 997
                                           ; SOURCE LINE # 998
00C7 7F1E              MOV     R7,#01EH
00C9 120000      E     LCALL   _delay
                                           ; SOURCE LINE # 999
00CC 120000      R     LCALL   CheckDecoderInput
                                           ; SOURCE LINE # 1000
                                           ; SOURCE LINE # 1010
00CF         ?C0092:
                                           ; SOURCE LINE # 1018
00CF 120000      E     LCALL   DisplayInput
                                           ; SOURCE LINE # 1019
00D2         ?C0188:
00D2 E4                CLR     A
00D3 FF                MOV     R7,A
00D4 120000      E     LCALL   _LCDPowerON
                                           ; SOURCE LINE # 1021
00D7 7F64              MOV     R7,#064H
00D9 120000      E     LCALL   _delay
                                           ; SOURCE LINE # 1022
00DC 7BFF              MOV     R3,#0FFH
00DE 7DD0              MOV     R5,#0D0H
00E0 7F8A              MOV     R7,#08AH
00E2 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 1023
00E5 7BFF              MOV     R3,#0FFH
00E7 7DD1              MOV     R5,#0D1H
00E9 7F8A              MOV     R7,#08AH
00EB 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 1024
00EE         ?C0082:
00EE 22                RET     
             ; FUNCTION _ChangeInput (END)

             ; FUNCTION PowerOff (BEGIN)
                                           ; SOURCE LINE # 1026
                                           ; SOURCE LINE # 1027
                                           ; SOURCE LINE # 1028
0000 7BFF              MOV     R3,#0FFH
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 113 

0002 7A00        R     MOV     R2,#HIGH ?SC_72
0004 7900        R     MOV     R1,#LOW ?SC_72
0006 120000      E     LCALL   _Printf
                                           ; SOURCE LINE # 1032
0009 C200        E     CLR     ?AudioMute?BIT
000B 120000      E     LCALL   AudioMute
                                           ; SOURCE LINE # 1033
000E 120000      E     LCALL   ClearOSDInfo
                                           ; SOURCE LINE # 1034
0011 120000      E     LCALL   LCDPowerOFF
                                           ; SOURCE LINE # 1035
0014 E4                CLR     A
0015 FF                MOV     R7,A
0016 020000      E     LJMP    _PowerLED
             ; FUNCTION PowerOff (END)

             ; FUNCTION WaitPowerOn (BEGIN)
                                           ; SOURCE LINE # 1038
                                           ; SOURCE LINE # 1039
                                           ; SOURCE LINE # 1042
0000 E4                CLR     A
0001 7800        R     MOV     R0,#LOW VGATrigger
0003 F2                MOVX    @R0,A
0004         ?C0094:
                                           ; SOURCE LINE # 1045
                                           ; SOURCE LINE # 1046
                                           ; SOURCE LINE # 1047
0004 120000      R     LCALL   ACCPowerControl
                                           ; SOURCE LINE # 1048
0007 E500        E     MOV     A,RS2_in
0009 600D              JZ      ?C0096
000B 120000      E     LCALL   GetDisplayedOSD
000E EF                MOV     A,R7
000F 20E106            JB      ACC.1,?C0096
                                           ; SOURCE LINE # 1049
                                           ; SOURCE LINE # 1050
0012 120000      E     LCALL   DvrReceivePaser
                                           ; SOURCE LINE # 1051
0015 E4                CLR     A
0016 F500        E     MOV     RS2_in,A
                                           ; SOURCE LINE # 1052
0018         ?C0096:
                                           ; SOURCE LINE # 1054
0018 300011      E     JNB     GetDVRStatusflag,?C0097
                                           ; SOURCE LINE # 1055
                                           ; SOURCE LINE # 1056
001B 7F05              MOV     R7,#05H
001D 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1057
0020 7F04              MOV     R7,#04H
0022 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1058
0025 7F06              MOV     R7,#06H
0027 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1060
002A C200        E     CLR     GetDVRStatusflag
                                           ; SOURCE LINE # 1061
002C         ?C0097:
                                           ; SOURCE LINE # 1064
002C 120000      E     LCALL   CheckTrigger
002F 7800        R     MOV     R0,#LOW val
0031 EF                MOV     A,R7
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 114 

0032 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1065
0033 6023              JZ      ?C0098
                                           ; SOURCE LINE # 1066
                                           ; SOURCE LINE # 1067
0035 E2                MOVX    A,@R0
0036 FF                MOV     R7,A
0037 120000      E     LCALL   _TriggerHandler
                                           ; SOURCE LINE # 1068
003A 7800        E     MOV     R0,#LOW TriggerMode
003C E2                MOVX    A,@R0
003D B4080C            CJNE    A,#08H,?C0100
0040 7FBA              MOV     R7,#0BAH
0042 7E00              MOV     R6,#00H
0044 120000      E     LCALL   _ReadEEP
0047 EF                MOV     A,R7
0048 6401              XRL     A,#01H
004A 601B              JZ      ?C0101
004C         ?C0100:
                                           ; SOURCE LINE # 1069
                                           ; SOURCE LINE # 1070
004C E4                CLR     A
004D FF                MOV     R7,A
004E 120000      E     LCALL   _LCDPowerON
                                           ; SOURCE LINE # 1071
0051 D200        E     SETB    ?AudioMute?BIT
0053 120000      E     LCALL   AudioMute
                                           ; SOURCE LINE # 1072
                                           ; SOURCE LINE # 1073
0056 800F              SJMP    ?C0101
0058         ?C0098:
                                           ; SOURCE LINE # 1075
                                           ; SOURCE LINE # 1076
0058 120000      R     LCALL   PowerOff
                                           ; SOURCE LINE # 1077
005B C200        E     CLR     ?AudioMute?BIT
005D 120000      E     LCALL   AudioMute
                                           ; SOURCE LINE # 1082
0060 7800        R     MOV     R0,#LOW val
0062 E2                MOVX    A,@R0
0063 FF                MOV     R7,A
0064 120000      E     LCALL   _TriggerHandler
                                           ; SOURCE LINE # 1084
0067         ?C0101:
                                           ; SOURCE LINE # 1086
0067 7800        E     MOV     R0,#LOW TriggerMode
0069 E2                MOVX    A,@R0
006A B4060C            CJNE    A,#06H,?C0102
                                           ; SOURCE LINE # 1087
                                           ; SOURCE LINE # 1088
006D 7401              MOV     A,#01H
                                           ; SOURCE LINE # 1089
006F 120000      R     LCALL   L?0197
                                           ; SOURCE LINE # 1090
0072 7800        R     MOV     R0,#LOW VGATrigger
0074 7401              MOV     A,#01H
0076 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1092
0077 8020              SJMP    ?C0095
                                           ; SOURCE LINE # 1093
0079         ?C0102:
                                           ; SOURCE LINE # 1095
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 115 

0079 E4                CLR     A
007A FF                MOV     R7,A
007B 120000      E     LCALL   _GetKey
007E 7800        R     MOV     R0,#LOW ikey
0080 EF                MOV     A,R7
0081 F2                MOVX    @R0,A
0082 6080              JZ      ?C0094
                                           ; SOURCE LINE # 1097
0084 E2                MOVX    A,@R0
0085 6404              XRL     A,#04H
0087 6003              JZ      $ + 5H
0089 020000      R     LJMP    ?C0094
008C 120000      E     LCALL   CheckTrigger
008F EF                MOV     A,R7
0090 6003              JZ      $ + 5H
0092 020000      R     LJMP    ?C0094
                                           ; SOURCE LINE # 1098
                                           ; SOURCE LINE # 1099
0095 04                INC     A
                                           ; SOURCE LINE # 1100
0096 120000      R     LCALL   L?0197
                                           ; SOURCE LINE # 1101
                                           ; SOURCE LINE # 1102
                                           ; SOURCE LINE # 1104
                                           ; SOURCE LINE # 1113
0099         ?C0095:
                                           ; SOURCE LINE # 1120
0099 7F01              MOV     R7,#01H
009B 120000      E     LCALL   _PowerLED
                                           ; SOURCE LINE # 1121
009E D200        E     SETB    ?AudioMute?BIT
00A0 120000      E     LCALL   AudioMute
                                           ; SOURCE LINE # 1128
00A3 7800        R     MOV     R0,#LOW SelectModeType
00A5 E2                MOVX    A,@R0
00A6 B40104            CJNE    A,#01H,?C0105
                                           ; SOURCE LINE # 1129
00A9 E4                CLR     A
00AA 7800        E     MOV     R0,#LOW cLastSyncLoss
00AC F2                MOVX    @R0,A
00AD         ?C0105:
                                           ; SOURCE LINE # 1130
00AD E4                CLR     A
00AE FF                MOV     R7,A
00AF 120000      E     LCALL   _LCDPowerON
                                           ; SOURCE LINE # 1131
00B2 7800        R     MOV     R0,#LOW VGATrigger
00B4 E2                MOVX    A,@R0
00B5 7003              JNZ     ?C0107
                                           ; SOURCE LINE # 1132
00B7 120000      E     LCALL   DisplayInput
                                           ; SOURCE LINE # 1135
00BA         ?C0107:
00BA 22                RET     
00BB         L?0197:
00BB 7800        R     MOV     R0,#LOW PowerFlag
00BD F2                MOVX    @R0,A
00BE FD                MOV     R5,A
00BF 7FAB              MOV     R7,#0ABH
00C1 7E00              MOV     R6,#00H
00C3 120000      E     LCALL   _WriteEEP
00C6 22                RET     
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 116 

             ; FUNCTION WaitPowerOn (END)

             ; FUNCTION SetOSDLastKeyInTime (BEGIN)
                                           ; SOURCE LINE # 1137
                                           ; SOURCE LINE # 1138
                                           ; SOURCE LINE # 1139
0000 120000      E     LCALL   GetTime_ms
0003 7800        R     MOV     R0,#LOW OSDLastKeyInTime
0005 EE                MOV     A,R6
0006 F2                MOVX    @R0,A
0007 08                INC     R0
0008 EF                MOV     A,R7
0009 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1140
000A 22                RET     
             ; FUNCTION SetOSDLastKeyInTime (END)

             ; FUNCTION GetOSDLastKeyInTime (BEGIN)
                                           ; SOURCE LINE # 1142
                                           ; SOURCE LINE # 1143
                                           ; SOURCE LINE # 1144
0000 7800        R     MOV     R0,#LOW OSDLastKeyInTime
0002 E2                MOVX    A,@R0
0003 FE                MOV     R6,A
0004 08                INC     R0
0005 E2                MOVX    A,@R0
0006 FF                MOV     R7,A
                                           ; SOURCE LINE # 1145
0007         ?C0109:
0007 22                RET     
             ; FUNCTION GetOSDLastKeyInTime (END)

             ; FUNCTION _AdjustAutoDayNight (BEGIN)
                                           ; SOURCE LINE # 1162
;---- Variable 'val' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1163
                                           ; SOURCE LINE # 1167
0000 C3                CLR     C
0001 74FF              MOV     A,#0FFH
0003 9F                SUBB    A,R7
0004 FF                MOV     R7,A
                                           ; SOURCE LINE # 1169
0005 C3                CLR     C
0006 9400              SUBB    A,#00H
0008 400B              JC      ?C0110
000A EF                MOV     A,R7
000B 9464              SUBB    A,#064H
000D 5006              JNC     ?C0110
                                           ; SOURCE LINE # 1170
000F E4                CLR     A
0010 7800        R     MOV     R0,#LOW PWMLevelTemp
0012 F2                MOVX    @R0,A
0013 8047              SJMP    ?C0111
0015         ?C0110:
                                           ; SOURCE LINE # 1171
0015 EF                MOV     A,R7
0016 C3                CLR     C
0017 9464              SUBB    A,#064H
0019 400C              JC      ?C0112
001B EF                MOV     A,R7
001C 948C              SUBB    A,#08CH
001E 5007              JNC     ?C0112
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 117 

                                           ; SOURCE LINE # 1172
0020 7800        R     MOV     R0,#LOW PWMLevelTemp
0022 7414              MOV     A,#014H
0024 F2                MOVX    @R0,A
0025 8035              SJMP    ?C0111
0027         ?C0112:
                                           ; SOURCE LINE # 1173
0027 EF                MOV     A,R7
0028 C3                CLR     C
0029 948C              SUBB    A,#08CH
002B 400C              JC      ?C0114
002D EF                MOV     A,R7
002E 94B4              SUBB    A,#0B4H
0030 5007              JNC     ?C0114
                                           ; SOURCE LINE # 1174
0032 7800        R     MOV     R0,#LOW PWMLevelTemp
0034 7432              MOV     A,#032H
0036 F2                MOVX    @R0,A
0037 8023              SJMP    ?C0111
0039         ?C0114:
                                           ; SOURCE LINE # 1175
0039 EF                MOV     A,R7
003A C3                CLR     C
003B 94B4              SUBB    A,#0B4H
003D 400C              JC      ?C0116
003F EF                MOV     A,R7
0040 94DC              SUBB    A,#0DCH
0042 5007              JNC     ?C0116
                                           ; SOURCE LINE # 1176
0044 7800        R     MOV     R0,#LOW PWMLevelTemp
0046 745A              MOV     A,#05AH
0048 F2                MOVX    @R0,A
0049 8011              SJMP    ?C0111
004B         ?C0116:
                                           ; SOURCE LINE # 1177
004B EF                MOV     A,R7
004C C3                CLR     C
004D 94DC              SUBB    A,#0DCH
004F 400B              JC      ?C0111
0051 7480              MOV     A,#080H
0053 9481              SUBB    A,#081H
0055 5005              JNC     ?C0111
                                           ; SOURCE LINE # 1178
                                           ; SOURCE LINE # 1180
0057 7800        R     MOV     R0,#LOW PWMLevelTemp
0059 7464              MOV     A,#064H
005B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1184
005C         ?C0111:
                                           ; SOURCE LINE # 1187
005C 7800        R     MOV     R0,#LOW PWMLevelTemp
005E E2                MOVX    A,@R0
005F FF                MOV     R7,A
0060 E500        R     MOV     A,PWMLevel
0062 D3                SETB    C
0063 9F                SUBB    A,R7
0064 4004              JC      ?C0119
                                           ; SOURCE LINE # 1188
0066 1500        R     DEC     PWMLevel
0068 8008              SJMP    ?C0120
006A         ?C0119:
                                           ; SOURCE LINE # 1189
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 118 

006A E500        R     MOV     A,PWMLevel
006C C3                CLR     C
006D 9F                SUBB    A,R7
006E 5002              JNC     ?C0120
                                           ; SOURCE LINE # 1190
0070 0500        R     INC     PWMLevel
0072         ?C0120:
                                           ; SOURCE LINE # 1193
0072 7DFF              MOV     R5,#0FFH
0074 7F8A              MOV     R7,#08AH
0076 120000      E     LCALL   _ReadI2C
0079 7800        R     MOV     R0,#LOW page
007B EF                MOV     A,R7
007C F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1194
007D 120000      R     LCALL   L?0195
0080 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 1195
0083 7DBE              MOV     R5,#0BEH
0085 7F8A              MOV     R7,#08AH
0087 120000      E     LCALL   _ReadI2C
008A EF                MOV     A,R7
008B 54CF              ANL     A,#0CFH
008D 4410              ORL     A,#010H
008F FB                MOV     R3,A
0090 7DBE              MOV     R5,#0BEH
0092 7F8A              MOV     R7,#08AH
0094 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 1197
0097 7DC4              MOV     R5,#0C4H
0099 7F8A              MOV     R7,#08AH
009B 120000      E     LCALL   _ReadI2C
009E EF                MOV     A,R7
009F 5480              ANL     A,#080H
00A1 4500        R     ORL     A,PWMLevel
00A3 FB                MOV     R3,A
00A4 7DC4              MOV     R5,#0C4H
00A6 7F8A              MOV     R7,#08AH
00A8 120000      E     LCALL   _WriteI2C
                                           ; SOURCE LINE # 1198
00AB 7800        R     MOV     R0,#LOW page
00AD E2                MOVX    A,@R0
00AE FB                MOV     R3,A
00AF 7DFF              MOV     R5,#0FFH
00B1 7F8A              MOV     R7,#08AH
00B3 020000      E     LJMP    _WriteI2C
             ; FUNCTION _AdjustAutoDayNight (END)

             ; FUNCTION Hs_InitVars (BEGIN)
                                           ; SOURCE LINE # 1202
                                           ; SOURCE LINE # 1203
                                           ; SOURCE LINE # 1204
0000 E4                CLR     A
0001 7800        E     MOV     R0,#LOW SEQFlag
0003 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1205
0004 7800        R     MOV     R0,#LOW SEQTime
0006 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1206
0007 7800        E     MOV     R0,#LOW TriggerMode
0009 7408              MOV     A,#08H
000B F2                MOVX    @R0,A
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 119 

                                           ; SOURCE LINE # 1207
000C D200        R     SETB    AccPowerDown
                                           ; SOURCE LINE # 1210
000E 22                RET     
             ; FUNCTION Hs_InitVars (END)

             ; FUNCTION LoadEEPROM (BEGIN)
                                           ; SOURCE LINE # 1212
                                           ; SOURCE LINE # 1213
                                           ; SOURCE LINE # 1215
0000 7FAB              MOV     R7,#0ABH
0002 7E00              MOV     R6,#00H
0004 120000      E     LCALL   _ReadEEP
0007 7800        R     MOV     R0,#LOW PowerFlag
0009 EF                MOV     A,R7
000A F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1216
000B 7FB0              MOV     R7,#0B0H
000D 7E00              MOV     R6,#00H
000F 120000      E     LCALL   _ReadEEP
0012 7800        R     MOV     R0,#LOW SelectModeType
0014 EF                MOV     A,R7
0015 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1217
0016 7FAF              MOV     R7,#0AFH
0018 7E00              MOV     R6,#00H
001A 120000      E     LCALL   _ReadEEP
001D 7800        E     MOV     R0,#LOW NowModeState
001F EF                MOV     A,R7
0020 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1218
0021 7FAA              MOV     R7,#0AAH
0023 7E00              MOV     R6,#00H
0025 120000      E     LCALL   _ReadEEP
0028 7800        E     MOV     R0,#LOW TimeStep
002A EF                MOV     A,R7
002B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1219
002C 7FAD              MOV     R7,#0ADH
002E 7E00              MOV     R6,#00H
0030 120000      E     LCALL   _ReadEEP
0033 7800        R     MOV     R0,#LOW Priority
0035 EF                MOV     A,R7
0036 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1220
0037 7FA0              MOV     R7,#0A0H
0039 7E00              MOV     R6,#00H
003B 120000      E     LCALL   _ReadEEP
003E 7800        R     MOV     R0,#LOW AutoDayNight
0040 EF                MOV     A,R7
0041 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1221
0042 7FB8              MOV     R7,#0B8H
0044 7E00              MOV     R6,#00H
0046 120000      E     LCALL   _ReadEEP
0049 7800        R     MOV     R0,#LOW PelcoChoiceFLAG
004B EF                MOV     A,R7
004C F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1222
004D 7FB7              MOV     R7,#0B7H
004F 7E00              MOV     R6,#00H
0051 120000      E     LCALL   _ReadEEP
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 120 

0054 7800        R     MOV     R0,#LOW CAMNumber
0056 EF                MOV     A,R7
0057 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1223
0058 7FB9              MOV     R7,#0B9H
005A 7E00              MOV     R6,#00H
005C 120000      E     LCALL   _ReadEEP
005F 7800        R     MOV     R0,#LOW Baud_rate
0061 EF                MOV     A,R7
0062 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1225
0063 7FA3              MOV     R7,#0A3H
;---- Variable 'val' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1226
0065 120000      R     LCALL   L?0193
0068 7800        E     MOV     R0,#LOW Attr_A
006A 7018              JNZ     ?C0124
                                           ; SOURCE LINE # 1227
                                           ; SOURCE LINE # 1228
006C E2                MOVX    A,@R0
006D 4402              ORL     A,#02H
006F F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1229
0070 7800        E     MOV     R0,#LOW Attr_B
0072 E2                MOVX    A,@R0
0073 4402              ORL     A,#02H
0075 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1230
0076 7800        E     MOV     R0,#LOW Attr_C
0078 E2                MOVX    A,@R0
0079 4402              ORL     A,#02H
007B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1231
007C 7800        E     MOV     R0,#LOW Attr_R
007E E2                MOVX    A,@R0
007F 4402              ORL     A,#02H
0081 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1233
0082 8016              SJMP    ?C0125
0084         ?C0124:
                                           ; SOURCE LINE # 1236
                                           ; SOURCE LINE # 1237
0084 E2                MOVX    A,@R0
0085 540D              ANL     A,#0DH
0087 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1238
0088 7800        E     MOV     R0,#LOW Attr_B
008A E2                MOVX    A,@R0
008B 540D              ANL     A,#0DH
008D F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1239
008E 7800        E     MOV     R0,#LOW Attr_C
0090 E2                MOVX    A,@R0
0091 540D              ANL     A,#0DH
0093 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1240
0094 7800        E     MOV     R0,#LOW Attr_R
0096 E2                MOVX    A,@R0
0097 540D              ANL     A,#0DH
0099 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1241
009A         ?C0125:
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 121 

                                           ; SOURCE LINE # 1243
009A 7FA5              MOV     R7,#0A5H
                                           ; SOURCE LINE # 1244
009C 120000      R     LCALL   L?0193
009F 7800        E     MOV     R0,#LOW Attr_A
00A1 7006              JNZ     ?C0126
                                           ; SOURCE LINE # 1245
00A3 E2                MOVX    A,@R0
00A4 4401              ORL     A,#01H
00A6 F2                MOVX    @R0,A
00A7 8004              SJMP    ?C0127
00A9         ?C0126:
                                           ; SOURCE LINE # 1247
00A9 E2                MOVX    A,@R0
00AA 540E              ANL     A,#0EH
00AC F2                MOVX    @R0,A
00AD         ?C0127:
                                           ; SOURCE LINE # 1249
00AD 7FA6              MOV     R7,#0A6H
                                           ; SOURCE LINE # 1250
00AF 120000      R     LCALL   L?0201
00B2 7800        E     MOV     R0,#LOW Attr_B
00B4 7006              JNZ     ?C0128
                                           ; SOURCE LINE # 1251
00B6 E2                MOVX    A,@R0
00B7 4401              ORL     A,#01H
00B9 F2                MOVX    @R0,A
00BA 8004              SJMP    ?C0129
00BC         ?C0128:
                                           ; SOURCE LINE # 1253
00BC E2                MOVX    A,@R0
00BD 540E              ANL     A,#0EH
00BF F2                MOVX    @R0,A
00C0         ?C0129:
                                           ; SOURCE LINE # 1255
00C0 7FA7              MOV     R7,#0A7H
                                           ; SOURCE LINE # 1256
00C2 120000      R     LCALL   L?0201
00C5 7800        E     MOV     R0,#LOW Attr_C
00C7 7006              JNZ     ?C0130
                                           ; SOURCE LINE # 1257
00C9 E2                MOVX    A,@R0
00CA 4401              ORL     A,#01H
00CC F2                MOVX    @R0,A
00CD 8004              SJMP    ?C0131
00CF         ?C0130:
                                           ; SOURCE LINE # 1259
00CF E2                MOVX    A,@R0
00D0 540E              ANL     A,#0EH
00D2 F2                MOVX    @R0,A
00D3         ?C0131:
                                           ; SOURCE LINE # 1261
00D3 7FA8              MOV     R7,#0A8H
00D5 7E00              MOV     R6,#00H
00D7 120000      E     LCALL   _ReadEEP
                                           ; SOURCE LINE # 1262
00DA EF                MOV     A,R7
00DB 7800        E     MOV     R0,#LOW Attr_R
00DD 7006              JNZ     ?C0132
                                           ; SOURCE LINE # 1263
00DF E2                MOVX    A,@R0
00E0 4401              ORL     A,#01H
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 122 

00E2 F2                MOVX    @R0,A
00E3 8004              SJMP    ?C0133
00E5         ?C0132:
                                           ; SOURCE LINE # 1265
00E5 E2                MOVX    A,@R0
00E6 540E              ANL     A,#0EH
00E8 F2                MOVX    @R0,A
00E9         ?C0133:
                                           ; SOURCE LINE # 1267
00E9 7FA9              MOV     R7,#0A9H
00EB 7E00              MOV     R6,#00H
00ED 120000      E     LCALL   _ReadEEP
                                           ; SOURCE LINE # 1268
00F0 120000      E     LCALL   _CAMOutDSel
                                           ; SOURCE LINE # 1271
00F3 120000      E     LCALL   GetAudioVolEE
00F6 7800        E     MOV     R0,#LOW AudioVol
00F8 EF                MOV     A,R7
00F9 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1272
00FA 120000      E     LCALL   GetPCAudioVolEE
00FD 7800        E     MOV     R0,#LOW PCAudioVol
00FF EF                MOV     A,R7
0100 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1273
0101 7FB2              MOV     R7,#0B2H
0103 7E00              MOV     R6,#00H
0105 120000      E     LCALL   _ReadEEP
0108 7800        R     MOV     R0,#LOW DVR_AudioRecord
010A EF                MOV     A,R7
010B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1274
010C 020000      E     LJMP    _DVRAodioSel
                                           ; SOURCE LINE # 1279
010F         L?0193:
010F 7E00              MOV     R6,#00H
0111 120000      E     LCALL   _ReadEEP
0114 EF                MOV     A,R7
0115 22                RET     
0116         L?0201:
0116 7E00              MOV     R6,#00H
0118 120000      E     LCALL   _ReadEEP
011B EF                MOV     A,R7
011C 22                RET     
             ; FUNCTION LoadEEPROM (END)

             ; FUNCTION ACCPowerControl (BEGIN)
                                           ; SOURCE LINE # 1281
                                           ; SOURCE LINE # 1282
                                           ; SOURCE LINE # 1284
0000 30962D            JNB     P1_6,?C0135
0003 30002A      R     JNB     AccPowerDown,?C0135
                                           ; SOURCE LINE # 1285
                                           ; SOURCE LINE # 1286
0006 7FC8              MOV     R7,#0C8H
0008 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1287
000B D200        R     SETB    PowerDownStart
                                           ; SOURCE LINE # 1288
000D C200        R     CLR     AccPowerDown
                                           ; SOURCE LINE # 1290
000F 30000F      E     JNB     DVR_Ready,?C0136
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 123 

                                           ; SOURCE LINE # 1291
                                           ; SOURCE LINE # 1292
0012 7800        E     MOV     R0,#LOW PowerDownWait
0014 E2                MOVX    A,@R0
0015 D3                SETB    C
0016 941D              SUBB    A,#01DH
0018 4016              JC      ?C0135
                                           ; SOURCE LINE # 1293
                                           ; SOURCE LINE # 1294
001A 30960B            JNB     P1_6,?C0189
                                           ; SOURCE LINE # 1295
                                           ; SOURCE LINE # 1299
001D D2B6              SETB    P3_6
                                           ; SOURCE LINE # 1301
001F 800F              SJMP    ?C0135
0021         ?C0136:
                                           ; SOURCE LINE # 1311
                                           ; SOURCE LINE # 1312
0021 309604            JNB     P1_6,?C0141
                                           ; SOURCE LINE # 1313
                                           ; SOURCE LINE # 1317
0024 D2B6              SETB    P3_6
                                           ; SOURCE LINE # 1319
0026 8008              SJMP    ?C0135
0028         ?C0141:
                                           ; SOURCE LINE # 1321
                                           ; SOURCE LINE # 1322
0028         ?C0189:
0028 C200        R     CLR     PowerDownStart
                                           ; SOURCE LINE # 1323
002A E4                CLR     A
002B 7800        E     MOV     R0,#LOW PowerDownWait
002D F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1324
002E D200        R     SETB    AccPowerDown
                                           ; SOURCE LINE # 1325
                                           ; SOURCE LINE # 1326
                                           ; SOURCE LINE # 1327
0030         ?C0135:
                                           ; SOURCE LINE # 1331
0030 7800        E     MOV     R0,#LOW PowerDownWait
0032 E2                MOVX    A,@R0
0033 FF                MOV     R7,A
0034 75F00A            MOV     B,#0AH
0037 84                DIV     AB
0038 E5F0              MOV     A,B
003A 7005              JNZ     ?C0144
003C EF                MOV     A,R7
003D 6002              JZ      ?C0144
                                           ; SOURCE LINE # 1332
003F D200        R     SETB    AccPowerDown
                                           ; SOURCE LINE # 1334
0041         ?C0144:
0041 22                RET     
             ; FUNCTION ACCPowerControl (END)

             ; FUNCTION main_loop (BEGIN)
                                           ; SOURCE LINE # 1338
                                           ; SOURCE LINE # 1339
                                           ; SOURCE LINE # 1343
0000 7BFF              MOV     R3,#0FFH
0002 7A00        R     MOV     R2,#HIGH ?SC_89
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 124 

0004 7900        R     MOV     R1,#LOW ?SC_89
0006 120000      E     LCALL   _Puts
0009         ?C0145:
                                           ; SOURCE LINE # 1352
                                           ; SOURCE LINE # 1354
0009 120000      R     LCALL   ACCPowerControl
                                           ; SOURCE LINE # 1374
000C E500        E     MOV     A,RS2_in
000E 600D              JZ      ?C0147
0010 120000      E     LCALL   GetDisplayedOSD
0013 EF                MOV     A,R7
0014 20E106            JB      ACC.1,?C0147
                                           ; SOURCE LINE # 1375
                                           ; SOURCE LINE # 1376
0017 120000      E     LCALL   DvrReceivePaser
                                           ; SOURCE LINE # 1377
001A E4                CLR     A
001B F500        E     MOV     RS2_in,A
                                           ; SOURCE LINE # 1378
001D         ?C0147:
                                           ; SOURCE LINE # 1380
001D 300011      E     JNB     GetDVRStatusflag,?C0148
                                           ; SOURCE LINE # 1381
                                           ; SOURCE LINE # 1382
0020 7F05              MOV     R7,#05H
0022 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1383
0025 7F04              MOV     R7,#04H
0027 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1384
002A 7F06              MOV     R7,#06H
002C 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1386
002F C200        E     CLR     GetDVRStatusflag
                                           ; SOURCE LINE # 1387
0031         ?C0148:
                                           ; SOURCE LINE # 1389
0031 300007      R     JNB     GetDATETIMEflag,?C0149
                                           ; SOURCE LINE # 1390
                                           ; SOURCE LINE # 1391
0034 7F06              MOV     R7,#06H
0036 120000      E     LCALL   _Hs_DvrTxCmdPaser
                                           ; SOURCE LINE # 1392
0039 C200        R     CLR     GetDATETIMEflag
                                           ; SOURCE LINE # 1393
003B         ?C0149:
                                           ; SOURCE LINE # 1395
003B 120000      E     LCALL   GetDisplayedOSD
003E EF                MOV     A,R7
003F 30E406            JNB     ACC.4,?C0150
0042 300003      E     JNB     DVR_Ready,?C0150
                                           ; SOURCE LINE # 1396
0045 120000      E     LCALL   DisplayDVRStatus
0048         ?C0150:
                                           ; SOURCE LINE # 1401
0048 120000      E     LCALL   CheckTrigger
004B 7800        R     MOV     R0,#LOW val
004D EF                MOV     A,R7
004E F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1402
004F 120000      E     LCALL   _TriggerHandler
                                           ; SOURCE LINE # 1406
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 125 

0052 7800        E     MOV     R0,#LOW TriggerFlag
0054 E2                MOVX    A,@R0
0055 7017              JNZ     ?C0151
                                           ; SOURCE LINE # 1407
                                           ; SOURCE LINE # 1408
0057 7800        E     MOV     R0,#LOW SEQFlag
0059 E2                MOVX    A,@R0
005A 6012              JZ      ?C0151
                                           ; SOURCE LINE # 1409
                                           ; SOURCE LINE # 1410
005C 7800        E     MOV     R0,#LOW TimeStep
005E E2                MOVX    A,@R0
005F FF                MOV     R7,A
0060 7800        R     MOV     R0,#LOW SEQTime
0062 E2                MOVX    A,@R0
0063 C3                CLR     C
0064 9F                SUBB    A,R7
0065 4007              JC      ?C0151
                                           ; SOURCE LINE # 1411
                                           ; SOURCE LINE # 1412
0067 120000      E     LCALL   SEQMode
                                           ; SOURCE LINE # 1413
006A E4                CLR     A
006B 7800        R     MOV     R0,#LOW SEQTime
006D F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1414
                                           ; SOURCE LINE # 1415
                                           ; SOURCE LINE # 1416
006E         ?C0151:
                                           ; SOURCE LINE # 1419
006E 7800        R     MOV     R0,#LOW AutoDayNight
0070 E2                MOVX    A,@R0
0071 700E              JNZ     ?C0154
                                           ; SOURCE LINE # 1420
                                           ; SOURCE LINE # 1421
0073 7DC9              MOV     R5,#0C9H
0075 7F8A              MOV     R7,#08AH
0077 120000      E     LCALL   _ReadI2C
007A 7800        R     MOV     R0,#LOW val
007C EF                MOV     A,R7
007D F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1422
007E 120000      R     LCALL   _AdjustAutoDayNight
                                           ; SOURCE LINE # 1423
0081         ?C0154:
                                           ; SOURCE LINE # 1425
0081 120000      E     LCALL   CheckKeyIn
0084 EF                MOV     A,R7
0085 6049              JZ      ?C0163
0087         ?C0155:
                                           ; SOURCE LINE # 1429
0087 120000      E     LCALL   CheckAndClearOSD
                                           ; SOURCE LINE # 1432
008A 120000      R     LCALL   GetInputSelection
008D EF                MOV     A,R7
008E 14                DEC     A
008F 24FD              ADD     A,#0FDH
0091 5006              JNC     ?C0159
0093 24FD              ADD     A,#0FDH
0095 600E              JZ      ?C0161
0097 800F              SJMP    ?C0156
                                           ; SOURCE LINE # 1434
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 126 

                                           ; SOURCE LINE # 1435
                                           ; SOURCE LINE # 1436
0099         ?C0159:
                                           ; SOURCE LINE # 1439
0099 120000      E     LCALL   GetDisplayedOSD
009C EF                MOV     A,R7
009D 20E108            JB      ACC.1,?C0156
                                           ; SOURCE LINE # 1440
                                           ; SOURCE LINE # 1441
00A0 120000      R     LCALL   CheckDecoderInput
                                           ; SOURCE LINE # 1442
                                           ; SOURCE LINE # 1444
00A3 8003              SJMP    ?C0156
                                           ; SOURCE LINE # 1447
00A5         ?C0161:
                                           ; SOURCE LINE # 1450
00A5 120000      E     LCALL   CheckPCinput
                                           ; SOURCE LINE # 1451
                                           ; SOURCE LINE # 1454
00A8         ?C0156:
                                           ; SOURCE LINE # 1455
00A8 200003      E     JB      CAM_PTZ_RUN_flag,$ + 6H
00AB 020000      R     LJMP    ?C0145
00AE 20A403            JB      P2_4,$ + 6H
00B1 020000      R     LJMP    ?C0145
00B4 20A503            JB      P2_5,$ + 6H
00B7 020000      R     LJMP    ?C0145
00BA 20A603            JB      P2_6,$ + 6H
00BD 020000      R     LJMP    ?C0145
00C0 20A703            JB      P2_7,$ + 6H
00C3 020000      R     LJMP    ?C0145
                                           ; SOURCE LINE # 1456
                                           ; SOURCE LINE # 1457
00C6 7F0A              MOV     R7,#0AH
00C8 120000      E     LCALL   _CAM_TxCommand_toRS485
                                           ; SOURCE LINE # 1458
00CB C200        E     CLR     CAM_PTZ_RUN_flag
                                           ; SOURCE LINE # 1459
                                           ; SOURCE LINE # 1460
00CD 020000      R     LJMP    ?C0145
                                           ; SOURCE LINE # 1462
00D0         ?C0163:
00D0 22                RET     
             ; FUNCTION main_loop (END)

             ; FUNCTION main (BEGIN)
                                           ; SOURCE LINE # 1464
                                           ; SOURCE LINE # 1465
                                           ; SOURCE LINE # 1467
0000 E4                CLR     A
0001 7800        R     MOV     R0,#LOW TW2835Check
0003 F2                MOVX    @R0,A
0004 08                INC     R0
0005 F2                MOVX    @R0,A
                                           ; SOURCE LINE # 1471
0006 C2B6              CLR     P3_6
                                           ; SOURCE LINE # 1473
0008 C2E8              CLR     P4_0
                                           ; SOURCE LINE # 1474
000A 53E8FB            ANL     P4,#0FBH
                                           ; SOURCE LINE # 1475
000D 7FE8              MOV     R7,#0E8H
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 127 

000F 7E03              MOV     R6,#03H
0011 120000      E     LCALL   _Wait_ms
                                           ; SOURCE LINE # 1476
0014 C2B4              CLR     P3_4
                                           ; SOURCE LINE # 1477
0016 7FC8              MOV     R7,#0C8H
0018 7E00              MOV     R6,#00H
001A 120000      E     LCALL   _Wait_ms
                                           ; SOURCE LINE # 1478
001D C2B4              CLR     P3_4
                                           ; SOURCE LINE # 1479
001F 120000      E     LCALL   InitCPU
                                           ; SOURCE LINE # 1483
0022 120000      E     LCALL   InitVars
                                           ; SOURCE LINE # 1484
0025 120000      R     LCALL   Hs_InitVars
                                           ; SOURCE LINE # 1485
0028 120000      E     LCALL   InitTechwell
                                           ; SOURCE LINE # 1486
002B 120000      E     LCALL   Hs_Protocol_Init
                                           ; SOURCE LINE # 1487
002E 120000      E     LCALL   LCDPowerOFF
                                           ; SOURCE LINE # 1489
0031 120000      E     LCALL   main_init
                                           ; SOURCE LINE # 1493
0034 C294              CLR     P1_4
                                           ; SOURCE LINE # 1496
0036 7F90              MOV     R7,#090H
0038 7E01              MOV     R6,#01H
003A 120000      E     LCALL   _Wait_ms
                                           ; SOURCE LINE # 1529
003D 120000      R     LCALL   LoadEEPROM
                                           ; SOURCE LINE # 1532
0040 E4                CLR     A
0041 7800        R     MOV     R0,#LOW i
0043 F2                MOVX    @R0,A
0044         ?C0164:
                                           ; SOURCE LINE # 1533
                                           ; SOURCE LINE # 1534
0044 7800        E     MOV     R0,#LOW Attr_A
0046 E2                MOVX    A,@R0
0047 FD                MOV     R5,A
0048 7800        E     MOV     R0,#LOW Attr_B
004A E2                MOVX    A,@R0
004B FB                MOV     R3,A
004C 7800        E     MOV     R0,#LOW Attr_C
004E E2                MOVX    A,@R0
004F 7800        E     MOV     R0,#LOW ?_TW2835Command?BYTE+03H
0051 F2                MOVX    @R0,A
0052 7800        E     MOV     R0,#LOW Attr_R
0054 E2                MOVX    A,@R0
0055 7800        E     MOV     R0,#LOW ?_TW2835Command?BYTE+04H
0057 F2                MOVX    @R0,A
0058 7F03              MOV     R7,#03H
005A 120000      E     LCALL   _TW2835Command
005D 7E00              MOV     R6,#00H
005F 7800        R     MOV     R0,#LOW TW2835Check
0061 EE                MOV     A,R6
0062 F2                MOVX    @R0,A
0063 08                INC     R0
0064 EF                MOV     A,R7
0065 F2                MOVX    @R0,A
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 128 

                                           ; SOURCE LINE # 1535
0066 6401              XRL     A,#01H
0068 6012              JZ      ?C0165
                                           ; SOURCE LINE # 1536
006A         ?C0167:
                                           ; SOURCE LINE # 1537
006A 7F64              MOV     R7,#064H
006C 7E00              MOV     R6,#00H
006E 120000      E     LCALL   _Wait_ms
                                           ; SOURCE LINE # 1538
0071 7800        R     MOV     R0,#LOW i
0073 E2                MOVX    A,@R0
0074 04                INC     A
0075 F2                MOVX    @R0,A
0076 E2                MOVX    A,@R0
0077 C3                CLR     C
0078 9414              SUBB    A,#014H
007A 40C8              JC      ?C0164
007C         ?C0165:
                                           ; SOURCE LINE # 1541
007C 7FE8              MOV     R7,#0E8H
007E 7E03              MOV     R6,#03H
0080 120000      E     LCALL   _Wait_ms
                                           ; SOURCE LINE # 1542
0083 7800        E     MOV     R0,#LOW NowModeState
0085 E2                MOVX    A,@R0
0086 B40113            CJNE    A,#01H,?C0168
0089 7FAE              MOV     R7,#0AEH
008B 7E00              MOV     R6,#00H
008D 120000      E     LCALL   _ReadEEP
0090 BF0E09            CJNE    R7,#0EH,?C0168
                                           ; SOURCE LINE # 1543
0093 7BFF              MOV     R3,#0FFH
0095 7A00        R     MOV     R2,#HIGH ?SC_94
0097 7900        R     MOV     R1,#LOW ?SC_94
0099 120000      E     LCALL   _Puts
009C         ?C0168:
                                           ; SOURCE LINE # 1544
009C 120000      E     LCALL   SetNowMode
                                           ; SOURCE LINE # 1545
009F E4                CLR     A
00A0 FF                MOV     R7,A
00A1 120000      E     LCALL   _ChangeVol
00A4         ?C0169:
                                           ; SOURCE LINE # 1549
                                           ; SOURCE LINE # 1550
00A4 7800        R     MOV     R0,#LOW PowerFlag
00A6 E2                MOVX    A,@R0
00A7 6003              JZ      ?C0171
                                           ; SOURCE LINE # 1551
00A9 120000      R     LCALL   main_loop
00AC         ?C0171:
                                           ; SOURCE LINE # 1553
00AC 120000      R     LCALL   PowerOff
                                           ; SOURCE LINE # 1559
00AF 120000      R     LCALL   WaitPowerOn
                                           ; SOURCE LINE # 1561
00B2 80F0              SJMP    ?C0169
             ; FUNCTION main (END)

C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 129 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


SetDATETIME. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
COMPOSITE3Input. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
InitCPU. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
DWORD. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
SendDVRStatus. . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
_DVRAodioSel . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_LCDPowerON. . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetDVRParam. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
CAM_R. . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
P4 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
CAM_PTZ_RUN_flag . . . . . . . . . . .  EXTERN   DATA   BIT      -----  1
GetNextInputSelection. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
Range4Coarse . . . . . . . . . . . . .  PUBLIC   DATA   BIT      0000H  1
Halt_OK. . . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
SendDVRParamDT . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
CAM_BAR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_ABR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_CAR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_ACR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_CBR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_BCR. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Baud_rate. . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0000H  1
PowerFlag. . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0001H  1
NumberStringType . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  11
  x. . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  y. . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  width. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  BackColor. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  Radix. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  NumColor . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  MaxLen . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  PrePostCharLen . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
  PrePostChar. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0008H  3
_InitVideoData . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  src. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
IsNoInput. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
RS2_in . . . . . . . . . . . . . . . .  EXTERN   DATA   U_CHAR   -----  1
GetDATETIMEflag. . . . . . . . . . . .  PUBLIC   DATA   BIT      0001H  1
SetDVRParam. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
_ClearAutoDetectStd. . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SelectModeType . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0002H  1
CAM_PTZ_RIGHT. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_delay . . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
AudioMute. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
P4_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00E8H  1
P1_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0094H  1
FontData . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  27
  font . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  27
GetOSDLastKeyInTime. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
P2_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A4H  1
VInputStd. . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0003H  1
P3_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B4H  1
P2_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A5H  1
P1_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0096H  1
GetDVRStatus . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
P2_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A6H  1
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 130 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


P3_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B6H  1
P2_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A7H  1
P3_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B7H  1
_TriggerHandler. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_SET. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
AVMode . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
struct_VInputStd . . . . . . . . . . .  PUBLIC   CODE   ARRAY    00D0H  153
SetOSDLastKeyInTime. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
SourceModeType . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
CAM_NUM. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
DVR_AudioRecord. . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0004H  1
CMD_NUM. . . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
main . . . . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
  TW2835Check. . . . . . . . . . . . .  AUTO     PDATA  U_INT    0001H  2
AudioVol . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
CheckPCinput . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_AdjustAutoDayNight. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  val. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  page . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
  PWMLevelTemp . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0001H  1
_Hs_DvrTxCmdPaser. . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
DetectDecoderInput . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
NTSC_Regs. . . . . . . . . . . . . . .  EXTERN   CODE   ARRAY    -----  -----
MANUALRECSTART . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
PowerOff . . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_I2CDeviceInitialize . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  RegSet . . . . . . . . . . . . . . .  AUTO     PDATA  PTR      0000H  3
  cnt. . . . . . . . . . . . . . . . .  * REG *  DATA   INT      0006H  2
  addr . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0003H  1
  index. . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0004H  1
  val. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0005H  1
_Puts. . . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetDisplayedOSD. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CheckDecoderInput. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  std1 . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
  std. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0001H  1
  cnt. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0002H  1
  trycnt . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0003H  1
  ChangedNoinput . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0004H  1
TimeStep . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
_SetVideoMode. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_RAB_H. . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
OSDStrInfo . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  8
  cnt. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  addr . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0001H  2
  attr . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  str. . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0004H  4
I2CAutoIncFlagOn . . . . . . . . . . .  PUBLIC   DATA   BIT      0002H  1
SetFormatSD. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
AccPowerDown . . . . . . . . . . . . .  PUBLIC   DATA   BIT      0003H  1
AVGAInput. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetDVRStatusflag . . . . . . . . . . .  EXTERN   DATA   BIT      -----  1
InitVars . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_BA . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_AB . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
BYTE . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 131 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


TimeType . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  7
  x. . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  y. . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  width. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  BackColor. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  Format . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  TimeColor. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  CursorColor. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
CAM_CA . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_AC . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_PTZ_UP . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_BC . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_CB . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_Audio_Select. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  flag . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
GetVInputStd . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
AutoDayNight . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0005H  1
CheckTrigger . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SourceModeTypeEnum . . . . . . . . . .  * TAG *  -----  ENUM     -----  -----
CheckPanelImage. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
struct_IdName. . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  17
  Id . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  Name . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  16
SetFormatSDDone. . . . . . . . . . . .  E_CONST  -----  INT      -----  2
EnumType . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  17
  Sz . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ByLang . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  Str. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0002H  15
MenuType . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  4
  width. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  height . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  TitleColor . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  CursorColor. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
PCAudioVol . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
CAM_RAB_T. . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
PowerDownStart . . . . . . . . . . . .  PUBLIC   DATA   BIT      0004H  1
_DetectAndSetForVGAInput . . . . . . .  EXTERN   CODE   PROC     -----  -----
_ReadI2C . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
WORD . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
CAM_PTZ_LEFT . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Attr_A . . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
main_init. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
cLastSyncLoss. . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
CAMNumber. . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0006H  1
Attr_B . . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
ACCPowerControl. . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
CAM_Iris_Open. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Attr_C . . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
GetWideModeEE. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
InputSelection . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0007H  1
LCDPowerOFF. . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
NowModeState . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
PowerDownWait. . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
CAM_ZOOM_OUT_START . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_TW2835Command . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
main_loop. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  val. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 132 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


CheckKeyIn . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
DVR_Ready. . . . . . . . . . . . . . .  EXTERN   DATA   BIT      -----  1
_SetVInputStd. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  newd . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
CAM_AR . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
PowerDown_XTAL . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  flag . . . . . . . . . . . . . . . .  AUTO     DATA   BIT      0000H  1
CAM_BR . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_RB . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_CR . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CheckAndClearOSD . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_MENU_ENTER . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
struct_InputSelection. . . . . . . . .  PUBLIC   CODE   ARRAY    006AH  102
Register . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
CAM_PTZ_DOWN . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_GetKey. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_WriteI2C. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
LoadEEPROM . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  val. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
CAM_CALL . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Attr_R . . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
_CAM_TxCommand_toRS485 . . . . . . . .  EXTERN   CODE   PROC     -----  -----
AutoPHPCalDisable. . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
PAL_Regs . . . . . . . . . . . . . . .  EXTERN   CODE   ARRAY    -----  -----
DisplayDVRStatus . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
Hs_InitVars. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
RS485_RX . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_Set4WideScreen. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
Flag4AutoPanelRegs . . . . . . . . . .  PUBLIC   DATA   BIT      0005H  1
Baud_rate2400. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RS485_TX . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
VGAAudio . . . . . . . . . . . . . . .  EXTERN   DATA   BIT      -----  1
InitTechwell . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SetAutoDetectStd . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
TriggerFlag. . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
GetAudioVolEE. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
ReadVInputSTD. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  std. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
FW_Update_Start. . . . . . . . . . . .  E_CONST  -----  INT      -----  2
NumType. . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  5
  PrePostCharLen . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  PrePostChar. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  4
IHF. . . . . . . . . . . . . . . . . .  PUBLIC   DATA   U_LONG   0000H  4
_Wait_ms . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_PTZ_STOP . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_ReadEEP . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
RegisterInfo . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  6
  Min. . . . . . . . . . . . . . . . .  MEMBER   -----  INT      0000H  2
  Max. . . . . . . . . . . . . . . . .  MEMBER   -----  INT      0002H  2
  Default. . . . . . . . . . . . . . .  MEMBER   -----  INT      0004H  2
Baud_rate4800. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_PCMDATA . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  22
  Support. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  HAN. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0001H  2
  VAN. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0003H  2
  IVF. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0005H  2
  CLOCK. . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0007H  2
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 133 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  low. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0009H  2
  high . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000BH  2
  Hstart . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000DH  2
  Vstart . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000FH  2
  IPF. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0011H  2
  PPF. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0013H  2
  VBack. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0015H  1
Baud_rate9600. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_SaveInputSelectionEE. . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_ChangeInput . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  newsel . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
  ret. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0001H  1
CAM_QUAD . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
FW_Update_OK . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
TriggerMode. . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
ClearOSDInfo . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
PelcoChoiceFLAG. . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0008H  1
CAM_ZOOM_IN_START. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GetInputSelection. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
MANUALRECSTOP. . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
DebugLevel . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   0009H  1
IVF. . . . . . . . . . . . . . . . . .  PUBLIC   DATA   U_INT    0004H  2
SetDVRDefault. . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
SEQFlag. . . . . . . . . . . . . . . .  EXTERN   PDATA  U_CHAR   -----  1
_PowerLED. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
DefineMenu . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  16
  Icon . . . . . . . . . . . . . . . .  MEMBER   -----  PTR      0000H  2
  Desc . . . . . . . . . . . . . . . .  MEMBER   -----  PTR      0002H  3
  PreFnId. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  PostFnId . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  IconColor. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
  DescColor. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0008H  1
  Child. . . . . . . . . . . . . . . .  MEMBER   -----  PTR      0009H  2
  Type . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000BH  1
  ActiveWithCursor . . . . . . . . . .  MEMBER   -----  U_CHAR   000CH  1
  Id . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000DH  1
  TypeData . . . . . . . . . . . . . .  MEMBER   -----  PTR      000EH  2
WaitPowerOn. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  ikey . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0000H  1
  val. . . . . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0001H  1
  VGATrigger . . . . . . . . . . . . .  AUTO     PDATA  U_CHAR   0002H  1
VGAMode. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Priority . . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   000AH  1
CMD_UNKNOWN. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
GetPCAudioVolEE. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_WriteEEP. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SEQ. . . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
Hs_Protocol_Init . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetVInputStdInx. . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  std. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0003H  1
SetNowMode . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
LongRegisterInfo . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  6
  Min. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  Max. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  Default. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
HS_DvrCommand. . . . . . . . . . . . .  * TAG *  -----  ENUM     -----  -----
C51 COMPILER V8.16   MAIN                                                                  03/04/2011 15:51:17 PAGE 134 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


SendDVRParam . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
DisplayInput . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
PictureInfo. . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  4
  Register_Addr. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  EEPROM_Addr. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  Control_Range. . . . . . . . . . . .  MEMBER   -----  PTR      0002H  2
CAM_ABR_T3 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
PWMLevel . . . . . . . . . . . . . . .  PUBLIC   DATA   U_CHAR   0006H  1
CAM_ABR_T4 . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CMD_NULL . . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
SEQMode. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetDATETIME. . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
CAM_A. . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
OSDLastKeyInTime . . . . . . . . . . .  PUBLIC   PDATA  U_INT    000BH  2
SNAPSHOT . . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
CAM_B. . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
DvrReceivePaser. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetTime_ms . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CAM_C. . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
tic_pc . . . . . . . . . . . . . . . .  EXTERN   DATA   U_INT    -----  2
CAM_D. . . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_CAMOutDSel. . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_Printf. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
WideScreenMode . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   000DH  1
CAM_CAB. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_BAC. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CAM_ABC. . . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GetDVRVersion. . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
VGAflag. . . . . . . . . . . . . . . .  PUBLIC   DATA   BIT      0006H  1
SEQTime. . . . . . . . . . . . . . . .  PUBLIC   PDATA  U_CHAR   000EH  1
VInputStdDetectMode. . . . . . . . . .  PUBLIC   PDATA  U_CHAR   000FH  1
Halt_Start . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
SendAlarm. . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
_ChangeVol . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
COMPOSITE1Input. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GetLCDMode . . . . . . . . . . . . . .  E_CONST  -----  INT      -----  2
COMPOSITE2Input. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2093    ----
   CONSTANT SIZE    =    361    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =     16      23
   DATA SIZE        =      7    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      7       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
